
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
        
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>cellects.image_analysis.morphological_operations - Cellects Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../../static/extra.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cellectsimage_analysismorphological_operations" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Cellects Documentation" class="md-header__button md-logo" aria-label="Cellects Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Cellects Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              cellects.image_analysis.morphological_operations
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Aurele-B/Cellects" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../getting-started/" class="md-tabs__link">
          
  
  
  Getting started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../first-analysis/" class="md-tabs__link">
          
  
  
  User guide

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../use-cases/" class="md-tabs__link">
        
  
  
    
  
  Use cases

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../contributing/" class="md-tabs__link">
        
  
  
    
  
  Contributing

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../license/" class="md-tabs__link">
        
  
  
    
  
  License & Citation

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Cellects Documentation" class="md-nav__button md-logo" aria-label="Cellects Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Cellects Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Aurele-B/Cellects" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../what-is-cellects/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    What is Cellects?
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    User guide
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    User guide
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Setting up a first analysis
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Setting up a first analysis
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../first-analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../first-analysis/data-localisation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data localisation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../first-analysis/image-analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Image analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../first-analysis/video-tracking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Video tracking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Improving the analysis
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Improving the analysis
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../advanced/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../advanced/parameters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Advanced parameters
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../advanced/outputs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Required outputs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../advanced/multiple-folders/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multiple folders
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../use-cases/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Use cases
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../license/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    License & Citation
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="cellectsimage_analysismorphological_operations"><code>cellects.image_analysis.morphological_operations</code></h1>


<div class="doc doc-object doc-module">



<a id="cellects.image_analysis.morphological_operations"></a>
    <div class="doc doc-contents first">

        <p>This module provides methods to analyze and modify shapes in binary images.
It includes functions for comparing neighboring pixels, generating shape descriptors,
and performing morphological operations like expanding shapes and filling holes.</p>


<p><span class="doc-section-title">Classes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="cellects.image_analysis.morphological_operations.CompareNeighborsWithValue : Class to compare neighboring pixels to a specified value">CompareNeighborsWithValue : Class to compare neighboring pixels to a specified value</span></code></td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Functions:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><span title="cellects.image_analysis.morphological_operations.cc : Sort connected components according to size">cc : Sort connected components according to size</span></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="cellects.image_analysis.morphological_operations.make_gravity_field : Create a gradient field around shapes">make_gravity_field : Create a gradient field around shapes</span></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="cellects.image_analysis.morphological_operations.find_median_shape : Generate median shape from multiple inputs">find_median_shape : Generate median shape from multiple inputs</span></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="cellects.image_analysis.morphological_operations.make_numbered_rays : Create numbered rays for analysis">make_numbered_rays : Create numbered rays for analysis</span></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="cellects.image_analysis.morphological_operations.CompareNeighborsWithFocal : Compare neighboring pixels to focal values">CompareNeighborsWithFocal : Compare neighboring pixels to focal values</span></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="cellects.image_analysis.morphological_operations.ShapeDescriptors : Generate shape descriptors using provided functions">ShapeDescriptors : Generate shape descriptors using provided functions</span></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="cellects.image_analysis.morphological_operations.get_radius_distance_against_time : Calculate radius distances over time">get_radius_distance_against_time : Calculate radius distances over time</span></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="cellects.image_analysis.morphological_operations.expand_until_one : Expand shapes until a single connected component remains">expand_until_one : Expand shapes until a single connected component remains</span></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="cellects.image_analysis.morphological_operations.expand_and_rate_until_one : Expand and rate shapes until one remains">expand_and_rate_until_one : Expand and rate shapes until one remains</span></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="cellects.image_analysis.morphological_operations.expand_until_overlap : Expand shapes until overlap occurs">expand_until_overlap : Expand shapes until overlap occurs</span></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="cellects.image_analysis.morphological_operations.dynamically_expand_to_fill_holes : Dynamically expand to fill holes in shapes">dynamically_expand_to_fill_holes : Dynamically expand to fill holes in shapes</span></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="cellects.image_analysis.morphological_operations.expand_smalls_toward_biggest : Expand smaller shapes toward largest component">expand_smalls_toward_biggest : Expand smaller shapes toward largest component</span></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="cellects.image_analysis.morphological_operations.change_thresh_until_one : Change threshold until one connected component remains">change_thresh_until_one : Change threshold until one connected component remains</span></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="cellects.image_analysis.morphological_operations.create_ellipse : Generate ellipse shape descriptors">create_ellipse : Generate ellipse shape descriptors</span></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="cellects.image_analysis.morphological_operations.get_rolling_window_coordinates_list : Get coordinates for rolling window operations">get_rolling_window_coordinates_list : Get coordinates for rolling window operations</span></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
      </tbody>
    </table>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="cellects.image_analysis.morphological_operations.CompareNeighborsWithValue" class="doc doc-heading">
            <code>CompareNeighborsWithValue</code>


</h2>


    <div class="doc doc-contents ">



        <p>CompareNeighborsWithValue class to summarize each pixel by comparing its neighbors to a value.</p>
<p>This class analyzes pixels in a 2D array, comparing each pixel's neighbors
to a specified value. The comparison can be equality, superiority,
or inferiority, and neighbors can be the 4 or 8 nearest pixels based on
the connectivity parameter.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="k">class</span><span class="w"> </span><span class="nc">CompareNeighborsWithValue</span><span class="p">:</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    CompareNeighborsWithValue class to summarize each pixel by comparing its neighbors to a value.</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    This class analyzes pixels in a 2D array, comparing each pixel&#39;s neighbors</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">    to a specified value. The comparison can be equality, superiority,</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    or inferiority, and neighbors can be the 4 or 8 nearest pixels based on</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">    the connectivity parameter.</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">connectivity</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data_type</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">):</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">        Initialize a class for array connectivity processing.</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">        This class processes arrays based on given connectivities, creating</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">        windows around the original data for both 1D and 2D arrays. Depending on</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">        the connectivity value (4 or 8), it creates different windows with borders.</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        array : ndarray</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">            Input array to process, can be 1D or 2D.</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        connectivity : int, optional</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">            Connectivity type for processing (4 or 8), by default None.</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">        data_type : dtype, optional</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">            Data type for the array elements, by default np.int8.</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">        Attributes</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        array : ndarray</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">            The processed array based on the given data type.</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        connectivity : int</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">            Connectivity value used for processing.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        on_the_right : ndarray</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">            Array with shifted elements to the right.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        on_the_left : ndarray</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">            Array with shifted elements to the left.</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        on_the_bot : ndarray, optional</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">            Array with shifted elements to the bottom (for 2D arrays).</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        on_the_top : ndarray, optional</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">            Array with shifted elements to the top (for 2D arrays).</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        on_the_topleft : ndarray, optional</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">            Array with shifted elements to the top left (for 2D arrays).</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        on_the_topright : ndarray, optional</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">            Array with shifted elements to the top right (for 2D arrays).</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">        on_the_botleft : ndarray, optional</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">            Array with shifted elements to the bottom left (for 2D arrays).</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        on_the_botright : ndarray, optional</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">            Array with shifted elements to the bottom right (for 2D arrays).</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="n">array</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">data_type</span><span class="p">)</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">array</span> <span class="o">=</span> <span class="n">array</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">=</span> <span class="n">connectivity</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">on_the_right</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">on_the_left</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">array</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>            <span class="c1"># Build 4 window of the original array, each missing one of the four borders</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="c1"># Grow each window with a copy of the last border at the opposite of the side a border have been deleted</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">==</span> <span class="mi">4</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">on_the_right</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:],</span> <span class="n">array</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">on_the_left</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">array</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">on_the_bot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">array</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:],</span> <span class="n">array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]))</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">on_the_top</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">array</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]))</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topleft</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topright</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botleft</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botright</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:]</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topleft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_topleft</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topleft</span><span class="p">))</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topleft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_topleft</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topleft</span><span class="p">))</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topright</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_topright</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topright</span><span class="p">))</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topright</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_topright</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topright</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botleft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_botleft</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botleft</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]))</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botleft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_botleft</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botleft</span><span class="p">))</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botright</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_botright</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botright</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]))</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botright</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_botright</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botright</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">and_itself</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">        Check equality of neighboring values in an array.</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">        This method compares the neighbors of each element in `self.array` to a given value.</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        Depending on the dimensionality and connectivity settings, it checks different neighboring</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">        elements.</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">        value : int or float</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">            The value to check equality with neighboring elements.</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">        and_itself : bool, optional</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">            If True, also check equality with the element itself. Defaults to False.</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">        Returns</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">        -------</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">        None</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">        Attributes (not standard Qt properties)</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">        --------------------------------------</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        equal_neighbor_nb : ndarray of uint8</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">            Array that holds the number of equal neighbors for each element.</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">        Examples</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">        --------</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        &gt;&gt;&gt; matrix = np.array([[9, 0, 4, 6], [4, 9, 1, 3], [7, 2, 1, 4], [9, 0, 8, 5]], dtype=np.int8)</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">        &gt;&gt;&gt; compare = CompareNeighborsWithValue(matrix, connectivity=4)</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        &gt;&gt;&gt; compare.is_equal(1)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        &gt;&gt;&gt; print(compare.equal_neighbor_nb)</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        [[0 0 1 0]</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">        [0 1 1 1]</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        [0 1 1 1]</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">        [0 0 1 0]]</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">equal_neighbor_nb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_right</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_left</span><span class="p">,</span> <span class="n">value</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">equal_neighbor_nb</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_right</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_left</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>                                                 <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_bot</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_top</span><span class="p">,</span> <span class="n">value</span><span class="p">)))</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">equal_neighbor_nb</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">(</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>                    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_right</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_left</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>                     <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_bot</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_top</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>                     <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_topleft</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_topright</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>                     <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_botleft</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_botright</span><span class="p">,</span> <span class="n">value</span><span class="p">)))</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">equal_neighbor_nb</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">(</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>                    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_topleft</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_topright</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>                     <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_botleft</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_botright</span><span class="p">,</span> <span class="n">value</span><span class="p">)))</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">equal_neighbor_nb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">equal_neighbor_nb</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>        <span class="k">if</span> <span class="n">and_itself</span><span class="p">:</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">equal_neighbor_nb</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">not_equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">value</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_sup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">and_itself</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">        Determine if pixels have more neighbors with higher values than a given threshold.</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">        This method computes the number of neighboring pixels that have values greater</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">        than a specified `value` for each pixel in the array. Optionally, it can exclude</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">        the pixel itself if its value is less than or equal to `value`.</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">        value : int</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">            The threshold value used to determine if a neighboring pixel&#39;s value is greater.</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">        and_itself : bool, optional</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">            If True, exclude the pixel itself if its value is less than or equal to `value`.</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">            Defaults to False.</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">        Examples</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">        --------</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">        &gt;&gt;&gt; matrix = np.array([[9, 0, 4, 6], [4, 9, 1, 3], [7, 2, 1, 4], [9, 0, 8, 5]], dtype=np.int8)</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">        &gt;&gt;&gt; compare = CompareNeighborsWithValue(matrix, connectivity=4)</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">        &gt;&gt;&gt; compare.is_sup(1)</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">        &gt;&gt;&gt; print(compare.sup_neighbor_nb)</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">        [[3 3 2 4]</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">         [4 2 3 3]</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">         [4 2 3 3]</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">         [3 3 2 4]]</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sup_neighbor_nb</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_right</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_left</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">sup_neighbor_nb</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_right</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_left</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">,</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>                                               <span class="bp">self</span><span class="o">.</span><span class="n">on_the_bot</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_top</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">))</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">sup_neighbor_nb</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_right</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_left</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">,</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>                                               <span class="bp">self</span><span class="o">.</span><span class="n">on_the_bot</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_top</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">,</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>                                               <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topleft</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topright</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">,</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>                                               <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botleft</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botright</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">))</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">sup_neighbor_nb</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_topleft</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topright</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">,</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>                                               <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botleft</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botright</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">))</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sup_neighbor_nb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sup_neighbor_nb</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="k">if</span> <span class="n">and_itself</span><span class="p">:</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sup_neighbor_nb</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">less_equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">value</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_inf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">and_itself</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">        is_inf(value and_itself=False)</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">        Determine the number of neighbors that are infinitely small relative to a given value,</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">        considering optional connectivity and exclusion of the element itself.</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">        value : numeric</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">            The value to compare neighbor elements against.</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">        and_itself : bool, optional</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">            If True, excludes the element itself from being counted. Default is False.</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">        Examples</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">        --------</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">        &gt;&gt;&gt; matrix = np.array([[9, 0, 4, 6], [4, 9, 1, 3], [7, 2, 1, 4], [9, 0, 8, 5]], dtype=np.int8)</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">        &gt;&gt;&gt; compare = CompareNeighborsWithValue(matrix, connectivity=4)</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">        &gt;&gt;&gt; compare.is_inf(1)</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">        &gt;&gt;&gt; print(compare.inf_neighbor_nb)</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">        [[1 1 1 0]</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">         [0 1 0 0]</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">         [0 1 0 0]</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">         [1 1 1 0]]</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">inf_neighbor_nb</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_right</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_left</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">inf_neighbor_nb</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_right</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_left</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">,</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>                                               <span class="bp">self</span><span class="o">.</span><span class="n">on_the_bot</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_top</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">))</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">inf_neighbor_nb</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_right</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_left</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">,</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>                                               <span class="bp">self</span><span class="o">.</span><span class="n">on_the_bot</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_top</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">,</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>                                               <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topleft</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topright</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">,</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>                                               <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botleft</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botright</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">))</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">inf_neighbor_nb</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_topleft</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topright</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">,</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>                                               <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botleft</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botright</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">))</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">inf_neighbor_nb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inf_neighbor_nb</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>        <span class="k">if</span> <span class="n">and_itself</span><span class="p">:</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">inf_neighbor_nb</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">greater_equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">value</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="cellects.image_analysis.morphological_operations.CompareNeighborsWithValue.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">connectivity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initialize a class for array connectivity processing.</p>
<p>This class processes arrays based on given connectivities, creating
windows around the original data for both 1D and 2D arrays. Depending on
the connectivity value (4 or 8), it creates different windows with borders.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>array</code>
            </td>
            <td>
                  <code><span title="ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input array to process, can be 1D or 2D.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>connectivity</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Connectivity type for processing (4 or 8), by default None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data_type</code>
            </td>
            <td>
                  <code><span title="dtype">dtype</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data type for the array elements, by default np.int8.</p>
              </div>
            </td>
            <td>
                  <code><span title="numpy.int8">int8</span></code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="cellects.image_analysis.morphological_operations.CompareNeighborsWithValue.__init__.array">array</span></code></td>
            <td>
                  <code><span title="ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The processed array based on the given data type.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cellects.image_analysis.morphological_operations.CompareNeighborsWithValue.__init__.connectivity">connectivity</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Connectivity value used for processing.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cellects.image_analysis.morphological_operations.CompareNeighborsWithValue.__init__.on_the_right">on_the_right</span></code></td>
            <td>
                  <code><span title="ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array with shifted elements to the right.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cellects.image_analysis.morphological_operations.CompareNeighborsWithValue.__init__.on_the_left">on_the_left</span></code></td>
            <td>
                  <code><span title="ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array with shifted elements to the left.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cellects.image_analysis.morphological_operations.CompareNeighborsWithValue.__init__.on_the_bot">on_the_bot</span></code></td>
            <td>
                  <code>(<span title="ndarray">ndarray</span>, <span title="optional">optional</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array with shifted elements to the bottom (for 2D arrays).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cellects.image_analysis.morphological_operations.CompareNeighborsWithValue.__init__.on_the_top">on_the_top</span></code></td>
            <td>
                  <code>(<span title="ndarray">ndarray</span>, <span title="optional">optional</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array with shifted elements to the top (for 2D arrays).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cellects.image_analysis.morphological_operations.CompareNeighborsWithValue.__init__.on_the_topleft">on_the_topleft</span></code></td>
            <td>
                  <code>(<span title="ndarray">ndarray</span>, <span title="optional">optional</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array with shifted elements to the top left (for 2D arrays).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cellects.image_analysis.morphological_operations.CompareNeighborsWithValue.__init__.on_the_topright">on_the_topright</span></code></td>
            <td>
                  <code>(<span title="ndarray">ndarray</span>, <span title="optional">optional</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array with shifted elements to the top right (for 2D arrays).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cellects.image_analysis.morphological_operations.CompareNeighborsWithValue.__init__.on_the_botleft">on_the_botleft</span></code></td>
            <td>
                  <code>(<span title="ndarray">ndarray</span>, <span title="optional">optional</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array with shifted elements to the bottom left (for 2D arrays).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cellects.image_analysis.morphological_operations.CompareNeighborsWithValue.__init__.on_the_botright">on_the_botright</span></code></td>
            <td>
                  <code>(<span title="ndarray">ndarray</span>, <span title="optional">optional</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array with shifted elements to the bottom right (for 2D arrays).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">connectivity</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data_type</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">):</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">    Initialize a class for array connectivity processing.</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">    This class processes arrays based on given connectivities, creating</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    windows around the original data for both 1D and 2D arrays. Depending on</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">    the connectivity value (4 or 8), it creates different windows with borders.</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">    array : ndarray</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        Input array to process, can be 1D or 2D.</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">    connectivity : int, optional</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">        Connectivity type for processing (4 or 8), by default None.</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">    data_type : dtype, optional</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">        Data type for the array elements, by default np.int8.</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">    Attributes</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">    array : ndarray</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        The processed array based on the given data type.</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">    connectivity : int</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        Connectivity value used for processing.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">    on_the_right : ndarray</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        Array with shifted elements to the right.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">    on_the_left : ndarray</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        Array with shifted elements to the left.</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">    on_the_bot : ndarray, optional</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">        Array with shifted elements to the bottom (for 2D arrays).</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">    on_the_top : ndarray, optional</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">        Array with shifted elements to the top (for 2D arrays).</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">    on_the_topleft : ndarray, optional</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">        Array with shifted elements to the top left (for 2D arrays).</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">    on_the_topright : ndarray, optional</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">        Array with shifted elements to the top right (for 2D arrays).</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">    on_the_botleft : ndarray, optional</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        Array with shifted elements to the bottom left (for 2D arrays).</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">    on_the_botright : ndarray, optional</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">        Array with shifted elements to the bottom right (for 2D arrays).</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="n">array</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">data_type</span><span class="p">)</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">array</span> <span class="o">=</span> <span class="n">array</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">=</span> <span class="n">connectivity</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">on_the_right</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">on_the_left</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">array</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="c1"># Build 4 window of the original array, each missing one of the four borders</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="c1"># Grow each window with a copy of the last border at the opposite of the side a border have been deleted</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">==</span> <span class="mi">4</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">on_the_right</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:],</span> <span class="n">array</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">on_the_left</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">array</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">on_the_bot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">array</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:],</span> <span class="n">array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]))</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">on_the_top</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">array</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]))</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topleft</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topright</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botleft</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botright</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:]</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topleft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_topleft</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topleft</span><span class="p">))</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topleft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_topleft</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topleft</span><span class="p">))</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topright</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_topright</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topright</span><span class="p">))</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topright</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_topright</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topright</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botleft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_botleft</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botleft</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]))</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botleft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_botleft</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botleft</span><span class="p">))</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botright</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_botright</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botright</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]))</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botright</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_botright</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botright</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cellects.image_analysis.morphological_operations.CompareNeighborsWithValue.is_equal" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_equal</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">and_itself</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check equality of neighboring values in an array.</p>
<p>This method compares the neighbors of each element in <code>self.array</code> to a given value.
Depending on the dimensionality and connectivity settings, it checks different neighboring
elements.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>value</code>
            </td>
            <td>
                  <code><span title="int">int</span> or <span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The value to check equality with neighboring elements.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>and_itself</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, also check equality with the element itself. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="attributes-(not-standard-qt-properties)" open>
  <summary>Attributes (not standard Qt properties)</summary>
  <p>equal_neighbor_nb : ndarray of uint8
    Array that holds the number of equal neighbors for each element.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">compare</span> <span class="o">=</span> <span class="n">CompareNeighborsWithValue</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">connectivity</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">compare</span><span class="o">.</span><span class="n">is_equal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">compare</span><span class="o">.</span><span class="n">equal_neighbor_nb</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">[[0 0 1 0]</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">[0 1 1 1]</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go">[0 1 1 1]</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go">[0 0 1 0]]</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">and_itself</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">    Check equality of neighboring values in an array.</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">    This method compares the neighbors of each element in `self.array` to a given value.</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">    Depending on the dimensionality and connectivity settings, it checks different neighboring</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">    elements.</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">    value : int or float</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">        The value to check equality with neighboring elements.</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">    and_itself : bool, optional</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">        If True, also check equality with the element itself. Defaults to False.</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">    -------</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">    None</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">    Attributes (not standard Qt properties)</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">    --------------------------------------</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">    equal_neighbor_nb : ndarray of uint8</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        Array that holds the number of equal neighbors for each element.</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">    --------</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">    &gt;&gt;&gt; matrix = np.array([[9, 0, 4, 6], [4, 9, 1, 3], [7, 2, 1, 4], [9, 0, 8, 5]], dtype=np.int8)</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">    &gt;&gt;&gt; compare = CompareNeighborsWithValue(matrix, connectivity=4)</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">    &gt;&gt;&gt; compare.is_equal(1)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">    &gt;&gt;&gt; print(compare.equal_neighbor_nb)</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">    [[0 0 1 0]</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">    [0 1 1 1]</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">    [0 1 1 1]</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">    [0 0 1 0]]</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">equal_neighbor_nb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_right</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_left</span><span class="p">,</span> <span class="n">value</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">equal_neighbor_nb</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_right</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_left</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>                                             <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_bot</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_top</span><span class="p">,</span> <span class="n">value</span><span class="p">)))</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">equal_neighbor_nb</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">(</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>                <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_right</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_left</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>                 <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_bot</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_top</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>                 <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_topleft</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_topright</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>                 <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_botleft</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_botright</span><span class="p">,</span> <span class="n">value</span><span class="p">)))</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">equal_neighbor_nb</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">(</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>                <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_topleft</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_topright</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>                 <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_botleft</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_botright</span><span class="p">,</span> <span class="n">value</span><span class="p">)))</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">equal_neighbor_nb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">equal_neighbor_nb</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>    <span class="k">if</span> <span class="n">and_itself</span><span class="p">:</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">equal_neighbor_nb</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">not_equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">value</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cellects.image_analysis.morphological_operations.CompareNeighborsWithValue.is_inf" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_inf</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">and_itself</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>is_inf(value and_itself=False)</p>
<p>Determine the number of neighbors that are infinitely small relative to a given value,
considering optional connectivity and exclusion of the element itself.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>value</code>
            </td>
            <td>
                  <code><span title="numeric">numeric</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The value to compare neighbor elements against.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>and_itself</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, excludes the element itself from being counted. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">compare</span> <span class="o">=</span> <span class="n">CompareNeighborsWithValue</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">connectivity</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">compare</span><span class="o">.</span><span class="n">is_inf</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">compare</span><span class="o">.</span><span class="n">inf_neighbor_nb</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">[[1 1 1 0]</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go"> [0 1 0 0]</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go"> [0 1 0 0]</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go"> [1 1 1 0]]</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_inf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">and_itself</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">    is_inf(value and_itself=False)</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">    Determine the number of neighbors that are infinitely small relative to a given value,</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">    considering optional connectivity and exclusion of the element itself.</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">    value : numeric</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">        The value to compare neighbor elements against.</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">    and_itself : bool, optional</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">        If True, excludes the element itself from being counted. Default is False.</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">    --------</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">    &gt;&gt;&gt; matrix = np.array([[9, 0, 4, 6], [4, 9, 1, 3], [7, 2, 1, 4], [9, 0, 8, 5]], dtype=np.int8)</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">    &gt;&gt;&gt; compare = CompareNeighborsWithValue(matrix, connectivity=4)</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">    &gt;&gt;&gt; compare.is_inf(1)</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">    &gt;&gt;&gt; print(compare.inf_neighbor_nb)</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">    [[1 1 1 0]</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">     [0 1 0 0]</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">     [0 1 0 0]</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">     [1 1 1 0]]</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inf_neighbor_nb</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_right</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_left</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">inf_neighbor_nb</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_right</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_left</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">,</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>                                           <span class="bp">self</span><span class="o">.</span><span class="n">on_the_bot</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_top</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">))</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">inf_neighbor_nb</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_right</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_left</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">,</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>                                           <span class="bp">self</span><span class="o">.</span><span class="n">on_the_bot</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_top</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">,</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>                                           <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topleft</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topright</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">,</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>                                           <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botleft</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botright</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">))</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">inf_neighbor_nb</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_topleft</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topright</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">,</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>                                           <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botleft</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botright</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">))</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inf_neighbor_nb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inf_neighbor_nb</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>    <span class="k">if</span> <span class="n">and_itself</span><span class="p">:</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inf_neighbor_nb</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">greater_equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">value</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cellects.image_analysis.morphological_operations.CompareNeighborsWithValue.is_sup" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_sup</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">and_itself</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Determine if pixels have more neighbors with higher values than a given threshold.</p>
<p>This method computes the number of neighboring pixels that have values greater
than a specified <code>value</code> for each pixel in the array. Optionally, it can exclude
the pixel itself if its value is less than or equal to <code>value</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>value</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The threshold value used to determine if a neighboring pixel's value is greater.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>and_itself</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, exclude the pixel itself if its value is less than or equal to <code>value</code>.
Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">compare</span> <span class="o">=</span> <span class="n">CompareNeighborsWithValue</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">connectivity</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">compare</span><span class="o">.</span><span class="n">is_sup</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">compare</span><span class="o">.</span><span class="n">sup_neighbor_nb</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">[[3 3 2 4]</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go"> [4 2 3 3]</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go"> [4 2 3 3]</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go"> [3 3 2 4]]</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_sup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">and_itself</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">    Determine if pixels have more neighbors with higher values than a given threshold.</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">    This method computes the number of neighboring pixels that have values greater</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">    than a specified `value` for each pixel in the array. Optionally, it can exclude</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">    the pixel itself if its value is less than or equal to `value`.</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">    value : int</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">        The threshold value used to determine if a neighboring pixel&#39;s value is greater.</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">    and_itself : bool, optional</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">        If True, exclude the pixel itself if its value is less than or equal to `value`.</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">        Defaults to False.</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">    --------</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">    &gt;&gt;&gt; matrix = np.array([[9, 0, 4, 6], [4, 9, 1, 3], [7, 2, 1, 4], [9, 0, 8, 5]], dtype=np.int8)</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">    &gt;&gt;&gt; compare = CompareNeighborsWithValue(matrix, connectivity=4)</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">    &gt;&gt;&gt; compare.is_sup(1)</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">    &gt;&gt;&gt; print(compare.sup_neighbor_nb)</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">    [[3 3 2 4]</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">     [4 2 3 3]</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">     [4 2 3 3]</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">     [3 3 2 4]]</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sup_neighbor_nb</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_right</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_left</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sup_neighbor_nb</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_right</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_left</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">,</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>                                           <span class="bp">self</span><span class="o">.</span><span class="n">on_the_bot</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_top</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">))</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sup_neighbor_nb</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_right</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_left</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">,</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>                                           <span class="bp">self</span><span class="o">.</span><span class="n">on_the_bot</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_top</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">,</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>                                           <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topleft</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topright</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">,</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>                                           <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botleft</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botright</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">))</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sup_neighbor_nb</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">on_the_topleft</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_topright</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">,</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>                                           <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botleft</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_the_botright</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">))</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sup_neighbor_nb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sup_neighbor_nb</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>    <span class="k">if</span> <span class="n">and_itself</span><span class="p">:</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sup_neighbor_nb</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">less_equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">value</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="cellects.image_analysis.morphological_operations.box_counting_dimension" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">box_counting_dimension</span><span class="p">(</span><span class="n">zoomed_binary</span><span class="p">,</span> <span class="n">side_lengths</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Box counting dimension calculation.</p>
<p>This function calculates the box-counting dimension of a binary image by analyzing the number
of boxes (of varying sizes) that contain at least one pixel of the image. The function also
provides the R-squared value from linear regression and the number of boxes used.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>zoomed_binary</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.uint8">uint8</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Binary image (0 or 255 values) for which the box-counting dimension is calculated.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>side_lengths</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of side lengths for the boxes used in the box-counting calculation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>display</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, displays a scatter plot of the log-transformed box counts and diameters,
along with the linear regression fit. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>out</code></td>            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="float">float</span>, <span title="float">float</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing the calculated box-counting dimension (<code>d</code>), R-squared value (<code>r_value</code>),
and the number of boxes used (<code>box_nb</code>).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">binary_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">binary_image</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">binary_image</span><span class="p">[</span><span class="mi">7</span><span class="p">:</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">binary_image</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">zoomed_binary</span><span class="p">,</span> <span class="n">side_lengths</span> <span class="o">=</span> <span class="n">prepare_box_counting</span><span class="p">(</span><span class="n">binary_image</span><span class="p">,</span> <span class="n">min_im_side</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">min_mesh_side</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">dimension</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">box_nb</span> <span class="o">=</span> <span class="n">box_counting_dimension</span><span class="p">(</span><span class="n">zoomed_binary</span><span class="p">,</span> <span class="n">side_lengths</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">box_nb</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go">(np.float64(1.1699250014423126), np.float64(0.9999999999999998), 2)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1857">1857</a></span>
<span class="normal"><a href="#__codelineno-0-1858">1858</a></span>
<span class="normal"><a href="#__codelineno-0-1859">1859</a></span>
<span class="normal"><a href="#__codelineno-0-1860">1860</a></span>
<span class="normal"><a href="#__codelineno-0-1861">1861</a></span>
<span class="normal"><a href="#__codelineno-0-1862">1862</a></span>
<span class="normal"><a href="#__codelineno-0-1863">1863</a></span>
<span class="normal"><a href="#__codelineno-0-1864">1864</a></span>
<span class="normal"><a href="#__codelineno-0-1865">1865</a></span>
<span class="normal"><a href="#__codelineno-0-1866">1866</a></span>
<span class="normal"><a href="#__codelineno-0-1867">1867</a></span>
<span class="normal"><a href="#__codelineno-0-1868">1868</a></span>
<span class="normal"><a href="#__codelineno-0-1869">1869</a></span>
<span class="normal"><a href="#__codelineno-0-1870">1870</a></span>
<span class="normal"><a href="#__codelineno-0-1871">1871</a></span>
<span class="normal"><a href="#__codelineno-0-1872">1872</a></span>
<span class="normal"><a href="#__codelineno-0-1873">1873</a></span>
<span class="normal"><a href="#__codelineno-0-1874">1874</a></span>
<span class="normal"><a href="#__codelineno-0-1875">1875</a></span>
<span class="normal"><a href="#__codelineno-0-1876">1876</a></span>
<span class="normal"><a href="#__codelineno-0-1877">1877</a></span>
<span class="normal"><a href="#__codelineno-0-1878">1878</a></span>
<span class="normal"><a href="#__codelineno-0-1879">1879</a></span>
<span class="normal"><a href="#__codelineno-0-1880">1880</a></span>
<span class="normal"><a href="#__codelineno-0-1881">1881</a></span>
<span class="normal"><a href="#__codelineno-0-1882">1882</a></span>
<span class="normal"><a href="#__codelineno-0-1883">1883</a></span>
<span class="normal"><a href="#__codelineno-0-1884">1884</a></span>
<span class="normal"><a href="#__codelineno-0-1885">1885</a></span>
<span class="normal"><a href="#__codelineno-0-1886">1886</a></span>
<span class="normal"><a href="#__codelineno-0-1887">1887</a></span>
<span class="normal"><a href="#__codelineno-0-1888">1888</a></span>
<span class="normal"><a href="#__codelineno-0-1889">1889</a></span>
<span class="normal"><a href="#__codelineno-0-1890">1890</a></span>
<span class="normal"><a href="#__codelineno-0-1891">1891</a></span>
<span class="normal"><a href="#__codelineno-0-1892">1892</a></span>
<span class="normal"><a href="#__codelineno-0-1893">1893</a></span>
<span class="normal"><a href="#__codelineno-0-1894">1894</a></span>
<span class="normal"><a href="#__codelineno-0-1895">1895</a></span>
<span class="normal"><a href="#__codelineno-0-1896">1896</a></span>
<span class="normal"><a href="#__codelineno-0-1897">1897</a></span>
<span class="normal"><a href="#__codelineno-0-1898">1898</a></span>
<span class="normal"><a href="#__codelineno-0-1899">1899</a></span>
<span class="normal"><a href="#__codelineno-0-1900">1900</a></span>
<span class="normal"><a href="#__codelineno-0-1901">1901</a></span>
<span class="normal"><a href="#__codelineno-0-1902">1902</a></span>
<span class="normal"><a href="#__codelineno-0-1903">1903</a></span>
<span class="normal"><a href="#__codelineno-0-1904">1904</a></span>
<span class="normal"><a href="#__codelineno-0-1905">1905</a></span>
<span class="normal"><a href="#__codelineno-0-1906">1906</a></span>
<span class="normal"><a href="#__codelineno-0-1907">1907</a></span>
<span class="normal"><a href="#__codelineno-0-1908">1908</a></span>
<span class="normal"><a href="#__codelineno-0-1909">1909</a></span>
<span class="normal"><a href="#__codelineno-0-1910">1910</a></span>
<span class="normal"><a href="#__codelineno-0-1911">1911</a></span>
<span class="normal"><a href="#__codelineno-0-1912">1912</a></span>
<span class="normal"><a href="#__codelineno-0-1913">1913</a></span>
<span class="normal"><a href="#__codelineno-0-1914">1914</a></span>
<span class="normal"><a href="#__codelineno-0-1915">1915</a></span>
<span class="normal"><a href="#__codelineno-0-1916">1916</a></span>
<span class="normal"><a href="#__codelineno-0-1917">1917</a></span>
<span class="normal"><a href="#__codelineno-0-1918">1918</a></span>
<span class="normal"><a href="#__codelineno-0-1919">1919</a></span>
<span class="normal"><a href="#__codelineno-0-1920">1920</a></span>
<span class="normal"><a href="#__codelineno-0-1921">1921</a></span>
<span class="normal"><a href="#__codelineno-0-1922">1922</a></span>
<span class="normal"><a href="#__codelineno-0-1923">1923</a></span>
<span class="normal"><a href="#__codelineno-0-1924">1924</a></span>
<span class="normal"><a href="#__codelineno-0-1925">1925</a></span>
<span class="normal"><a href="#__codelineno-0-1926">1926</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1857" name="__codelineno-0-1857"></a><span class="k">def</span><span class="w"> </span><span class="nf">box_counting_dimension</span><span class="p">(</span><span class="n">zoomed_binary</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">],</span> <span class="n">side_lengths</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">display</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-0-1858" name="__codelineno-0-1858"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1859" name="__codelineno-0-1859"></a><span class="sd">    Box counting dimension calculation.</span>
<a id="__codelineno-0-1860" name="__codelineno-0-1860"></a>
<a id="__codelineno-0-1861" name="__codelineno-0-1861"></a><span class="sd">    This function calculates the box-counting dimension of a binary image by analyzing the number</span>
<a id="__codelineno-0-1862" name="__codelineno-0-1862"></a><span class="sd">    of boxes (of varying sizes) that contain at least one pixel of the image. The function also</span>
<a id="__codelineno-0-1863" name="__codelineno-0-1863"></a><span class="sd">    provides the R-squared value from linear regression and the number of boxes used.</span>
<a id="__codelineno-0-1864" name="__codelineno-0-1864"></a>
<a id="__codelineno-0-1865" name="__codelineno-0-1865"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-1866" name="__codelineno-0-1866"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-1867" name="__codelineno-0-1867"></a><span class="sd">    zoomed_binary : NDArray[np.uint8]</span>
<a id="__codelineno-0-1868" name="__codelineno-0-1868"></a><span class="sd">        Binary image (0 or 255 values) for which the box-counting dimension is calculated.</span>
<a id="__codelineno-0-1869" name="__codelineno-0-1869"></a><span class="sd">    side_lengths : NDArray</span>
<a id="__codelineno-0-1870" name="__codelineno-0-1870"></a><span class="sd">        Array of side lengths for the boxes used in the box-counting calculation.</span>
<a id="__codelineno-0-1871" name="__codelineno-0-1871"></a><span class="sd">    display : bool, optional</span>
<a id="__codelineno-0-1872" name="__codelineno-0-1872"></a><span class="sd">        If True, displays a scatter plot of the log-transformed box counts and diameters,</span>
<a id="__codelineno-0-1873" name="__codelineno-0-1873"></a><span class="sd">        along with the linear regression fit. Default is False.</span>
<a id="__codelineno-0-1874" name="__codelineno-0-1874"></a>
<a id="__codelineno-0-1875" name="__codelineno-0-1875"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-1876" name="__codelineno-0-1876"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1877" name="__codelineno-0-1877"></a><span class="sd">    out : Tuple[float, float, float]</span>
<a id="__codelineno-0-1878" name="__codelineno-0-1878"></a><span class="sd">        A tuple containing the calculated box-counting dimension (`d`), R-squared value (`r_value`),</span>
<a id="__codelineno-0-1879" name="__codelineno-0-1879"></a><span class="sd">        and the number of boxes used (`box_nb`).</span>
<a id="__codelineno-0-1880" name="__codelineno-0-1880"></a>
<a id="__codelineno-0-1881" name="__codelineno-0-1881"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-1882" name="__codelineno-0-1882"></a><span class="sd">    --------</span>
<a id="__codelineno-0-1883" name="__codelineno-0-1883"></a><span class="sd">    &gt;&gt;&gt; binary_image = np.zeros((10, 10), dtype=np.uint8)</span>
<a id="__codelineno-0-1884" name="__codelineno-0-1884"></a><span class="sd">    &gt;&gt;&gt; binary_image[2:4, 2:6] = 1</span>
<a id="__codelineno-0-1885" name="__codelineno-0-1885"></a><span class="sd">    &gt;&gt;&gt; binary_image[7:9, 4:7] = 1</span>
<a id="__codelineno-0-1886" name="__codelineno-0-1886"></a><span class="sd">    &gt;&gt;&gt; binary_image[4:7, 5] = 1</span>
<a id="__codelineno-0-1887" name="__codelineno-0-1887"></a><span class="sd">    &gt;&gt;&gt; zoomed_binary, side_lengths = prepare_box_counting(binary_image, min_im_side=2, min_mesh_side=2)</span>
<a id="__codelineno-0-1888" name="__codelineno-0-1888"></a><span class="sd">    &gt;&gt;&gt; dimension, r_value, box_nb = box_counting_dimension(zoomed_binary, side_lengths)</span>
<a id="__codelineno-0-1889" name="__codelineno-0-1889"></a><span class="sd">    &gt;&gt;&gt; print(dimension, r_value, box_nb)</span>
<a id="__codelineno-0-1890" name="__codelineno-0-1890"></a><span class="sd">    (np.float64(1.1699250014423126), np.float64(0.9999999999999998), 2)</span>
<a id="__codelineno-0-1891" name="__codelineno-0-1891"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1892" name="__codelineno-0-1892"></a>    <span class="n">dimension</span><span class="p">:</span><span class="nb">float</span> <span class="o">=</span> <span class="mf">0.</span>
<a id="__codelineno-0-1893" name="__codelineno-0-1893"></a>    <span class="n">r_value</span><span class="p">:</span><span class="nb">float</span> <span class="o">=</span> <span class="mf">0.</span>
<a id="__codelineno-0-1894" name="__codelineno-0-1894"></a>    <span class="n">box_nb</span><span class="p">:</span><span class="nb">float</span> <span class="o">=</span> <span class="mf">0.</span>
<a id="__codelineno-0-1895" name="__codelineno-0-1895"></a>    <span class="k">if</span> <span class="n">side_lengths</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1896" name="__codelineno-0-1896"></a>        <span class="n">box_counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">side_lengths</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint64</span><span class="p">)</span>
<a id="__codelineno-0-1897" name="__codelineno-0-1897"></a>        <span class="c1"># Loop through side_lengths and compute block counts</span>
<a id="__codelineno-0-1898" name="__codelineno-0-1898"></a>        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">side_length</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">side_lengths</span><span class="p">):</span>
<a id="__codelineno-0-1899" name="__codelineno-0-1899"></a>            <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">reduceat</span><span class="p">(</span>
<a id="__codelineno-0-1900" name="__codelineno-0-1900"></a>                <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">reduceat</span><span class="p">(</span><span class="n">zoomed_binary</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">zoomed_binary</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">side_length</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-1901" name="__codelineno-0-1901"></a>                <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">zoomed_binary</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">side_length</span><span class="p">),</span>
<a id="__codelineno-0-1902" name="__codelineno-0-1902"></a>                <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
<a id="__codelineno-0-1903" name="__codelineno-0-1903"></a>            <span class="p">)</span>
<a id="__codelineno-0-1904" name="__codelineno-0-1904"></a>            <span class="n">box_counts</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">S</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-1905" name="__codelineno-0-1905"></a>
<a id="__codelineno-0-1906" name="__codelineno-0-1906"></a>        <span class="n">valid_indices</span> <span class="o">=</span> <span class="n">box_counts</span> <span class="o">&gt;</span> <span class="mi">0</span>
<a id="__codelineno-0-1907" name="__codelineno-0-1907"></a>        <span class="k">if</span> <span class="n">valid_indices</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-1908" name="__codelineno-0-1908"></a>            <span class="n">log_box_counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">box_counts</span><span class="p">)</span>
<a id="__codelineno-0-1909" name="__codelineno-0-1909"></a>            <span class="n">log_reciprocal_lengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">side_lengths</span><span class="p">)</span>
<a id="__codelineno-0-1910" name="__codelineno-0-1910"></a>            <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">stderr</span> <span class="o">=</span> <span class="n">linregress</span><span class="p">(</span><span class="n">log_reciprocal_lengths</span><span class="p">,</span> <span class="n">log_box_counts</span><span class="p">)</span>
<a id="__codelineno-0-1911" name="__codelineno-0-1911"></a>            <span class="c1"># coefficients = np.polyfit(log_reciprocal_lengths, log_box_counts, 1)</span>
<a id="__codelineno-0-1912" name="__codelineno-0-1912"></a>            <span class="n">dimension</span> <span class="o">=</span> <span class="n">slope</span>
<a id="__codelineno-0-1913" name="__codelineno-0-1913"></a>            <span class="n">box_nb</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">side_lengths</span><span class="p">)</span>
<a id="__codelineno-0-1914" name="__codelineno-0-1914"></a>            <span class="k">if</span> <span class="n">display</span><span class="p">:</span>
<a id="__codelineno-0-1915" name="__codelineno-0-1915"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">log_reciprocal_lengths</span><span class="p">,</span> <span class="n">log_box_counts</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Box counting&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1916" name="__codelineno-0-1916"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">log_reciprocal_lengths</span><span class="o">.</span><span class="n">min</span><span class="p">()],</span> <span class="p">[</span><span class="n">intercept</span><span class="p">,</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">log_reciprocal_lengths</span><span class="o">.</span><span class="n">min</span><span class="p">()],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Linear regression&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1917" name="__codelineno-0-1917"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;D = </span><span class="si">{</span><span class="n">slope</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1918" name="__codelineno-0-1918"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;R2 = </span><span class="si">{</span><span class="n">r_value</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1919" name="__codelineno-0-1919"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;p-value = </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1920" name="__codelineno-0-1920"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1921" name="__codelineno-0-1921"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;log(1/Diameter) | Diameter  [</span><span class="si">{</span><span class="n">side_lengths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">side_lengths</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">] (n=</span><span class="si">{</span><span class="n">box_nb</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1922" name="__codelineno-0-1922"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;log(Box number) | Box number  [</span><span class="si">{</span><span class="n">box_counts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">box_counts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1923" name="__codelineno-0-1923"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-0-1924" name="__codelineno-0-1924"></a>                <span class="c1"># plt.close()</span>
<a id="__codelineno-0-1925" name="__codelineno-0-1925"></a>
<a id="__codelineno-0-1926" name="__codelineno-0-1926"></a>    <span class="k">return</span> <span class="n">dimension</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">box_nb</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellects.image_analysis.morphological_operations.cc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cc</span><span class="p">(</span><span class="n">binary_img</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Processes a binary image to reorder and label connected components.</p>
<p>This function takes a binary image, analyses the connected components,
reorders them by size, ensures background is correctly labeled as 0,
and returns the new ordered labels along with their statistics and centers.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>binary_img</code>
            </td>
            <td>
                  <code>ndarray of uint8</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input binary image with connected components.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>new_order</code></td>            <td>
                  <code>ndarray of uint8, uint16 or uint32</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Image with reordered labels for connected components.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>stats</code></td>            <td>
                  <code>ndarray of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Statistics for each component (x, y, width, height, area).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>centers</code></td>            <td>
                  <code>ndarray of floats</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Centers for each component (x, y).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">binary_img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">new_order</span><span class="p">,</span> <span class="n">stats</span><span class="p">,</span> <span class="n">centers</span> <span class="o">=</span> <span class="n">cc</span><span class="p">(</span><span class="n">binary_img</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">stats</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go">array([[0, 0, 3, 2, 4],</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">   [1, 0, 2, 2, 2]], dtype=int32)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="k">def</span><span class="w"> </span><span class="nf">cc</span><span class="p">(</span><span class="n">binary_img</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">]:</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">    Processes a binary image to reorder and label connected components.</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">    This function takes a binary image, analyses the connected components,</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">    reorders them by size, ensures background is correctly labeled as 0,</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">    and returns the new ordered labels along with their statistics and centers.</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">    binary_img : ndarray of uint8</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">        Input binary image with connected components.</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">    -------</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">    new_order : ndarray of uint8, uint16 or uint32</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">        Image with reordered labels for connected components.</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">    stats : ndarray of ints</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">        Statistics for each component (x, y, width, height, area).</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">    centers : ndarray of floats</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">        Centers for each component (x, y).</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">    --------</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">    &gt;&gt;&gt; binary_img = np.array([[0, 1, 0], [0, 1, 0]], dtype=np.uint8)</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">    &gt;&gt;&gt; new_order, stats, centers = cc(binary_img)</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">    &gt;&gt;&gt; print(stats)</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">    array([[0, 0, 3, 2, 4],</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">       [1, 0, 2, 2, 2]], dtype=int32)</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>    <span class="n">number</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">stats</span><span class="p">,</span> <span class="n">centers</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">connectedComponentsWithStats</span><span class="p">(</span><span class="n">binary_img</span><span class="p">,</span> <span class="n">ltype</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">CV_16U</span><span class="p">)</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>    <span class="k">if</span> <span class="n">number</span> <span class="o">&gt;</span> <span class="mi">255</span><span class="p">:</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>        <span class="n">img_dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint16</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>        <span class="k">if</span> <span class="n">number</span> <span class="o">&gt;</span> <span class="mi">65535</span><span class="p">:</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>            <span class="n">img_dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>        <span class="n">img_dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>    <span class="n">stats</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">stats</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>    <span class="n">stats</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">stats</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>    <span class="n">sorted_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">stats</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">])[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>    <span class="c1"># Make sure that the first connected component (labelled 0) is the background and not the main shape</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>    <span class="n">size_ranked_stats</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="n">sorted_idx</span><span class="p">,</span> <span class="p">:]</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>    <span class="n">background</span> <span class="o">=</span> <span class="p">(</span><span class="n">size_ranked_stats</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">size_ranked_stats</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>            <span class="n">size_ranked_stats</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>                         <span class="n">size_ranked_stats</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>    <span class="c1"># background = ((size_ranked_stats[:, 0] == 0) &amp; (size_ranked_stats[:, 1] == 0) &amp; (size_ranked_stats[:, 2] == img.shape[1]) &amp; (size_ranked_stats[:, 3] == img.shape[0]))</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>    <span class="n">touch_borders</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">background</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>    <span class="c1"># if not isinstance(touch_borders, np.int64):</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>    <span class="c1">#     touch_borders = touch_borders[0]</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>    <span class="c1"># Most of the time, the background should be the largest shape and therefore has the index 0,</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>    <span class="c1"># Then, if there is at least one shape touching more than 2 borders and having not the index 0, solve:</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">touch_borders</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>        <span class="c1"># If there is only one shape touching borders, it means that background is not at its right position (i.e. 0)</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">touch_borders</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>            <span class="c1"># Then exchange that shape position with background position</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>            <span class="n">shape</span> <span class="o">=</span> <span class="n">sorted_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Store shape position in the first place</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>            <span class="n">back</span> <span class="o">=</span> <span class="n">sorted_idx</span><span class="p">[</span><span class="n">touch_borders</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>  <span class="c1"># Store back position in the first place</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>            <span class="n">sorted_idx</span><span class="p">[</span><span class="n">touch_borders</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">shape</span>  <span class="c1"># Put shape position at the previous place of back and conversely</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>            <span class="n">sorted_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">back</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>        <span class="c1"># If there are two shapes, it means that the main shape grew sufficiently to reach at least 3 borders</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>        <span class="c1"># We assume that it grew larger than background</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>            <span class="n">shape</span> <span class="o">=</span> <span class="n">sorted_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>            <span class="n">back</span> <span class="o">=</span> <span class="n">sorted_idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>            <span class="n">sorted_idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">shape</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>            <span class="n">sorted_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">back</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>            <span class="c1"># Put shape position at the previous place of back and conversely</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>    <span class="n">stats</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="n">sorted_idx</span><span class="p">,</span> <span class="p">:]</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>    <span class="n">centers</span> <span class="o">=</span> <span class="n">centers</span><span class="p">[</span><span class="n">sorted_idx</span><span class="p">,</span> <span class="p">:]</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>    <span class="n">new_order</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">binary_img</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">img_dtype</span><span class="p">)</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sorted_idx</span><span class="p">):</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>        <span class="n">new_order</span><span class="p">[</span><span class="n">img</span> <span class="o">==</span> <span class="n">val</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>    <span class="k">return</span> <span class="n">new_order</span><span class="p">,</span> <span class="n">stats</span><span class="p">,</span> <span class="n">centers</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellects.image_analysis.morphological_operations.close_holes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">close_holes</span><span class="p">(</span><span class="n">binary_img</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Close holes in a binary image using connected components analysis.</p>
<p>This function identifies and closes small holes within the foreground objects of a binary image. It uses connected component analysis to find and fill holes that are smaller than the main object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>binary_img</code>
            </td>
            <td>
                  <code>ndarray of uint8</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Binary input image where holes need to be closed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>out</code></td>            <td>
                  <code>ndarray of uint8</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Binary image with closed holes.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">binary_img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">binary_img</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">binary_img</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Creating a hole</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">close_holes</span><span class="p">(</span><span class="n">binary_img</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">[[0 0 0 0 0 0 0 0 0 0]</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go"> [0 0 0 0 0 0 0 0 0 0]</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go"> [0 0 1 1 1 1 1 1 0 0]</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go"> [0 0 1 1 1 1 1 1 0 0]</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="go"> [0 0 1 1 1 1 1 1 0 0]</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="go"> [0 0 1 1 1 1 1 1 0 0]</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="go"> [0 0 1 1 1 1 1 1 0 0]</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="go"> [0 0 1 1 1 1 1 1 0 0]</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="go"> [0 0 0 0 0 0 0 0 0 0]</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="go"> [0 0 0 0 0 0 0 0 0 0]]</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1358">1358</a></span>
<span class="normal"><a href="#__codelineno-0-1359">1359</a></span>
<span class="normal"><a href="#__codelineno-0-1360">1360</a></span>
<span class="normal"><a href="#__codelineno-0-1361">1361</a></span>
<span class="normal"><a href="#__codelineno-0-1362">1362</a></span>
<span class="normal"><a href="#__codelineno-0-1363">1363</a></span>
<span class="normal"><a href="#__codelineno-0-1364">1364</a></span>
<span class="normal"><a href="#__codelineno-0-1365">1365</a></span>
<span class="normal"><a href="#__codelineno-0-1366">1366</a></span>
<span class="normal"><a href="#__codelineno-0-1367">1367</a></span>
<span class="normal"><a href="#__codelineno-0-1368">1368</a></span>
<span class="normal"><a href="#__codelineno-0-1369">1369</a></span>
<span class="normal"><a href="#__codelineno-0-1370">1370</a></span>
<span class="normal"><a href="#__codelineno-0-1371">1371</a></span>
<span class="normal"><a href="#__codelineno-0-1372">1372</a></span>
<span class="normal"><a href="#__codelineno-0-1373">1373</a></span>
<span class="normal"><a href="#__codelineno-0-1374">1374</a></span>
<span class="normal"><a href="#__codelineno-0-1375">1375</a></span>
<span class="normal"><a href="#__codelineno-0-1376">1376</a></span>
<span class="normal"><a href="#__codelineno-0-1377">1377</a></span>
<span class="normal"><a href="#__codelineno-0-1378">1378</a></span>
<span class="normal"><a href="#__codelineno-0-1379">1379</a></span>
<span class="normal"><a href="#__codelineno-0-1380">1380</a></span>
<span class="normal"><a href="#__codelineno-0-1381">1381</a></span>
<span class="normal"><a href="#__codelineno-0-1382">1382</a></span>
<span class="normal"><a href="#__codelineno-0-1383">1383</a></span>
<span class="normal"><a href="#__codelineno-0-1384">1384</a></span>
<span class="normal"><a href="#__codelineno-0-1385">1385</a></span>
<span class="normal"><a href="#__codelineno-0-1386">1386</a></span>
<span class="normal"><a href="#__codelineno-0-1387">1387</a></span>
<span class="normal"><a href="#__codelineno-0-1388">1388</a></span>
<span class="normal"><a href="#__codelineno-0-1389">1389</a></span>
<span class="normal"><a href="#__codelineno-0-1390">1390</a></span>
<span class="normal"><a href="#__codelineno-0-1391">1391</a></span>
<span class="normal"><a href="#__codelineno-0-1392">1392</a></span>
<span class="normal"><a href="#__codelineno-0-1393">1393</a></span>
<span class="normal"><a href="#__codelineno-0-1394">1394</a></span>
<span class="normal"><a href="#__codelineno-0-1395">1395</a></span>
<span class="normal"><a href="#__codelineno-0-1396">1396</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1358" name="__codelineno-0-1358"></a><span class="k">def</span><span class="w"> </span><span class="nf">close_holes</span><span class="p">(</span><span class="n">binary_img</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">]:</span>
<a id="__codelineno-0-1359" name="__codelineno-0-1359"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1360" name="__codelineno-0-1360"></a><span class="sd">    Close holes in a binary image using connected components analysis.</span>
<a id="__codelineno-0-1361" name="__codelineno-0-1361"></a>
<a id="__codelineno-0-1362" name="__codelineno-0-1362"></a><span class="sd">    This function identifies and closes small holes within the foreground objects of a binary image. It uses connected component analysis to find and fill holes that are smaller than the main object.</span>
<a id="__codelineno-0-1363" name="__codelineno-0-1363"></a>
<a id="__codelineno-0-1364" name="__codelineno-0-1364"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-1365" name="__codelineno-0-1365"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-1366" name="__codelineno-0-1366"></a><span class="sd">    binary_img : ndarray of uint8</span>
<a id="__codelineno-0-1367" name="__codelineno-0-1367"></a><span class="sd">        Binary input image where holes need to be closed.</span>
<a id="__codelineno-0-1368" name="__codelineno-0-1368"></a>
<a id="__codelineno-0-1369" name="__codelineno-0-1369"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-1370" name="__codelineno-0-1370"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1371" name="__codelineno-0-1371"></a><span class="sd">    out : ndarray of uint8</span>
<a id="__codelineno-0-1372" name="__codelineno-0-1372"></a><span class="sd">        Binary image with closed holes.</span>
<a id="__codelineno-0-1373" name="__codelineno-0-1373"></a>
<a id="__codelineno-0-1374" name="__codelineno-0-1374"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-1375" name="__codelineno-0-1375"></a><span class="sd">    --------</span>
<a id="__codelineno-0-1376" name="__codelineno-0-1376"></a><span class="sd">    &gt;&gt;&gt; binary_img = np.zeros((10, 10), dtype=np.uint8)</span>
<a id="__codelineno-0-1377" name="__codelineno-0-1377"></a><span class="sd">    &gt;&gt;&gt; binary_img[2:8, 2:8] = 1</span>
<a id="__codelineno-0-1378" name="__codelineno-0-1378"></a><span class="sd">    &gt;&gt;&gt; binary_img[4:6, 4:6] = 0  # Creating a hole</span>
<a id="__codelineno-0-1379" name="__codelineno-0-1379"></a><span class="sd">    &gt;&gt;&gt; result = close_holes(binary_img)</span>
<a id="__codelineno-0-1380" name="__codelineno-0-1380"></a><span class="sd">    &gt;&gt;&gt; print(result)</span>
<a id="__codelineno-0-1381" name="__codelineno-0-1381"></a><span class="sd">    [[0 0 0 0 0 0 0 0 0 0]</span>
<a id="__codelineno-0-1382" name="__codelineno-0-1382"></a><span class="sd">     [0 0 0 0 0 0 0 0 0 0]</span>
<a id="__codelineno-0-1383" name="__codelineno-0-1383"></a><span class="sd">     [0 0 1 1 1 1 1 1 0 0]</span>
<a id="__codelineno-0-1384" name="__codelineno-0-1384"></a><span class="sd">     [0 0 1 1 1 1 1 1 0 0]</span>
<a id="__codelineno-0-1385" name="__codelineno-0-1385"></a><span class="sd">     [0 0 1 1 1 1 1 1 0 0]</span>
<a id="__codelineno-0-1386" name="__codelineno-0-1386"></a><span class="sd">     [0 0 1 1 1 1 1 1 0 0]</span>
<a id="__codelineno-0-1387" name="__codelineno-0-1387"></a><span class="sd">     [0 0 1 1 1 1 1 1 0 0]</span>
<a id="__codelineno-0-1388" name="__codelineno-0-1388"></a><span class="sd">     [0 0 1 1 1 1 1 1 0 0]</span>
<a id="__codelineno-0-1389" name="__codelineno-0-1389"></a><span class="sd">     [0 0 0 0 0 0 0 0 0 0]</span>
<a id="__codelineno-0-1390" name="__codelineno-0-1390"></a><span class="sd">     [0 0 0 0 0 0 0 0 0 0]]</span>
<a id="__codelineno-0-1391" name="__codelineno-0-1391"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1392" name="__codelineno-0-1392"></a>    <span class="c1">#### Third version ####</span>
<a id="__codelineno-0-1393" name="__codelineno-0-1393"></a>    <span class="n">nb</span><span class="p">,</span> <span class="n">new_order</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">connectedComponents</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">binary_img</span><span class="p">)</span>
<a id="__codelineno-0-1394" name="__codelineno-0-1394"></a>    <span class="k">if</span> <span class="n">nb</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-1395" name="__codelineno-0-1395"></a>        <span class="n">binary_img</span><span class="p">[</span><span class="n">new_order</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-1396" name="__codelineno-0-1396"></a>    <span class="k">return</span> <span class="n">binary_img</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellects.image_analysis.morphological_operations.create_ellipse" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_ellipse</span><span class="p">(</span><span class="n">vsize_in</span><span class="p">,</span> <span class="n">hsize_in</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create a 2D array representing an ellipse with given vertical and horizontal sizes.</p>
<p>This function generates a NumPy boolean array where each element is <code>True</code> if the point lies within or on
the boundary of an ellipse defined by its vertical and horizontal radii. The ellipse is centered at the center
of the array, which corresponds to the midpoint of the given dimensions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>vsize_in</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vertical size (number of rows) in the output 2D array.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hsize_in</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Horizontal size (number of columns) in the output 2D array.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A boolean NumPy array of shape <code>(vsize, hsize)</code> where <code>True</code> indicates that a pixel lies within or on
the boundary of an ellipse centered at the image's center with radii determined by half of the dimensions.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>If either vertical or horizontal size is zero, it defaults to 3 as in the original class behavior.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1459">1459</a></span>
<span class="normal"><a href="#__codelineno-0-1460">1460</a></span>
<span class="normal"><a href="#__codelineno-0-1461">1461</a></span>
<span class="normal"><a href="#__codelineno-0-1462">1462</a></span>
<span class="normal"><a href="#__codelineno-0-1463">1463</a></span>
<span class="normal"><a href="#__codelineno-0-1464">1464</a></span>
<span class="normal"><a href="#__codelineno-0-1465">1465</a></span>
<span class="normal"><a href="#__codelineno-0-1466">1466</a></span>
<span class="normal"><a href="#__codelineno-0-1467">1467</a></span>
<span class="normal"><a href="#__codelineno-0-1468">1468</a></span>
<span class="normal"><a href="#__codelineno-0-1469">1469</a></span>
<span class="normal"><a href="#__codelineno-0-1470">1470</a></span>
<span class="normal"><a href="#__codelineno-0-1471">1471</a></span>
<span class="normal"><a href="#__codelineno-0-1472">1472</a></span>
<span class="normal"><a href="#__codelineno-0-1473">1473</a></span>
<span class="normal"><a href="#__codelineno-0-1474">1474</a></span>
<span class="normal"><a href="#__codelineno-0-1475">1475</a></span>
<span class="normal"><a href="#__codelineno-0-1476">1476</a></span>
<span class="normal"><a href="#__codelineno-0-1477">1477</a></span>
<span class="normal"><a href="#__codelineno-0-1478">1478</a></span>
<span class="normal"><a href="#__codelineno-0-1479">1479</a></span>
<span class="normal"><a href="#__codelineno-0-1480">1480</a></span>
<span class="normal"><a href="#__codelineno-0-1481">1481</a></span>
<span class="normal"><a href="#__codelineno-0-1482">1482</a></span>
<span class="normal"><a href="#__codelineno-0-1483">1483</a></span>
<span class="normal"><a href="#__codelineno-0-1484">1484</a></span>
<span class="normal"><a href="#__codelineno-0-1485">1485</a></span>
<span class="normal"><a href="#__codelineno-0-1486">1486</a></span>
<span class="normal"><a href="#__codelineno-0-1487">1487</a></span>
<span class="normal"><a href="#__codelineno-0-1488">1488</a></span>
<span class="normal"><a href="#__codelineno-0-1489">1489</a></span>
<span class="normal"><a href="#__codelineno-0-1490">1490</a></span>
<span class="normal"><a href="#__codelineno-0-1491">1491</a></span>
<span class="normal"><a href="#__codelineno-0-1492">1492</a></span>
<span class="normal"><a href="#__codelineno-0-1493">1493</a></span>
<span class="normal"><a href="#__codelineno-0-1494">1494</a></span>
<span class="normal"><a href="#__codelineno-0-1495">1495</a></span>
<span class="normal"><a href="#__codelineno-0-1496">1496</a></span>
<span class="normal"><a href="#__codelineno-0-1497">1497</a></span>
<span class="normal"><a href="#__codelineno-0-1498">1498</a></span>
<span class="normal"><a href="#__codelineno-0-1499">1499</a></span>
<span class="normal"><a href="#__codelineno-0-1500">1500</a></span>
<span class="normal"><a href="#__codelineno-0-1501">1501</a></span>
<span class="normal"><a href="#__codelineno-0-1502">1502</a></span>
<span class="normal"><a href="#__codelineno-0-1503">1503</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1459" name="__codelineno-0-1459"></a><span class="nd">@njit</span><span class="p">()</span>
<a id="__codelineno-0-1460" name="__codelineno-0-1460"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_ellipse</span><span class="p">(</span><span class="n">vsize_in</span><span class="p">,</span> <span class="n">hsize_in</span><span class="p">):</span>
<a id="__codelineno-0-1461" name="__codelineno-0-1461"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1462" name="__codelineno-0-1462"></a><span class="sd">    Create a 2D array representing an ellipse with given vertical and horizontal sizes.</span>
<a id="__codelineno-0-1463" name="__codelineno-0-1463"></a>
<a id="__codelineno-0-1464" name="__codelineno-0-1464"></a><span class="sd">    This function generates a NumPy boolean array where each element is `True` if the point lies within or on</span>
<a id="__codelineno-0-1465" name="__codelineno-0-1465"></a><span class="sd">    the boundary of an ellipse defined by its vertical and horizontal radii. The ellipse is centered at the center</span>
<a id="__codelineno-0-1466" name="__codelineno-0-1466"></a><span class="sd">    of the array, which corresponds to the midpoint of the given dimensions.</span>
<a id="__codelineno-0-1467" name="__codelineno-0-1467"></a>
<a id="__codelineno-0-1468" name="__codelineno-0-1468"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-1469" name="__codelineno-0-1469"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-1470" name="__codelineno-0-1470"></a><span class="sd">    vsize_in : int</span>
<a id="__codelineno-0-1471" name="__codelineno-0-1471"></a><span class="sd">        Vertical size (number of rows) in the output 2D array.</span>
<a id="__codelineno-0-1472" name="__codelineno-0-1472"></a><span class="sd">    hsize_in : int</span>
<a id="__codelineno-0-1473" name="__codelineno-0-1473"></a><span class="sd">        Horizontal size (number of columns) in the output 2D array.</span>
<a id="__codelineno-0-1474" name="__codelineno-0-1474"></a>
<a id="__codelineno-0-1475" name="__codelineno-0-1475"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-1476" name="__codelineno-0-1476"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1477" name="__codelineno-0-1477"></a><span class="sd">    NDArray[bool]</span>
<a id="__codelineno-0-1478" name="__codelineno-0-1478"></a><span class="sd">        A boolean NumPy array of shape `(vsize, hsize)` where `True` indicates that a pixel lies within or on</span>
<a id="__codelineno-0-1479" name="__codelineno-0-1479"></a><span class="sd">        the boundary of an ellipse centered at the image&#39;s center with radii determined by half of the dimensions.</span>
<a id="__codelineno-0-1480" name="__codelineno-0-1480"></a>
<a id="__codelineno-0-1481" name="__codelineno-0-1481"></a><span class="sd">    Notes</span>
<a id="__codelineno-0-1482" name="__codelineno-0-1482"></a><span class="sd">    -----</span>
<a id="__codelineno-0-1483" name="__codelineno-0-1483"></a><span class="sd">    If either vertical or horizontal size is zero, it defaults to 3 as in the original class behavior.</span>
<a id="__codelineno-0-1484" name="__codelineno-0-1484"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1485" name="__codelineno-0-1485"></a>    <span class="c1"># Use default values if input sizes are zero</span>
<a id="__codelineno-0-1486" name="__codelineno-0-1486"></a>    <span class="n">vsize</span> <span class="o">=</span> <span class="mi">3</span> <span class="k">if</span> <span class="n">vsize_in</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">vsize_in</span>
<a id="__codelineno-0-1487" name="__codelineno-0-1487"></a>    <span class="n">hsize</span> <span class="o">=</span> <span class="mi">3</span> <span class="k">if</span> <span class="n">hsize_in</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">hsize_in</span>
<a id="__codelineno-0-1488" name="__codelineno-0-1488"></a>
<a id="__codelineno-0-1489" name="__codelineno-0-1489"></a>    <span class="c1"># Compute radii (half of each size)</span>
<a id="__codelineno-0-1490" name="__codelineno-0-1490"></a>    <span class="n">vr</span> <span class="o">=</span> <span class="n">hsize</span> <span class="o">//</span> <span class="mi">2</span>
<a id="__codelineno-0-1491" name="__codelineno-0-1491"></a>    <span class="n">hr</span> <span class="o">=</span> <span class="n">vsize</span> <span class="o">//</span> <span class="mi">2</span>
<a id="__codelineno-0-1492" name="__codelineno-0-1492"></a>
<a id="__codelineno-0-1493" name="__codelineno-0-1493"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">vsize</span><span class="p">,</span> <span class="n">hsize</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">)</span>
<a id="__codelineno-0-1494" name="__codelineno-0-1494"></a>    <span class="k">if</span> <span class="n">vr</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">hr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1495" name="__codelineno-0-1495"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">vsize</span><span class="p">):</span>
<a id="__codelineno-0-1496" name="__codelineno-0-1496"></a>            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">hsize</span><span class="p">):</span>
<a id="__codelineno-0-1497" name="__codelineno-0-1497"></a>                <span class="n">x</span> <span class="o">=</span> <span class="n">i</span>
<a id="__codelineno-0-1498" name="__codelineno-0-1498"></a>                <span class="n">y</span> <span class="o">=</span> <span class="n">j</span>
<a id="__codelineno-0-1499" name="__codelineno-0-1499"></a>                <span class="n">lhs</span> <span class="o">=</span> <span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">hr</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">hr</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="p">((</span><span class="n">y</span> <span class="o">-</span> <span class="n">vr</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">vr</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-0-1500" name="__codelineno-0-1500"></a>                <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">lhs</span> <span class="o">&lt;=</span> <span class="mi">1</span>
<a id="__codelineno-0-1501" name="__codelineno-0-1501"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1502" name="__codelineno-0-1502"></a>        <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1503" name="__codelineno-0-1503"></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellects.image_analysis.morphological_operations.create_mask" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_mask</span><span class="p">(</span><span class="n">dims</span><span class="p">,</span> <span class="n">minmax</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create a boolean mask based on given dimensions and min/max coordinates.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dims</code>
            </td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="int">int</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dimensions of the mask (height and width).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>minmax</code>
            </td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="int">int</span>, <span title="int">int</span>, <span title="int">int</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The minimum and maximum coordinates for the mask (x_min, x_max,
y_min, y_max).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shape</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The shape of the mask. Should be either 'circle' or any other value for a rectangular mask.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span>[<span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A boolean NumPy array with the same dimensions as <code>dims</code>, initialized to False,
where the specified region (or circle) is set to True.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the shape is 'circle' and the ellipse creation fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>If <code>shape</code> is not 'circle', a rectangular mask will be created. The ellipse
creation method used may have specific performance considerations.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">create_mask</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="s1">&#39;circle&#39;</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go">[[False False False  True False False]</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go"> [False False  True  True  True False]</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go"> [False  True  True  True  True False]</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go"> [False False  True  True  True False]</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go"> [False False False  True False False]]</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2051">2051</a></span>
<span class="normal"><a href="#__codelineno-0-2052">2052</a></span>
<span class="normal"><a href="#__codelineno-0-2053">2053</a></span>
<span class="normal"><a href="#__codelineno-0-2054">2054</a></span>
<span class="normal"><a href="#__codelineno-0-2055">2055</a></span>
<span class="normal"><a href="#__codelineno-0-2056">2056</a></span>
<span class="normal"><a href="#__codelineno-0-2057">2057</a></span>
<span class="normal"><a href="#__codelineno-0-2058">2058</a></span>
<span class="normal"><a href="#__codelineno-0-2059">2059</a></span>
<span class="normal"><a href="#__codelineno-0-2060">2060</a></span>
<span class="normal"><a href="#__codelineno-0-2061">2061</a></span>
<span class="normal"><a href="#__codelineno-0-2062">2062</a></span>
<span class="normal"><a href="#__codelineno-0-2063">2063</a></span>
<span class="normal"><a href="#__codelineno-0-2064">2064</a></span>
<span class="normal"><a href="#__codelineno-0-2065">2065</a></span>
<span class="normal"><a href="#__codelineno-0-2066">2066</a></span>
<span class="normal"><a href="#__codelineno-0-2067">2067</a></span>
<span class="normal"><a href="#__codelineno-0-2068">2068</a></span>
<span class="normal"><a href="#__codelineno-0-2069">2069</a></span>
<span class="normal"><a href="#__codelineno-0-2070">2070</a></span>
<span class="normal"><a href="#__codelineno-0-2071">2071</a></span>
<span class="normal"><a href="#__codelineno-0-2072">2072</a></span>
<span class="normal"><a href="#__codelineno-0-2073">2073</a></span>
<span class="normal"><a href="#__codelineno-0-2074">2074</a></span>
<span class="normal"><a href="#__codelineno-0-2075">2075</a></span>
<span class="normal"><a href="#__codelineno-0-2076">2076</a></span>
<span class="normal"><a href="#__codelineno-0-2077">2077</a></span>
<span class="normal"><a href="#__codelineno-0-2078">2078</a></span>
<span class="normal"><a href="#__codelineno-0-2079">2079</a></span>
<span class="normal"><a href="#__codelineno-0-2080">2080</a></span>
<span class="normal"><a href="#__codelineno-0-2081">2081</a></span>
<span class="normal"><a href="#__codelineno-0-2082">2082</a></span>
<span class="normal"><a href="#__codelineno-0-2083">2083</a></span>
<span class="normal"><a href="#__codelineno-0-2084">2084</a></span>
<span class="normal"><a href="#__codelineno-0-2085">2085</a></span>
<span class="normal"><a href="#__codelineno-0-2086">2086</a></span>
<span class="normal"><a href="#__codelineno-0-2087">2087</a></span>
<span class="normal"><a href="#__codelineno-0-2088">2088</a></span>
<span class="normal"><a href="#__codelineno-0-2089">2089</a></span>
<span class="normal"><a href="#__codelineno-0-2090">2090</a></span>
<span class="normal"><a href="#__codelineno-0-2091">2091</a></span>
<span class="normal"><a href="#__codelineno-0-2092">2092</a></span>
<span class="normal"><a href="#__codelineno-0-2093">2093</a></span>
<span class="normal"><a href="#__codelineno-0-2094">2094</a></span>
<span class="normal"><a href="#__codelineno-0-2095">2095</a></span>
<span class="normal"><a href="#__codelineno-0-2096">2096</a></span>
<span class="normal"><a href="#__codelineno-0-2097">2097</a></span>
<span class="normal"><a href="#__codelineno-0-2098">2098</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2051" name="__codelineno-0-2051"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_mask</span><span class="p">(</span><span class="n">dims</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">minmax</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">shape</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-2052" name="__codelineno-0-2052"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2053" name="__codelineno-0-2053"></a>
<a id="__codelineno-0-2054" name="__codelineno-0-2054"></a><span class="sd">    Create a boolean mask based on given dimensions and min/max coordinates.</span>
<a id="__codelineno-0-2055" name="__codelineno-0-2055"></a>
<a id="__codelineno-0-2056" name="__codelineno-0-2056"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-2057" name="__codelineno-0-2057"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-2058" name="__codelineno-0-2058"></a><span class="sd">    dims : Tuple[int, int]</span>
<a id="__codelineno-0-2059" name="__codelineno-0-2059"></a><span class="sd">        The dimensions of the mask (height and width).</span>
<a id="__codelineno-0-2060" name="__codelineno-0-2060"></a><span class="sd">    minmax : Tuple[int, int, int, int]</span>
<a id="__codelineno-0-2061" name="__codelineno-0-2061"></a><span class="sd">        The minimum and maximum coordinates for the mask (x_min, x_max,</span>
<a id="__codelineno-0-2062" name="__codelineno-0-2062"></a><span class="sd">        y_min, y_max).</span>
<a id="__codelineno-0-2063" name="__codelineno-0-2063"></a><span class="sd">    shape : str</span>
<a id="__codelineno-0-2064" name="__codelineno-0-2064"></a><span class="sd">        The shape of the mask. Should be either &#39;circle&#39; or any other value for a rectangular mask.</span>
<a id="__codelineno-0-2065" name="__codelineno-0-2065"></a>
<a id="__codelineno-0-2066" name="__codelineno-0-2066"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-2067" name="__codelineno-0-2067"></a><span class="sd">    -------</span>
<a id="__codelineno-0-2068" name="__codelineno-0-2068"></a><span class="sd">    np.ndarray[bool]</span>
<a id="__codelineno-0-2069" name="__codelineno-0-2069"></a><span class="sd">        A boolean NumPy array with the same dimensions as `dims`, initialized to False,</span>
<a id="__codelineno-0-2070" name="__codelineno-0-2070"></a><span class="sd">        where the specified region (or circle) is set to True.</span>
<a id="__codelineno-0-2071" name="__codelineno-0-2071"></a>
<a id="__codelineno-0-2072" name="__codelineno-0-2072"></a><span class="sd">    Raises</span>
<a id="__codelineno-0-2073" name="__codelineno-0-2073"></a><span class="sd">    ------</span>
<a id="__codelineno-0-2074" name="__codelineno-0-2074"></a><span class="sd">    ValueError</span>
<a id="__codelineno-0-2075" name="__codelineno-0-2075"></a><span class="sd">        If the shape is &#39;circle&#39; and the ellipse creation fails.</span>
<a id="__codelineno-0-2076" name="__codelineno-0-2076"></a>
<a id="__codelineno-0-2077" name="__codelineno-0-2077"></a><span class="sd">    Notes</span>
<a id="__codelineno-0-2078" name="__codelineno-0-2078"></a><span class="sd">    -----</span>
<a id="__codelineno-0-2079" name="__codelineno-0-2079"></a><span class="sd">    If `shape` is not &#39;circle&#39;, a rectangular mask will be created. The ellipse</span>
<a id="__codelineno-0-2080" name="__codelineno-0-2080"></a><span class="sd">    creation method used may have specific performance considerations.</span>
<a id="__codelineno-0-2081" name="__codelineno-0-2081"></a>
<a id="__codelineno-0-2082" name="__codelineno-0-2082"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-2083" name="__codelineno-0-2083"></a><span class="sd">    --------</span>
<a id="__codelineno-0-2084" name="__codelineno-0-2084"></a><span class="sd">    &gt;&gt;&gt; mask = create_mask((5, 6), (0, 5, 1, 5), &#39;circle&#39;)</span>
<a id="__codelineno-0-2085" name="__codelineno-0-2085"></a><span class="sd">    &gt;&gt;&gt; print(mask)</span>
<a id="__codelineno-0-2086" name="__codelineno-0-2086"></a><span class="sd">    [[False False False  True False False]</span>
<a id="__codelineno-0-2087" name="__codelineno-0-2087"></a><span class="sd">     [False False  True  True  True False]</span>
<a id="__codelineno-0-2088" name="__codelineno-0-2088"></a><span class="sd">     [False  True  True  True  True False]</span>
<a id="__codelineno-0-2089" name="__codelineno-0-2089"></a><span class="sd">     [False False  True  True  True False]</span>
<a id="__codelineno-0-2090" name="__codelineno-0-2090"></a><span class="sd">     [False False False  True False False]]</span>
<a id="__codelineno-0-2091" name="__codelineno-0-2091"></a><span class="sd">     &quot;&quot;&quot;</span>
<a id="__codelineno-0-2092" name="__codelineno-0-2092"></a>    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">dims</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
<a id="__codelineno-0-2093" name="__codelineno-0-2093"></a>    <span class="k">if</span> <span class="n">shape</span> <span class="o">==</span> <span class="s1">&#39;circle&#39;</span><span class="p">:</span>
<a id="__codelineno-0-2094" name="__codelineno-0-2094"></a>        <span class="n">ellipse</span> <span class="o">=</span> <span class="n">create_ellipse</span><span class="p">(</span><span class="n">minmax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">minmax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">minmax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">minmax</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<a id="__codelineno-0-2095" name="__codelineno-0-2095"></a>        <span class="n">mask</span><span class="p">[</span><span class="n">minmax</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">minmax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">minmax</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span><span class="n">minmax</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="n">ellipse</span>
<a id="__codelineno-0-2096" name="__codelineno-0-2096"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2097" name="__codelineno-0-2097"></a>        <span class="n">mask</span><span class="p">[</span><span class="n">minmax</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">minmax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">minmax</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span><span class="n">minmax</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-2098" name="__codelineno-0-2098"></a>    <span class="k">return</span> <span class="n">mask</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellects.image_analysis.morphological_operations.draw_img_with_mask" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">draw_img_with_mask</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">minmax</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">drawing</span><span class="p">,</span> <span class="n">only_contours</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dilate_mask</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Draw an image with a mask and optional contours.</p>
<p>Draws a subregion of the input image using a specified shape (circle or rectangle),
which can be dilated. The mask can be limited to contours only, and an optional
drawing (overlay) can be applied within the masked region.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>img</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input image to draw on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dims</code>
            </td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="int">int</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dimensions of the subregion (width, height).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>minmax</code>
            </td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="int">int</span>, <span title="int">int</span>, <span title="int">int</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Coordinates of the subregion (x_start, x_end, y_start, y_end).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shape</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Shape of the mask to draw ('circle' or 'rectangle').</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>drawing</code>
            </td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="numpy.typing.NDArray">NDArray</span>, <span title="numpy.typing.NDArray">NDArray</span>, <span title="numpy.typing.NDArray">NDArray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional drawing (overlay) to apply within the masked region.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>only_contours</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, draw only the contours of the shape. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dilate_mask</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of iterations for dilating the mask. Default is 0.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The modified image with the applied mask and drawing.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>This function assumes that the input image is in BGR format (OpenCV style).</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">dim</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">draw_img_with_mask</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">),</span> <span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">result</span> <span class="o">==</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">441</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2100">2100</a></span>
<span class="normal"><a href="#__codelineno-0-2101">2101</a></span>
<span class="normal"><a href="#__codelineno-0-2102">2102</a></span>
<span class="normal"><a href="#__codelineno-0-2103">2103</a></span>
<span class="normal"><a href="#__codelineno-0-2104">2104</a></span>
<span class="normal"><a href="#__codelineno-0-2105">2105</a></span>
<span class="normal"><a href="#__codelineno-0-2106">2106</a></span>
<span class="normal"><a href="#__codelineno-0-2107">2107</a></span>
<span class="normal"><a href="#__codelineno-0-2108">2108</a></span>
<span class="normal"><a href="#__codelineno-0-2109">2109</a></span>
<span class="normal"><a href="#__codelineno-0-2110">2110</a></span>
<span class="normal"><a href="#__codelineno-0-2111">2111</a></span>
<span class="normal"><a href="#__codelineno-0-2112">2112</a></span>
<span class="normal"><a href="#__codelineno-0-2113">2113</a></span>
<span class="normal"><a href="#__codelineno-0-2114">2114</a></span>
<span class="normal"><a href="#__codelineno-0-2115">2115</a></span>
<span class="normal"><a href="#__codelineno-0-2116">2116</a></span>
<span class="normal"><a href="#__codelineno-0-2117">2117</a></span>
<span class="normal"><a href="#__codelineno-0-2118">2118</a></span>
<span class="normal"><a href="#__codelineno-0-2119">2119</a></span>
<span class="normal"><a href="#__codelineno-0-2120">2120</a></span>
<span class="normal"><a href="#__codelineno-0-2121">2121</a></span>
<span class="normal"><a href="#__codelineno-0-2122">2122</a></span>
<span class="normal"><a href="#__codelineno-0-2123">2123</a></span>
<span class="normal"><a href="#__codelineno-0-2124">2124</a></span>
<span class="normal"><a href="#__codelineno-0-2125">2125</a></span>
<span class="normal"><a href="#__codelineno-0-2126">2126</a></span>
<span class="normal"><a href="#__codelineno-0-2127">2127</a></span>
<span class="normal"><a href="#__codelineno-0-2128">2128</a></span>
<span class="normal"><a href="#__codelineno-0-2129">2129</a></span>
<span class="normal"><a href="#__codelineno-0-2130">2130</a></span>
<span class="normal"><a href="#__codelineno-0-2131">2131</a></span>
<span class="normal"><a href="#__codelineno-0-2132">2132</a></span>
<span class="normal"><a href="#__codelineno-0-2133">2133</a></span>
<span class="normal"><a href="#__codelineno-0-2134">2134</a></span>
<span class="normal"><a href="#__codelineno-0-2135">2135</a></span>
<span class="normal"><a href="#__codelineno-0-2136">2136</a></span>
<span class="normal"><a href="#__codelineno-0-2137">2137</a></span>
<span class="normal"><a href="#__codelineno-0-2138">2138</a></span>
<span class="normal"><a href="#__codelineno-0-2139">2139</a></span>
<span class="normal"><a href="#__codelineno-0-2140">2140</a></span>
<span class="normal"><a href="#__codelineno-0-2141">2141</a></span>
<span class="normal"><a href="#__codelineno-0-2142">2142</a></span>
<span class="normal"><a href="#__codelineno-0-2143">2143</a></span>
<span class="normal"><a href="#__codelineno-0-2144">2144</a></span>
<span class="normal"><a href="#__codelineno-0-2145">2145</a></span>
<span class="normal"><a href="#__codelineno-0-2146">2146</a></span>
<span class="normal"><a href="#__codelineno-0-2147">2147</a></span>
<span class="normal"><a href="#__codelineno-0-2148">2148</a></span>
<span class="normal"><a href="#__codelineno-0-2149">2149</a></span>
<span class="normal"><a href="#__codelineno-0-2150">2150</a></span>
<span class="normal"><a href="#__codelineno-0-2151">2151</a></span>
<span class="normal"><a href="#__codelineno-0-2152">2152</a></span>
<span class="normal"><a href="#__codelineno-0-2153">2153</a></span>
<span class="normal"><a href="#__codelineno-0-2154">2154</a></span>
<span class="normal"><a href="#__codelineno-0-2155">2155</a></span>
<span class="normal"><a href="#__codelineno-0-2156">2156</a></span>
<span class="normal"><a href="#__codelineno-0-2157">2157</a></span>
<span class="normal"><a href="#__codelineno-0-2158">2158</a></span>
<span class="normal"><a href="#__codelineno-0-2159">2159</a></span>
<span class="normal"><a href="#__codelineno-0-2160">2160</a></span>
<span class="normal"><a href="#__codelineno-0-2161">2161</a></span>
<span class="normal"><a href="#__codelineno-0-2162">2162</a></span>
<span class="normal"><a href="#__codelineno-0-2163">2163</a></span>
<span class="normal"><a href="#__codelineno-0-2164">2164</a></span>
<span class="normal"><a href="#__codelineno-0-2165">2165</a></span>
<span class="normal"><a href="#__codelineno-0-2166">2166</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2100" name="__codelineno-0-2100"></a><span class="k">def</span><span class="w"> </span><span class="nf">draw_img_with_mask</span><span class="p">(</span><span class="n">img</span><span class="p">:</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">dims</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">minmax</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">shape</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">drawing</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">only_contours</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2101" name="__codelineno-0-2101"></a>                       <span class="n">dilate_mask</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<a id="__codelineno-0-2102" name="__codelineno-0-2102"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2103" name="__codelineno-0-2103"></a>
<a id="__codelineno-0-2104" name="__codelineno-0-2104"></a><span class="sd">    Draw an image with a mask and optional contours.</span>
<a id="__codelineno-0-2105" name="__codelineno-0-2105"></a>
<a id="__codelineno-0-2106" name="__codelineno-0-2106"></a><span class="sd">    Draws a subregion of the input image using a specified shape (circle or rectangle),</span>
<a id="__codelineno-0-2107" name="__codelineno-0-2107"></a><span class="sd">    which can be dilated. The mask can be limited to contours only, and an optional</span>
<a id="__codelineno-0-2108" name="__codelineno-0-2108"></a><span class="sd">    drawing (overlay) can be applied within the masked region.</span>
<a id="__codelineno-0-2109" name="__codelineno-0-2109"></a>
<a id="__codelineno-0-2110" name="__codelineno-0-2110"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-2111" name="__codelineno-0-2111"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-2112" name="__codelineno-0-2112"></a><span class="sd">    img : NDArray</span>
<a id="__codelineno-0-2113" name="__codelineno-0-2113"></a><span class="sd">        The input image to draw on.</span>
<a id="__codelineno-0-2114" name="__codelineno-0-2114"></a><span class="sd">    dims : Tuple[int, int]</span>
<a id="__codelineno-0-2115" name="__codelineno-0-2115"></a><span class="sd">        Dimensions of the subregion (width, height).</span>
<a id="__codelineno-0-2116" name="__codelineno-0-2116"></a><span class="sd">    minmax : Tuple[int, int, int, int]</span>
<a id="__codelineno-0-2117" name="__codelineno-0-2117"></a><span class="sd">        Coordinates of the subregion (x_start, x_end, y_start, y_end).</span>
<a id="__codelineno-0-2118" name="__codelineno-0-2118"></a><span class="sd">    shape : str</span>
<a id="__codelineno-0-2119" name="__codelineno-0-2119"></a><span class="sd">        Shape of the mask to draw (&#39;circle&#39; or &#39;rectangle&#39;).</span>
<a id="__codelineno-0-2120" name="__codelineno-0-2120"></a><span class="sd">    drawing : Tuple[NDArray, NDArray, NDArray]</span>
<a id="__codelineno-0-2121" name="__codelineno-0-2121"></a><span class="sd">        Optional drawing (overlay) to apply within the masked region.</span>
<a id="__codelineno-0-2122" name="__codelineno-0-2122"></a><span class="sd">    only_contours : bool, optional</span>
<a id="__codelineno-0-2123" name="__codelineno-0-2123"></a><span class="sd">        If True, draw only the contours of the shape. Default is False.</span>
<a id="__codelineno-0-2124" name="__codelineno-0-2124"></a><span class="sd">    dilate_mask : int, optional</span>
<a id="__codelineno-0-2125" name="__codelineno-0-2125"></a><span class="sd">        Number of iterations for dilating the mask. Default is 0.</span>
<a id="__codelineno-0-2126" name="__codelineno-0-2126"></a>
<a id="__codelineno-0-2127" name="__codelineno-0-2127"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-2128" name="__codelineno-0-2128"></a><span class="sd">    -------</span>
<a id="__codelineno-0-2129" name="__codelineno-0-2129"></a><span class="sd">    NDArray</span>
<a id="__codelineno-0-2130" name="__codelineno-0-2130"></a><span class="sd">        The modified image with the applied mask and drawing.</span>
<a id="__codelineno-0-2131" name="__codelineno-0-2131"></a>
<a id="__codelineno-0-2132" name="__codelineno-0-2132"></a><span class="sd">    Notes</span>
<a id="__codelineno-0-2133" name="__codelineno-0-2133"></a><span class="sd">    -----</span>
<a id="__codelineno-0-2134" name="__codelineno-0-2134"></a><span class="sd">    This function assumes that the input image is in BGR format (OpenCV style).</span>
<a id="__codelineno-0-2135" name="__codelineno-0-2135"></a>
<a id="__codelineno-0-2136" name="__codelineno-0-2136"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-2137" name="__codelineno-0-2137"></a><span class="sd">    --------</span>
<a id="__codelineno-0-2138" name="__codelineno-0-2138"></a><span class="sd">    &gt;&gt;&gt; dim = (100, 100, 3)</span>
<a id="__codelineno-0-2139" name="__codelineno-0-2139"></a><span class="sd">    &gt;&gt;&gt; img = np.zeros(dim)</span>
<a id="__codelineno-0-2140" name="__codelineno-0-2140"></a><span class="sd">    &gt;&gt;&gt; result = draw_img_with_mask(img, dim, (50, 75, 50, 75), &#39;circle&#39;, (0, 255, 0))</span>
<a id="__codelineno-0-2141" name="__codelineno-0-2141"></a><span class="sd">    &gt;&gt;&gt; print((result == 255).sum())</span>
<a id="__codelineno-0-2142" name="__codelineno-0-2142"></a><span class="sd">    441</span>
<a id="__codelineno-0-2143" name="__codelineno-0-2143"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2144" name="__codelineno-0-2144"></a>    <span class="k">if</span> <span class="n">shape</span> <span class="o">==</span> <span class="s1">&#39;circle&#39;</span><span class="p">:</span>
<a id="__codelineno-0-2145" name="__codelineno-0-2145"></a>        <span class="n">mask</span> <span class="o">=</span> <span class="n">create_ellipse</span><span class="p">(</span><span class="n">minmax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">minmax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">minmax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">minmax</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-2146" name="__codelineno-0-2146"></a>        <span class="k">if</span> <span class="n">only_contours</span><span class="p">:</span>
<a id="__codelineno-0-2147" name="__codelineno-0-2147"></a>            <span class="n">mask</span> <span class="o">=</span> <span class="n">get_contours</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
<a id="__codelineno-0-2148" name="__codelineno-0-2148"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2149" name="__codelineno-0-2149"></a>        <span class="k">if</span> <span class="n">only_contours</span><span class="p">:</span>
<a id="__codelineno-0-2150" name="__codelineno-0-2150"></a>            <span class="n">mask</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">image_borders</span><span class="p">((</span><span class="n">minmax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">minmax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">minmax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">minmax</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
<a id="__codelineno-0-2151" name="__codelineno-0-2151"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2152" name="__codelineno-0-2152"></a>            <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">minmax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">minmax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">minmax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">minmax</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-2153" name="__codelineno-0-2153"></a>    <span class="k">if</span> <span class="n">dilate_mask</span><span class="p">:</span>
<a id="__codelineno-0-2154" name="__codelineno-0-2154"></a>        <span class="n">mask</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dilate</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="n">cross_33</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="n">dilate_mask</span><span class="p">)</span>
<a id="__codelineno-0-2155" name="__codelineno-0-2155"></a>    <span class="n">anti_mask</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">mask</span>
<a id="__codelineno-0-2156" name="__codelineno-0-2156"></a>    <span class="n">img</span><span class="p">[</span><span class="n">minmax</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">minmax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">minmax</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span><span class="n">minmax</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*=</span> <span class="n">anti_mask</span>
<a id="__codelineno-0-2157" name="__codelineno-0-2157"></a>    <span class="n">img</span><span class="p">[</span><span class="n">minmax</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">minmax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">minmax</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span><span class="n">minmax</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*=</span> <span class="n">anti_mask</span>
<a id="__codelineno-0-2158" name="__codelineno-0-2158"></a>    <span class="n">img</span><span class="p">[</span><span class="n">minmax</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">minmax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">minmax</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span><span class="n">minmax</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">]</span> <span class="o">*=</span> <span class="n">anti_mask</span>
<a id="__codelineno-0-2159" name="__codelineno-0-2159"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">drawing</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<a id="__codelineno-0-2160" name="__codelineno-0-2160"></a>        <span class="k">if</span> <span class="n">drawing</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">:</span>
<a id="__codelineno-0-2161" name="__codelineno-0-2161"></a>            <span class="n">drawing</span> <span class="o">=</span> <span class="n">bracket_to_uint8_image_contrast</span><span class="p">(</span><span class="n">drawing</span><span class="p">)</span>
<a id="__codelineno-0-2162" name="__codelineno-0-2162"></a>        <span class="n">drawing</span> <span class="o">=</span> <span class="p">[</span><span class="n">drawing</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">drawing</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">drawing</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]]</span>
<a id="__codelineno-0-2163" name="__codelineno-0-2163"></a>    <span class="n">img</span><span class="p">[</span><span class="n">minmax</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">minmax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">minmax</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span><span class="n">minmax</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">mask</span> <span class="o">*</span> <span class="n">drawing</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-2164" name="__codelineno-0-2164"></a>    <span class="n">img</span><span class="p">[</span><span class="n">minmax</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">minmax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">minmax</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span><span class="n">minmax</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">mask</span> <span class="o">*</span> <span class="n">drawing</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-2165" name="__codelineno-0-2165"></a>    <span class="n">img</span><span class="p">[</span><span class="n">minmax</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">minmax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">minmax</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span><span class="n">minmax</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">mask</span> <span class="o">*</span> <span class="n">drawing</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-2166" name="__codelineno-0-2166"></a>    <span class="k">return</span> <span class="n">img</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellects.image_analysis.morphological_operations.draw_me_a_sun" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">draw_me_a_sun</span><span class="p">(</span><span class="n">main_shape</span><span class="p">,</span> <span class="n">ray_length_coef</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Draw a sun-shaped pattern on an image based on the main shape and ray length coefficient.</p>
<p>This function takes an input binary image (main_shape) and draws sun rays
from the perimeter of that shape. The length of the rays is controlled by a coefficient.
The function ensures that rays do not extend beyond the image borders.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>main_shape</code>
            </td>
            <td>
                  <code>ndarray of bool or int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Binary input image where the main shape is defined.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ray_length_coef</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Coefficient to control the length of sun rays. Defaults to 2.</p>
              </div>
            </td>
            <td>
                  <code>4</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>rays</code></td>            <td>
                  <code><span title="ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Indices of the rays drawn.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>sun</code></td>            <td>
                  <code><span title="ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Image with sun rays drawn on it.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">main_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">main_shape</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">rays</span><span class="p">,</span> <span class="n">sun</span> <span class="o">=</span> <span class="n">draw_me_a_sun</span><span class="p">(</span><span class="n">main_shape</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sun</span><span class="p">)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-749" name="__codelineno-0-749"></a><span class="k">def</span><span class="w"> </span><span class="nf">draw_me_a_sun</span><span class="p">(</span><span class="n">main_shape</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">ray_length_coef</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">]:</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a><span class="sd">    Draw a sun-shaped pattern on an image based on the main shape and ray length coefficient.</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a><span class="sd">    This function takes an input binary image (main_shape) and draws sun rays</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a><span class="sd">    from the perimeter of that shape. The length of the rays is controlled by a coefficient.</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a><span class="sd">    The function ensures that rays do not extend beyond the image borders.</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a><span class="sd">    main_shape : ndarray of bool or int</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a><span class="sd">        Binary input image where the main shape is defined.</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a><span class="sd">    ray_length_coef : float, optional</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a><span class="sd">        Coefficient to control the length of sun rays. Defaults to 2.</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a><span class="sd">    -------</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a><span class="sd">    rays : ndarray</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a><span class="sd">        Indices of the rays drawn.</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a><span class="sd">    sun : ndarray</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a><span class="sd">        Image with sun rays drawn on it.</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a><span class="sd">    --------</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a><span class="sd">    &gt;&gt;&gt; main_shape = np.zeros((10, 10), dtype=np.uint8)</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a><span class="sd">    &gt;&gt;&gt; main_shape[4:7, 3:6] = 1</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a><span class="sd">    &gt;&gt;&gt; rays, sun = draw_me_a_sun(main_shape)</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a><span class="sd">    &gt;&gt;&gt; print(sun)</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>    <span class="n">nb</span><span class="p">,</span> <span class="n">shapes</span><span class="p">,</span> <span class="n">stats</span><span class="p">,</span> <span class="n">center</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">connectedComponentsWithStats</span><span class="p">(</span><span class="n">main_shape</span><span class="p">)</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>    <span class="n">sun</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">main_shape</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">)</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>    <span class="n">rays</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>    <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nb</span><span class="p">):</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>        <span class="n">shape_i</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dilate</span><span class="p">((</span><span class="n">shapes</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">),</span> <span class="n">kernel</span><span class="o">=</span><span class="n">cross_33</span><span class="p">)</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>        <span class="c1"># shape_i = (shapes == i).astype(np.uint8)</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>        <span class="n">contours</span> <span class="o">=</span> <span class="n">get_contours</span><span class="p">(</span><span class="n">shape_i</span><span class="p">)</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>        <span class="n">first_ring_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">contours</span><span class="p">)</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>        <span class="n">centroid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">((</span><span class="n">center</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">center</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>        <span class="n">second_ring_y</span> <span class="o">=</span> <span class="n">centroid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">((</span><span class="n">first_ring_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroid</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">ray_length_coef</span><span class="p">)</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>        <span class="n">second_ring_x</span> <span class="o">=</span> <span class="n">centroid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">((</span><span class="n">first_ring_idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroid</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">ray_length_coef</span><span class="p">)</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a>        <span class="n">second_ring_y</span><span class="p">[</span><span class="n">second_ring_y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a>        <span class="n">second_ring_x</span><span class="p">[</span><span class="n">second_ring_x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a>        <span class="n">second_ring_y</span><span class="p">[</span><span class="n">second_ring_y</span> <span class="o">&gt;</span> <span class="n">main_shape</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">main_shape</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>        <span class="n">second_ring_x</span><span class="p">[</span><span class="n">second_ring_x</span> <span class="o">&gt;</span> <span class="n">main_shape</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">main_shape</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">second_ring_y</span><span class="p">)):</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>            <span class="n">r</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a>            <span class="n">fy</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">sx</span> <span class="o">=</span> <span class="n">first_ring_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">first_ring_idx</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">second_ring_y</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">second_ring_x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>            <span class="n">line</span> <span class="o">=</span> <span class="n">get_line_points</span><span class="p">((</span><span class="n">fy</span><span class="p">,</span> <span class="n">fx</span><span class="p">),</span> <span class="p">(</span><span class="n">sy</span><span class="p">,</span> <span class="n">sx</span><span class="p">))</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>            <span class="n">sun</span><span class="p">[</span><span class="n">line</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">line</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">r</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>            <span class="n">rays</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rays</span><span class="p">),</span> <span class="n">sun</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellects.image_analysis.morphological_operations.dynamically_expand_to_fill_holes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dynamically_expand_to_fill_holes</span><span class="p">(</span><span class="n">binary_video</span><span class="p">,</span> <span class="n">holes</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Fill the holes in a binary video by progressively expanding the shape made of ones.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>binary_video</code>
            </td>
            <td>
                  <code>ndarray of uint8</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The binary video where holes need to be filled.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>holes</code>
            </td>
            <td>
                  <code>ndarray of uint8</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array representing the holes in the binary video.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>out</code></td>            <td>
                  <code>tuple of ndarray of uint8, int, and ndarray of float32</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The modified binary video with filled holes,
the end time when all holes are filled, and
an array of distances against time used to fill the holes.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">binary_video</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="mi">480</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">binary_video</span><span class="p">[:,</span> <span class="mi">300</span><span class="p">:</span><span class="mi">400</span><span class="p">,</span> <span class="mi">220</span><span class="p">:</span><span class="mi">240</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">holes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">640</span><span class="p">,</span> <span class="mi">480</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">holes</span><span class="p">[</span><span class="mi">340</span><span class="p">:</span><span class="mi">360</span><span class="p">,</span> <span class="mi">228</span><span class="p">:</span><span class="mi">232</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">filled_video</span><span class="p">,</span> <span class="n">end_time</span><span class="p">,</span> <span class="n">distances</span> <span class="o">=</span> <span class="n">dynamically_expand_to_fill_holes</span><span class="p">(</span><span class="n">binary_video</span><span class="p">,</span> <span class="n">holes</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">filled_video</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># Should print (10, 640, 480)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go">(10, 640, 480)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1399">1399</a></span>
<span class="normal"><a href="#__codelineno-0-1400">1400</a></span>
<span class="normal"><a href="#__codelineno-0-1401">1401</a></span>
<span class="normal"><a href="#__codelineno-0-1402">1402</a></span>
<span class="normal"><a href="#__codelineno-0-1403">1403</a></span>
<span class="normal"><a href="#__codelineno-0-1404">1404</a></span>
<span class="normal"><a href="#__codelineno-0-1405">1405</a></span>
<span class="normal"><a href="#__codelineno-0-1406">1406</a></span>
<span class="normal"><a href="#__codelineno-0-1407">1407</a></span>
<span class="normal"><a href="#__codelineno-0-1408">1408</a></span>
<span class="normal"><a href="#__codelineno-0-1409">1409</a></span>
<span class="normal"><a href="#__codelineno-0-1410">1410</a></span>
<span class="normal"><a href="#__codelineno-0-1411">1411</a></span>
<span class="normal"><a href="#__codelineno-0-1412">1412</a></span>
<span class="normal"><a href="#__codelineno-0-1413">1413</a></span>
<span class="normal"><a href="#__codelineno-0-1414">1414</a></span>
<span class="normal"><a href="#__codelineno-0-1415">1415</a></span>
<span class="normal"><a href="#__codelineno-0-1416">1416</a></span>
<span class="normal"><a href="#__codelineno-0-1417">1417</a></span>
<span class="normal"><a href="#__codelineno-0-1418">1418</a></span>
<span class="normal"><a href="#__codelineno-0-1419">1419</a></span>
<span class="normal"><a href="#__codelineno-0-1420">1420</a></span>
<span class="normal"><a href="#__codelineno-0-1421">1421</a></span>
<span class="normal"><a href="#__codelineno-0-1422">1422</a></span>
<span class="normal"><a href="#__codelineno-0-1423">1423</a></span>
<span class="normal"><a href="#__codelineno-0-1424">1424</a></span>
<span class="normal"><a href="#__codelineno-0-1425">1425</a></span>
<span class="normal"><a href="#__codelineno-0-1426">1426</a></span>
<span class="normal"><a href="#__codelineno-0-1427">1427</a></span>
<span class="normal"><a href="#__codelineno-0-1428">1428</a></span>
<span class="normal"><a href="#__codelineno-0-1429">1429</a></span>
<span class="normal"><a href="#__codelineno-0-1430">1430</a></span>
<span class="normal"><a href="#__codelineno-0-1431">1431</a></span>
<span class="normal"><a href="#__codelineno-0-1432">1432</a></span>
<span class="normal"><a href="#__codelineno-0-1433">1433</a></span>
<span class="normal"><a href="#__codelineno-0-1434">1434</a></span>
<span class="normal"><a href="#__codelineno-0-1435">1435</a></span>
<span class="normal"><a href="#__codelineno-0-1436">1436</a></span>
<span class="normal"><a href="#__codelineno-0-1437">1437</a></span>
<span class="normal"><a href="#__codelineno-0-1438">1438</a></span>
<span class="normal"><a href="#__codelineno-0-1439">1439</a></span>
<span class="normal"><a href="#__codelineno-0-1440">1440</a></span>
<span class="normal"><a href="#__codelineno-0-1441">1441</a></span>
<span class="normal"><a href="#__codelineno-0-1442">1442</a></span>
<span class="normal"><a href="#__codelineno-0-1443">1443</a></span>
<span class="normal"><a href="#__codelineno-0-1444">1444</a></span>
<span class="normal"><a href="#__codelineno-0-1445">1445</a></span>
<span class="normal"><a href="#__codelineno-0-1446">1446</a></span>
<span class="normal"><a href="#__codelineno-0-1447">1447</a></span>
<span class="normal"><a href="#__codelineno-0-1448">1448</a></span>
<span class="normal"><a href="#__codelineno-0-1449">1449</a></span>
<span class="normal"><a href="#__codelineno-0-1450">1450</a></span>
<span class="normal"><a href="#__codelineno-0-1451">1451</a></span>
<span class="normal"><a href="#__codelineno-0-1452">1452</a></span>
<span class="normal"><a href="#__codelineno-0-1453">1453</a></span>
<span class="normal"><a href="#__codelineno-0-1454">1454</a></span>
<span class="normal"><a href="#__codelineno-0-1455">1455</a></span>
<span class="normal"><a href="#__codelineno-0-1456">1456</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1399" name="__codelineno-0-1399"></a><span class="k">def</span><span class="w"> </span><span class="nf">dynamically_expand_to_fill_holes</span><span class="p">(</span><span class="n">binary_video</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">],</span> <span class="n">holes</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">],</span> <span class="nb">int</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">]]:</span>
<a id="__codelineno-0-1400" name="__codelineno-0-1400"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1401" name="__codelineno-0-1401"></a><span class="sd">    Fill the holes in a binary video by progressively expanding the shape made of ones.</span>
<a id="__codelineno-0-1402" name="__codelineno-0-1402"></a>
<a id="__codelineno-0-1403" name="__codelineno-0-1403"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-1404" name="__codelineno-0-1404"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-1405" name="__codelineno-0-1405"></a><span class="sd">    binary_video : ndarray of uint8</span>
<a id="__codelineno-0-1406" name="__codelineno-0-1406"></a><span class="sd">        The binary video where holes need to be filled.</span>
<a id="__codelineno-0-1407" name="__codelineno-0-1407"></a><span class="sd">    holes : ndarray of uint8</span>
<a id="__codelineno-0-1408" name="__codelineno-0-1408"></a><span class="sd">        Array representing the holes in the binary video.</span>
<a id="__codelineno-0-1409" name="__codelineno-0-1409"></a>
<a id="__codelineno-0-1410" name="__codelineno-0-1410"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-1411" name="__codelineno-0-1411"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1412" name="__codelineno-0-1412"></a><span class="sd">    out : tuple of ndarray of uint8, int, and ndarray of float32</span>
<a id="__codelineno-0-1413" name="__codelineno-0-1413"></a><span class="sd">        The modified binary video with filled holes,</span>
<a id="__codelineno-0-1414" name="__codelineno-0-1414"></a><span class="sd">        the end time when all holes are filled, and</span>
<a id="__codelineno-0-1415" name="__codelineno-0-1415"></a><span class="sd">        an array of distances against time used to fill the holes.</span>
<a id="__codelineno-0-1416" name="__codelineno-0-1416"></a>
<a id="__codelineno-0-1417" name="__codelineno-0-1417"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-1418" name="__codelineno-0-1418"></a><span class="sd">    --------</span>
<a id="__codelineno-0-1419" name="__codelineno-0-1419"></a><span class="sd">    &gt;&gt;&gt; binary_video = np.zeros((10, 640, 480), dtype=np.uint8)</span>
<a id="__codelineno-0-1420" name="__codelineno-0-1420"></a><span class="sd">    &gt;&gt;&gt; binary_video[:, 300:400, 220:240] = 1</span>
<a id="__codelineno-0-1421" name="__codelineno-0-1421"></a><span class="sd">    &gt;&gt;&gt; holes = np.zeros((640, 480), dtype=np.uint8)</span>
<a id="__codelineno-0-1422" name="__codelineno-0-1422"></a><span class="sd">    &gt;&gt;&gt; holes[340:360, 228:232] = 1</span>
<a id="__codelineno-0-1423" name="__codelineno-0-1423"></a><span class="sd">    &gt;&gt;&gt; filled_video, end_time, distances = dynamically_expand_to_fill_holes(binary_video, holes)</span>
<a id="__codelineno-0-1424" name="__codelineno-0-1424"></a><span class="sd">    &gt;&gt;&gt; print(filled_video.shape)  # Should print (10, 640, 480)</span>
<a id="__codelineno-0-1425" name="__codelineno-0-1425"></a><span class="sd">    (10, 640, 480)</span>
<a id="__codelineno-0-1426" name="__codelineno-0-1426"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1427" name="__codelineno-0-1427"></a>    <span class="c1">#first move should be the time at wich the first pixel hole could have been covered</span>
<a id="__codelineno-0-1428" name="__codelineno-0-1428"></a>    <span class="c1">#it should ask how much time the shape made to cross a distance long enough to overlap all holes</span>
<a id="__codelineno-0-1429" name="__codelineno-0-1429"></a>    <span class="n">holes_contours</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dilate</span><span class="p">(</span><span class="n">holes</span><span class="p">,</span> <span class="n">cross_33</span><span class="p">,</span> <span class="n">borderType</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">BORDER_CONSTANT</span><span class="p">,</span> <span class="n">borderValue</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-1430" name="__codelineno-0-1430"></a>    <span class="n">field</span> <span class="o">=</span> <span class="n">rounded_inverted_distance_transform</span><span class="p">(</span><span class="n">binary_video</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="p">(</span><span class="n">binary_video</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-1431" name="__codelineno-0-1431"></a>    <span class="n">field2</span> <span class="o">=</span> <span class="n">inverted_distance_transform</span><span class="p">(</span><span class="n">binary_video</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="p">(</span><span class="n">binary_video</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-1432" name="__codelineno-0-1432"></a>    <span class="n">holes_contours</span> <span class="o">=</span> <span class="n">holes_contours</span> <span class="o">*</span> <span class="n">field</span> <span class="o">*</span> <span class="n">binary_video</span><span class="p">[</span><span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
<a id="__codelineno-0-1433" name="__codelineno-0-1433"></a>    <span class="n">holes</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">holes</span><span class="p">)]</span> <span class="o">=</span> <span class="n">field</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">holes</span><span class="p">)]</span>
<a id="__codelineno-0-1434" name="__codelineno-0-1434"></a>    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">holes_contours</span><span class="p">):</span>
<a id="__codelineno-0-1435" name="__codelineno-0-1435"></a>        <span class="c1"># Find the relationship between distance and time</span>
<a id="__codelineno-0-1436" name="__codelineno-0-1436"></a>        <span class="n">distance_against_time</span><span class="p">,</span> <span class="n">holes_time_start</span><span class="p">,</span> <span class="n">holes_time_end</span> <span class="o">=</span> <span class="n">get_radius_distance_against_time</span><span class="p">(</span><span class="n">binary_video</span><span class="p">,</span> <span class="n">holes_contours</span><span class="p">)</span>
<a id="__codelineno-0-1437" name="__codelineno-0-1437"></a>        <span class="c1"># Use that vector to progressively fill holes at the same speed as shape grows</span>
<a id="__codelineno-0-1438" name="__codelineno-0-1438"></a>        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">distance_against_time</span><span class="p">)):</span>
<a id="__codelineno-0-1439" name="__codelineno-0-1439"></a>            <span class="n">new_order</span><span class="p">,</span> <span class="n">stats</span><span class="p">,</span> <span class="n">centers</span> <span class="o">=</span> <span class="n">cc</span><span class="p">((</span><span class="n">holes</span> <span class="o">&gt;=</span> <span class="n">distance_against_time</span><span class="p">[</span><span class="n">t</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">))</span>
<a id="__codelineno-0-1440" name="__codelineno-0-1440"></a>            <span class="k">for</span> <span class="n">comp_i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">stats</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
<a id="__codelineno-0-1441" name="__codelineno-0-1441"></a>                <span class="n">past_image</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">binary_video</span><span class="p">[</span><span class="n">holes_time_start</span> <span class="o">+</span> <span class="n">t</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:])</span>
<a id="__codelineno-0-1442" name="__codelineno-0-1442"></a>                <span class="n">with_new_comp</span> <span class="o">=</span> <span class="n">new_order</span> <span class="o">==</span> <span class="n">comp_i</span>
<a id="__codelineno-0-1443" name="__codelineno-0-1443"></a>                <span class="n">past_image</span><span class="p">[</span><span class="n">with_new_comp</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-1444" name="__codelineno-0-1444"></a>                <span class="n">nb_comp</span><span class="p">,</span> <span class="n">image_garbage</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">connectedComponents</span><span class="p">(</span><span class="n">past_image</span><span class="p">)</span>
<a id="__codelineno-0-1445" name="__codelineno-0-1445"></a>                <span class="k">if</span> <span class="n">nb_comp</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-1446" name="__codelineno-0-1446"></a>                    <span class="n">binary_video</span><span class="p">[</span><span class="n">holes_time_start</span> <span class="o">+</span> <span class="n">t</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:][</span><span class="n">with_new_comp</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-1447" name="__codelineno-0-1447"></a>        <span class="c1"># Make sure that holes remain filled from holes_time_end to the end of the video</span>
<a id="__codelineno-0-1448" name="__codelineno-0-1448"></a>        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">((</span><span class="n">holes_time_end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">binary_video</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
<a id="__codelineno-0-1449" name="__codelineno-0-1449"></a>            <span class="n">past_image</span> <span class="o">=</span> <span class="n">binary_video</span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
<a id="__codelineno-0-1450" name="__codelineno-0-1450"></a>            <span class="n">past_image</span><span class="p">[</span><span class="n">holes</span> <span class="o">&gt;=</span> <span class="n">distance_against_time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-1451" name="__codelineno-0-1451"></a>            <span class="n">binary_video</span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">past_image</span>
<a id="__codelineno-0-1452" name="__codelineno-0-1452"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1453" name="__codelineno-0-1453"></a>        <span class="n">holes_time_end</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1454" name="__codelineno-0-1454"></a>        <span class="n">distance_against_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<a id="__codelineno-0-1455" name="__codelineno-0-1455"></a>
<a id="__codelineno-0-1456" name="__codelineno-0-1456"></a>    <span class="k">return</span> <span class="n">binary_video</span><span class="p">,</span> <span class="n">holes_time_end</span><span class="p">,</span> <span class="n">distance_against_time</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellects.image_analysis.morphological_operations.expand_until_neighbor_center_gets_nearer_than_own" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">expand_until_neighbor_center_gets_nearer_than_own</span><span class="p">(</span><span class="n">shape_to_expand</span><span class="p">,</span> <span class="n">without_shape_i</span><span class="p">,</span> <span class="n">shape_original_centroid</span><span class="p">,</span> <span class="n">ref_centroids</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Expand a shape until its neighbor's centroid is closer than its own.</p>
<p>This function takes in several numpy arrays representing shapes and their
centroids, and expands the input shape until the distance to the nearest
neighboring centroid is less than or equal to the distance between the shape's
contour and its own centroid.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>shape_to_expand</code>
            </td>
            <td>
                  <code>ndarray of uint8</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The binary shape to be expanded.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>without_shape_i</code>
            </td>
            <td>
                  <code>ndarray of uint8</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A binary array representing the area without the shape.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shape_original_centroid</code>
            </td>
            <td>
                  <code><span title="ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The centroid of the original shape.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ref_centroids</code>
            </td>
            <td>
                  <code><span title="ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Reference centroids to compare distances with.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kernel</code>
            </td>
            <td>
                  <code><span title="ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The kernel for dilation operation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ndarray of uint8</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The expanded shape.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span>
<span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1188" name="__codelineno-0-1188"></a><span class="k">def</span><span class="w"> </span><span class="nf">expand_until_neighbor_center_gets_nearer_than_own</span><span class="p">(</span><span class="n">shape_to_expand</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">],</span> <span class="n">without_shape_i</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">],</span>
<a id="__codelineno-0-1189" name="__codelineno-0-1189"></a>                                                      <span class="n">shape_original_centroid</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-1190" name="__codelineno-0-1190"></a>                                                      <span class="n">ref_centroids</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">kernel</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">]:</span>
<a id="__codelineno-0-1191" name="__codelineno-0-1191"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1192" name="__codelineno-0-1192"></a><span class="sd">    Expand a shape until its neighbor&#39;s centroid is closer than its own.</span>
<a id="__codelineno-0-1193" name="__codelineno-0-1193"></a>
<a id="__codelineno-0-1194" name="__codelineno-0-1194"></a><span class="sd">    This function takes in several numpy arrays representing shapes and their</span>
<a id="__codelineno-0-1195" name="__codelineno-0-1195"></a><span class="sd">    centroids, and expands the input shape until the distance to the nearest</span>
<a id="__codelineno-0-1196" name="__codelineno-0-1196"></a><span class="sd">    neighboring centroid is less than or equal to the distance between the shape&#39;s</span>
<a id="__codelineno-0-1197" name="__codelineno-0-1197"></a><span class="sd">    contour and its own centroid.</span>
<a id="__codelineno-0-1198" name="__codelineno-0-1198"></a>
<a id="__codelineno-0-1199" name="__codelineno-0-1199"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-1200" name="__codelineno-0-1200"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-1201" name="__codelineno-0-1201"></a><span class="sd">    shape_to_expand : ndarray of uint8</span>
<a id="__codelineno-0-1202" name="__codelineno-0-1202"></a><span class="sd">        The binary shape to be expanded.</span>
<a id="__codelineno-0-1203" name="__codelineno-0-1203"></a><span class="sd">    without_shape_i : ndarray of uint8</span>
<a id="__codelineno-0-1204" name="__codelineno-0-1204"></a><span class="sd">        A binary array representing the area without the shape.</span>
<a id="__codelineno-0-1205" name="__codelineno-0-1205"></a><span class="sd">    shape_original_centroid : ndarray</span>
<a id="__codelineno-0-1206" name="__codelineno-0-1206"></a><span class="sd">        The centroid of the original shape.</span>
<a id="__codelineno-0-1207" name="__codelineno-0-1207"></a><span class="sd">    ref_centroids : ndarray</span>
<a id="__codelineno-0-1208" name="__codelineno-0-1208"></a><span class="sd">        Reference centroids to compare distances with.</span>
<a id="__codelineno-0-1209" name="__codelineno-0-1209"></a><span class="sd">    kernel : ndarray</span>
<a id="__codelineno-0-1210" name="__codelineno-0-1210"></a><span class="sd">        The kernel for dilation operation.</span>
<a id="__codelineno-0-1211" name="__codelineno-0-1211"></a>
<a id="__codelineno-0-1212" name="__codelineno-0-1212"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-1213" name="__codelineno-0-1213"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1214" name="__codelineno-0-1214"></a><span class="sd">    ndarray of uint8</span>
<a id="__codelineno-0-1215" name="__codelineno-0-1215"></a><span class="sd">        The expanded shape.</span>
<a id="__codelineno-0-1216" name="__codelineno-0-1216"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1217" name="__codelineno-0-1217"></a>    <span class="c1"># shape_to_expand=test_shape</span>
<a id="__codelineno-0-1218" name="__codelineno-0-1218"></a>    <span class="c1"># shape_i=0</span>
<a id="__codelineno-0-1219" name="__codelineno-0-1219"></a>    <span class="c1"># shape_original_centroid=ordered_centroids[shape_i, :]</span>
<a id="__codelineno-0-1220" name="__codelineno-0-1220"></a>    <span class="c1"># ref_centroids=np.delete(ordered_centroids, shape_i, axis=0)</span>
<a id="__codelineno-0-1221" name="__codelineno-0-1221"></a>    <span class="c1"># kernel=self.small_kernels</span>
<a id="__codelineno-0-1222" name="__codelineno-0-1222"></a>    <span class="n">previous_shape_to_expand</span> <span class="o">=</span> <span class="n">shape_to_expand</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-1223" name="__codelineno-0-1223"></a>    <span class="n">without_shape</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">without_shape_i</span><span class="p">)</span>
<a id="__codelineno-0-1224" name="__codelineno-0-1224"></a>    <span class="k">if</span> <span class="n">ref_centroids</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-1225" name="__codelineno-0-1225"></a>        <span class="c1"># Calculate the distance between the focal shape centroid and its 10% nearest neighbor centroids</span>
<a id="__codelineno-0-1226" name="__codelineno-0-1226"></a>        <span class="n">centroid_distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">ref_centroids</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">shape_original_centroid</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span>
<a id="__codelineno-0-1227" name="__codelineno-0-1227"></a>            <span class="n">ref_centroids</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">shape_original_centroid</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<a id="__codelineno-0-1228" name="__codelineno-0-1228"></a>        <span class="n">nearest_shapes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">greater_equal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">centroid_distances</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">centroid_distances</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1229" name="__codelineno-0-1229"></a>
<a id="__codelineno-0-1230" name="__codelineno-0-1230"></a>        <span class="c1"># Use the nearest neighbor distance as a maximal reference to get the minimal distance between the border of the shape and the neighboring centroids</span>
<a id="__codelineno-0-1231" name="__codelineno-0-1231"></a>        <span class="n">neighbor_mindist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">centroid_distances</span><span class="p">)</span>
<a id="__codelineno-0-1232" name="__codelineno-0-1232"></a>        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">shape_to_expand</span><span class="p">)</span>
<a id="__codelineno-0-1233" name="__codelineno-0-1233"></a>        <span class="k">for</span> <span class="n">shape_j</span> <span class="ow">in</span> <span class="n">nearest_shapes</span><span class="p">:</span>
<a id="__codelineno-0-1234" name="__codelineno-0-1234"></a>            <span class="n">neighbor_mindist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">neighbor_mindist</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span>
<a id="__codelineno-0-1235" name="__codelineno-0-1235"></a>                <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">ref_centroids</span><span class="p">[</span><span class="n">shape_j</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">idx</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">ref_centroids</span><span class="p">[</span><span class="n">shape_j</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]))))</span>
<a id="__codelineno-0-1236" name="__codelineno-0-1236"></a>        <span class="n">neighbor_mindist</span> <span class="o">*=</span> <span class="mf">0.5</span>
<a id="__codelineno-0-1237" name="__codelineno-0-1237"></a>        <span class="c1"># Get the maximal distance of the focal shape between its contour and its centroids</span>
<a id="__codelineno-0-1238" name="__codelineno-0-1238"></a>        <span class="n">itself_maxdist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span>
<a id="__codelineno-0-1239" name="__codelineno-0-1239"></a>            <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">shape_original_centroid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">idx</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">shape_original_centroid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
<a id="__codelineno-0-1240" name="__codelineno-0-1240"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1241" name="__codelineno-0-1241"></a>        <span class="n">itself_maxdist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">shape_to_expand</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<a id="__codelineno-0-1242" name="__codelineno-0-1242"></a>        <span class="n">neighbor_mindist</span> <span class="o">=</span> <span class="n">itself_maxdist</span>
<a id="__codelineno-0-1243" name="__codelineno-0-1243"></a>        <span class="n">nearest_shapes</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1244" name="__codelineno-0-1244"></a>    <span class="c1"># Put 1 at the border of the reference image in order to be able to stop the while loop once border reached</span>
<a id="__codelineno-0-1245" name="__codelineno-0-1245"></a>    <span class="n">without_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-1246" name="__codelineno-0-1246"></a>    <span class="n">without_shape</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-1247" name="__codelineno-0-1247"></a>    <span class="n">without_shape</span><span class="p">[</span><span class="n">without_shape</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-1248" name="__codelineno-0-1248"></a>    <span class="n">without_shape</span><span class="p">[:,</span> <span class="n">without_shape</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-1249" name="__codelineno-0-1249"></a>
<a id="__codelineno-0-1250" name="__codelineno-0-1250"></a>    <span class="c1"># Compare the distance between the contour of the shape and its centroid with this contour with the centroids of neighbors</span>
<a id="__codelineno-0-1251" name="__codelineno-0-1251"></a>    <span class="c1"># Continue as the distance made by the shape (from its centroid) keeps being smaller than its distance with the nearest centroid.</span>
<a id="__codelineno-0-1252" name="__codelineno-0-1252"></a>    <span class="k">while</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">less_equal</span><span class="p">(</span><span class="n">itself_maxdist</span><span class="p">,</span> <span class="n">neighbor_mindist</span><span class="p">)),</span>
<a id="__codelineno-0-1253" name="__codelineno-0-1253"></a>                         <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">shape_to_expand</span> <span class="o">*</span> <span class="n">without_shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
<a id="__codelineno-0-1254" name="__codelineno-0-1254"></a>        <span class="n">previous_shape_to_expand</span> <span class="o">=</span> <span class="n">shape_to_expand</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-1255" name="__codelineno-0-1255"></a>        <span class="c1"># Dilate the shape by the kernel size</span>
<a id="__codelineno-0-1256" name="__codelineno-0-1256"></a>        <span class="n">shape_to_expand</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dilate</span><span class="p">(</span><span class="n">shape_to_expand</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-1257" name="__codelineno-0-1257"></a>                                     <span class="n">borderType</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">BORDER_CONSTANT</span> <span class="o">|</span> <span class="n">cv2</span><span class="o">.</span><span class="n">BORDER_ISOLATED</span><span class="p">)</span>
<a id="__codelineno-0-1258" name="__codelineno-0-1258"></a>        <span class="c1"># Extract the new connected component</span>
<a id="__codelineno-0-1259" name="__codelineno-0-1259"></a>        <span class="n">shape_nb</span><span class="p">,</span> <span class="n">shape_to_expand</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">connectedComponents</span><span class="p">(</span><span class="n">shape_to_expand</span><span class="p">,</span> <span class="n">ltype</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">CV_16U</span><span class="p">)</span>
<a id="__codelineno-0-1260" name="__codelineno-0-1260"></a>        <span class="n">shape_to_expand</span> <span class="o">=</span> <span class="n">shape_to_expand</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-1261" name="__codelineno-0-1261"></a>        <span class="c1"># Use the nex shape coordinates to calculate the new distances of the shape with its centroid and with neighboring centroids</span>
<a id="__codelineno-0-1262" name="__codelineno-0-1262"></a>        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">shape_to_expand</span><span class="p">)</span>
<a id="__codelineno-0-1263" name="__codelineno-0-1263"></a>        <span class="k">for</span> <span class="n">shape_j</span> <span class="ow">in</span> <span class="n">nearest_shapes</span><span class="p">:</span>
<a id="__codelineno-0-1264" name="__codelineno-0-1264"></a>            <span class="n">neighbor_mindist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">neighbor_mindist</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span>
<a id="__codelineno-0-1265" name="__codelineno-0-1265"></a>                <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">ref_centroids</span><span class="p">[</span><span class="n">shape_j</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">idx</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">ref_centroids</span><span class="p">[</span><span class="n">shape_j</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]))))</span>
<a id="__codelineno-0-1266" name="__codelineno-0-1266"></a>        <span class="n">itself_maxdist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span>
<a id="__codelineno-0-1267" name="__codelineno-0-1267"></a>            <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">shape_original_centroid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">idx</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">shape_original_centroid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
<a id="__codelineno-0-1268" name="__codelineno-0-1268"></a>    <span class="k">return</span> <span class="n">previous_shape_to_expand</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellects.image_analysis.morphological_operations.find_major_incline" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find_major_incline</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="n">natural_noise</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Find the major incline section in a vector.</p>
<p>This function identifies the segment of a vector that exhibits
the most significant change in values, considering a specified
natural noise level. It returns the left and right indices that
define this segment.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>vector</code>
            </td>
            <td>
                  <code>ndarray of float64</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input data vector where the incline needs to be detected.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>natural_noise</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The acceptable noise level for determining the incline.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="int">int</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing two integers: the left and right indices
of the major incline section in the vector.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">natural_noise</span> <span class="o">=</span> <span class="mf">2.5</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">find_major_incline</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="n">natural_noise</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">(0, 1)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1017" name="__codelineno-0-1017"></a><span class="k">def</span><span class="w"> </span><span class="nf">find_major_incline</span><span class="p">(</span><span class="n">vector</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">natural_noise</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a><span class="sd">    Find the major incline section in a vector.</span>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a><span class="sd">    This function identifies the segment of a vector that exhibits</span>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a><span class="sd">    the most significant change in values, considering a specified</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a><span class="sd">    natural noise level. It returns the left and right indices that</span>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a><span class="sd">    define this segment.</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a><span class="sd">    vector : ndarray of float64</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a><span class="sd">        Input data vector where the incline needs to be detected.</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a><span class="sd">    natural_noise : float</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a><span class="sd">        The acceptable noise level for determining the incline.</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a><span class="sd">    Tuple[int, int]</span>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a><span class="sd">        A tuple containing two integers: the left and right indices</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a><span class="sd">        of the major incline section in the vector.</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a><span class="sd">    --------</span>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a><span class="sd">    &gt;&gt;&gt; vector = np.array([3, 5, 7, 9, 10])</span>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a><span class="sd">    &gt;&gt;&gt; natural_noise = 2.5</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a><span class="sd">    &gt;&gt;&gt; left, right = find_major_incline(vector, natural_noise)</span>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a><span class="sd">    &gt;&gt;&gt; (left, right)</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a><span class="sd">    (0, 1)</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a>    <span class="n">left</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a>    <span class="n">right</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a>    <span class="n">ref_length</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">natural_noise</span><span class="p">))</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a>    <span class="n">vector</span> <span class="o">=</span> <span class="n">moving_average</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a>    <span class="n">ref_extent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ptp</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a>    <span class="n">extent</span> <span class="o">=</span> <span class="n">ref_extent</span>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a>    <span class="c1"># Find the left limit:</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a>    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">ref_length</span> <span class="ow">and</span> <span class="n">extent</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">ref_extent</span> <span class="o">-</span> <span class="p">(</span><span class="n">natural_noise</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)):</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a>        <span class="n">vector</span> <span class="o">=</span> <span class="n">vector</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a>        <span class="n">extent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ptp</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a>        <span class="n">left</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a>    <span class="c1"># And the right one:</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a>    <span class="n">extent</span> <span class="o">=</span> <span class="n">ref_extent</span>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a>    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">ref_length</span> <span class="ow">and</span> <span class="n">extent</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">ref_extent</span> <span class="o">-</span> <span class="n">natural_noise</span> <span class="o">/</span> <span class="mi">2</span><span class="p">):</span>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a>        <span class="n">vector</span> <span class="o">=</span> <span class="n">vector</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-1062" name="__codelineno-0-1062"></a>        <span class="n">extent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ptp</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>
<a id="__codelineno-0-1063" name="__codelineno-0-1063"></a>        <span class="n">right</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-1064" name="__codelineno-0-1064"></a>    <span class="c1"># And the left again, with stronger stringency:</span>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a>    <span class="n">extent</span> <span class="o">=</span> <span class="n">ref_extent</span>
<a id="__codelineno-0-1066" name="__codelineno-0-1066"></a>    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">ref_length</span> <span class="ow">and</span> <span class="n">extent</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">ref_extent</span> <span class="o">-</span> <span class="n">natural_noise</span><span class="p">):</span>
<a id="__codelineno-0-1067" name="__codelineno-0-1067"></a>        <span class="n">vector</span> <span class="o">=</span> <span class="n">vector</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<a id="__codelineno-0-1068" name="__codelineno-0-1068"></a>        <span class="n">extent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ptp</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a>        <span class="n">left</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a>    <span class="c1"># When there is no incline, put back left and right to 0</span>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">ref_length</span><span class="p">:</span>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a>        <span class="n">left</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a>        <span class="n">right</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a>    <span class="k">return</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellects.image_analysis.morphological_operations.find_median_shape" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find_median_shape</span><span class="p">(</span><span class="n">binary_3d_matrix</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Find the median shape from a binary 3D matrix.</p>
<p>This function computes the median 2D slice of a binary (0/1) 3D matrix
by finding which voxels appear in at least half of the slices.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>binary_3d_matrix</code>
            </td>
            <td>
                  <code>ndarray of uint8</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input 3D binary matrix where each slice is a 2D array.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ndarray of uint8</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Median shape as a 2D binary matrix where the same voxels
that appear in at least half of the input slices are set to 1.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">binary_3d_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">median_shape</span> <span class="o">=</span> <span class="n">find_median_shape</span><span class="p">(</span><span class="n">binary_3d_matrix</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">median_shape</span><span class="p">)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-806" name="__codelineno-0-806"></a><span class="k">def</span><span class="w"> </span><span class="nf">find_median_shape</span><span class="p">(</span><span class="n">binary_3d_matrix</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">]:</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a><span class="sd">    Find the median shape from a binary 3D matrix.</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a><span class="sd">    This function computes the median 2D slice of a binary (0/1) 3D matrix</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a><span class="sd">    by finding which voxels appear in at least half of the slices.</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a><span class="sd">    binary_3d_matrix : ndarray of uint8</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a><span class="sd">        Input 3D binary matrix where each slice is a 2D array.</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a><span class="sd">    -------</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a><span class="sd">    ndarray of uint8</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a><span class="sd">        Median shape as a 2D binary matrix where the same voxels</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a><span class="sd">        that appear in at least half of the input slices are set to 1.</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a><span class="sd">    --------</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a><span class="sd">    &gt;&gt;&gt; binary_3d_matrix = np.random.randint(0, 2, (10, 5, 5), dtype=np.uint8)</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a><span class="sd">    &gt;&gt;&gt; median_shape = find_median_shape(binary_3d_matrix)</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a><span class="sd">    &gt;&gt;&gt; print(median_shape)</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a>    <span class="n">binary_2d_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">binary_3d_matrix</span><span class="p">)</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a>    <span class="n">median_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">binary_2d_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>    <span class="n">median_shape</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">greater_equal</span><span class="p">(</span><span class="n">binary_2d_matrix</span><span class="p">,</span> <span class="n">binary_3d_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a>    <span class="k">return</span> <span class="n">median_shape</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellects.image_analysis.morphological_operations.get_all_line_coordinates" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_all_line_coordinates</span><span class="p">(</span><span class="n">start_point</span><span class="p">,</span> <span class="n">end_points</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Get all line coordinates between start point and end points.</p>
<p>This function computes the coordinates of lines connecting a
start point to multiple end points, converting input arrays to float
if necessary before processing.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>start_point</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Starting coordinate point for the lines. Can be of any numeric type,
will be converted to float if needed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>end_points</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of end coordinate points for the lines. Can be of any
numeric type, will be converted to float if needed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>out</code></td>            <td>
                  <code><span title="List">List</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="int">int</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of numpy arrays containing the coordinates of each line
as integer values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">start_point</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">end_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">get_all_line_coordinates</span><span class="p">(</span><span class="n">start_point</span><span class="p">,</span> <span class="n">end_points</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go">[array([[0, 0],</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">   [0, 1],</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">   [1, 2]], dtype=uint64), array([[0, 0],</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go">   [1, 1],</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go">   [1, 2],</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go">   [2, 3],</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="go">   [3, 4]], dtype=uint64)]</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-706" name="__codelineno-0-706"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_all_line_coordinates</span><span class="p">(</span><span class="n">start_point</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">end_points</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a><span class="sd">    Get all line coordinates between start point and end points.</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a><span class="sd">    This function computes the coordinates of lines connecting a</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a><span class="sd">    start point to multiple end points, converting input arrays to float</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a><span class="sd">    if necessary before processing.</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a><span class="sd">    start_point : NDArray[float]</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a><span class="sd">        Starting coordinate point for the lines. Can be of any numeric type,</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a><span class="sd">        will be converted to float if needed.</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a><span class="sd">    end_points : NDArray[float]</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a><span class="sd">        Array of end coordinate points for the lines. Can be of any</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a><span class="sd">        numeric type, will be converted to float if needed.</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a><span class="sd">    -------</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a><span class="sd">    out : List[NDArray[int]]</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a><span class="sd">        A list of numpy arrays containing the coordinates of each line</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a><span class="sd">        as integer values.</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a><span class="sd">    --------</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a><span class="sd">    &gt;&gt;&gt; start_point = np.array([0, 0])</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a><span class="sd">    &gt;&gt;&gt; end_points = np.array([[1, 2], [3, 4]])</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a><span class="sd">    &gt;&gt;&gt; get_all_line_coordinates(start_point, end_points)</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a><span class="sd">    [array([[0, 0],</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a><span class="sd">       [0, 1],</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a><span class="sd">       [1, 2]], dtype=uint64), array([[0, 0],</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a><span class="sd">       [1, 1],</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a><span class="sd">       [1, 2],</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a><span class="sd">       [2, 3],</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a><span class="sd">       [3, 4]], dtype=uint64)]</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>    <span class="k">for</span> <span class="n">end_point</span> <span class="ow">in</span> <span class="n">end_points</span><span class="p">:</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>        <span class="n">line_coords</span> <span class="o">=</span> <span class="n">get_line_points</span><span class="p">(</span><span class="n">start_point</span><span class="p">,</span> <span class="n">end_point</span><span class="p">)</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">line_coords</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint64</span><span class="p">))</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>    <span class="k">return</span> <span class="n">lines</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellects.image_analysis.morphological_operations.get_bb_with_moving_centers" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_bb_with_moving_centers</span><span class="p">(</span><span class="n">motion_list</span><span class="p">,</span> <span class="n">all_specimens_have_same_direction</span><span class="p">,</span> <span class="n">original_shape_hsize</span><span class="p">,</span> <span class="n">binary_image</span><span class="p">,</span> <span class="n">y_boundaries</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Get the bounding boxes with moving centers.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>motion_list</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of binary images representing the motion frames.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>all_specimens_have_same_direction</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Boolean indicating if all specimens move in the same direction.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>original_shape_hsize</code>
            </td>
            <td>
                  <code><span title="int">int</span> or None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Original height size of the shape. If <code>None</code>, a default kernel size is used.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>binary_image</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Binary image of the initial frame.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_boundaries</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array defining the y-boundaries for ranking shapes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing:
- top : NDArray
    Array of top coordinates for each bounding box.
- bot : NDArray
    Array of bottom coordinates for each bounding box.
- left : NDArray
    Array of left coordinates for each bounding box.
- right : NDArray
    Array of right coordinates for each bounding box.
- ordered_image_i : NDArray
    Updated binary image with the final ranked shapes.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>This function processes each frame to expand and confirm shapes, updating centroids if necessary.
It uses morphological operations like dilation to detect shape changes over frames.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">top</span><span class="p">,</span> <span class="n">bot</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">ordered_image</span> <span class="o">=</span> <span class="n">_get_bb_with_moving_centers</span><span class="p">(</span><span class="n">motion_frames</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">binary_img</span><span class="p">,</span> <span class="n">y_bounds</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Top coordinates:&quot;</span><span class="p">,</span> <span class="n">top</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bottom coordinates:&quot;</span><span class="p">,</span> <span class="n">bot</span><span class="p">)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1644">1644</a></span>
<span class="normal"><a href="#__codelineno-0-1645">1645</a></span>
<span class="normal"><a href="#__codelineno-0-1646">1646</a></span>
<span class="normal"><a href="#__codelineno-0-1647">1647</a></span>
<span class="normal"><a href="#__codelineno-0-1648">1648</a></span>
<span class="normal"><a href="#__codelineno-0-1649">1649</a></span>
<span class="normal"><a href="#__codelineno-0-1650">1650</a></span>
<span class="normal"><a href="#__codelineno-0-1651">1651</a></span>
<span class="normal"><a href="#__codelineno-0-1652">1652</a></span>
<span class="normal"><a href="#__codelineno-0-1653">1653</a></span>
<span class="normal"><a href="#__codelineno-0-1654">1654</a></span>
<span class="normal"><a href="#__codelineno-0-1655">1655</a></span>
<span class="normal"><a href="#__codelineno-0-1656">1656</a></span>
<span class="normal"><a href="#__codelineno-0-1657">1657</a></span>
<span class="normal"><a href="#__codelineno-0-1658">1658</a></span>
<span class="normal"><a href="#__codelineno-0-1659">1659</a></span>
<span class="normal"><a href="#__codelineno-0-1660">1660</a></span>
<span class="normal"><a href="#__codelineno-0-1661">1661</a></span>
<span class="normal"><a href="#__codelineno-0-1662">1662</a></span>
<span class="normal"><a href="#__codelineno-0-1663">1663</a></span>
<span class="normal"><a href="#__codelineno-0-1664">1664</a></span>
<span class="normal"><a href="#__codelineno-0-1665">1665</a></span>
<span class="normal"><a href="#__codelineno-0-1666">1666</a></span>
<span class="normal"><a href="#__codelineno-0-1667">1667</a></span>
<span class="normal"><a href="#__codelineno-0-1668">1668</a></span>
<span class="normal"><a href="#__codelineno-0-1669">1669</a></span>
<span class="normal"><a href="#__codelineno-0-1670">1670</a></span>
<span class="normal"><a href="#__codelineno-0-1671">1671</a></span>
<span class="normal"><a href="#__codelineno-0-1672">1672</a></span>
<span class="normal"><a href="#__codelineno-0-1673">1673</a></span>
<span class="normal"><a href="#__codelineno-0-1674">1674</a></span>
<span class="normal"><a href="#__codelineno-0-1675">1675</a></span>
<span class="normal"><a href="#__codelineno-0-1676">1676</a></span>
<span class="normal"><a href="#__codelineno-0-1677">1677</a></span>
<span class="normal"><a href="#__codelineno-0-1678">1678</a></span>
<span class="normal"><a href="#__codelineno-0-1679">1679</a></span>
<span class="normal"><a href="#__codelineno-0-1680">1680</a></span>
<span class="normal"><a href="#__codelineno-0-1681">1681</a></span>
<span class="normal"><a href="#__codelineno-0-1682">1682</a></span>
<span class="normal"><a href="#__codelineno-0-1683">1683</a></span>
<span class="normal"><a href="#__codelineno-0-1684">1684</a></span>
<span class="normal"><a href="#__codelineno-0-1685">1685</a></span>
<span class="normal"><a href="#__codelineno-0-1686">1686</a></span>
<span class="normal"><a href="#__codelineno-0-1687">1687</a></span>
<span class="normal"><a href="#__codelineno-0-1688">1688</a></span>
<span class="normal"><a href="#__codelineno-0-1689">1689</a></span>
<span class="normal"><a href="#__codelineno-0-1690">1690</a></span>
<span class="normal"><a href="#__codelineno-0-1691">1691</a></span>
<span class="normal"><a href="#__codelineno-0-1692">1692</a></span>
<span class="normal"><a href="#__codelineno-0-1693">1693</a></span>
<span class="normal"><a href="#__codelineno-0-1694">1694</a></span>
<span class="normal"><a href="#__codelineno-0-1695">1695</a></span>
<span class="normal"><a href="#__codelineno-0-1696">1696</a></span>
<span class="normal"><a href="#__codelineno-0-1697">1697</a></span>
<span class="normal"><a href="#__codelineno-0-1698">1698</a></span>
<span class="normal"><a href="#__codelineno-0-1699">1699</a></span>
<span class="normal"><a href="#__codelineno-0-1700">1700</a></span>
<span class="normal"><a href="#__codelineno-0-1701">1701</a></span>
<span class="normal"><a href="#__codelineno-0-1702">1702</a></span>
<span class="normal"><a href="#__codelineno-0-1703">1703</a></span>
<span class="normal"><a href="#__codelineno-0-1704">1704</a></span>
<span class="normal"><a href="#__codelineno-0-1705">1705</a></span>
<span class="normal"><a href="#__codelineno-0-1706">1706</a></span>
<span class="normal"><a href="#__codelineno-0-1707">1707</a></span>
<span class="normal"><a href="#__codelineno-0-1708">1708</a></span>
<span class="normal"><a href="#__codelineno-0-1709">1709</a></span>
<span class="normal"><a href="#__codelineno-0-1710">1710</a></span>
<span class="normal"><a href="#__codelineno-0-1711">1711</a></span>
<span class="normal"><a href="#__codelineno-0-1712">1712</a></span>
<span class="normal"><a href="#__codelineno-0-1713">1713</a></span>
<span class="normal"><a href="#__codelineno-0-1714">1714</a></span>
<span class="normal"><a href="#__codelineno-0-1715">1715</a></span>
<span class="normal"><a href="#__codelineno-0-1716">1716</a></span>
<span class="normal"><a href="#__codelineno-0-1717">1717</a></span>
<span class="normal"><a href="#__codelineno-0-1718">1718</a></span>
<span class="normal"><a href="#__codelineno-0-1719">1719</a></span>
<span class="normal"><a href="#__codelineno-0-1720">1720</a></span>
<span class="normal"><a href="#__codelineno-0-1721">1721</a></span>
<span class="normal"><a href="#__codelineno-0-1722">1722</a></span>
<span class="normal"><a href="#__codelineno-0-1723">1723</a></span>
<span class="normal"><a href="#__codelineno-0-1724">1724</a></span>
<span class="normal"><a href="#__codelineno-0-1725">1725</a></span>
<span class="normal"><a href="#__codelineno-0-1726">1726</a></span>
<span class="normal"><a href="#__codelineno-0-1727">1727</a></span>
<span class="normal"><a href="#__codelineno-0-1728">1728</a></span>
<span class="normal"><a href="#__codelineno-0-1729">1729</a></span>
<span class="normal"><a href="#__codelineno-0-1730">1730</a></span>
<span class="normal"><a href="#__codelineno-0-1731">1731</a></span>
<span class="normal"><a href="#__codelineno-0-1732">1732</a></span>
<span class="normal"><a href="#__codelineno-0-1733">1733</a></span>
<span class="normal"><a href="#__codelineno-0-1734">1734</a></span>
<span class="normal"><a href="#__codelineno-0-1735">1735</a></span>
<span class="normal"><a href="#__codelineno-0-1736">1736</a></span>
<span class="normal"><a href="#__codelineno-0-1737">1737</a></span>
<span class="normal"><a href="#__codelineno-0-1738">1738</a></span>
<span class="normal"><a href="#__codelineno-0-1739">1739</a></span>
<span class="normal"><a href="#__codelineno-0-1740">1740</a></span>
<span class="normal"><a href="#__codelineno-0-1741">1741</a></span>
<span class="normal"><a href="#__codelineno-0-1742">1742</a></span>
<span class="normal"><a href="#__codelineno-0-1743">1743</a></span>
<span class="normal"><a href="#__codelineno-0-1744">1744</a></span>
<span class="normal"><a href="#__codelineno-0-1745">1745</a></span>
<span class="normal"><a href="#__codelineno-0-1746">1746</a></span>
<span class="normal"><a href="#__codelineno-0-1747">1747</a></span>
<span class="normal"><a href="#__codelineno-0-1748">1748</a></span>
<span class="normal"><a href="#__codelineno-0-1749">1749</a></span>
<span class="normal"><a href="#__codelineno-0-1750">1750</a></span>
<span class="normal"><a href="#__codelineno-0-1751">1751</a></span>
<span class="normal"><a href="#__codelineno-0-1752">1752</a></span>
<span class="normal"><a href="#__codelineno-0-1753">1753</a></span>
<span class="normal"><a href="#__codelineno-0-1754">1754</a></span>
<span class="normal"><a href="#__codelineno-0-1755">1755</a></span>
<span class="normal"><a href="#__codelineno-0-1756">1756</a></span>
<span class="normal"><a href="#__codelineno-0-1757">1757</a></span>
<span class="normal"><a href="#__codelineno-0-1758">1758</a></span>
<span class="normal"><a href="#__codelineno-0-1759">1759</a></span>
<span class="normal"><a href="#__codelineno-0-1760">1760</a></span>
<span class="normal"><a href="#__codelineno-0-1761">1761</a></span>
<span class="normal"><a href="#__codelineno-0-1762">1762</a></span>
<span class="normal"><a href="#__codelineno-0-1763">1763</a></span>
<span class="normal"><a href="#__codelineno-0-1764">1764</a></span>
<span class="normal"><a href="#__codelineno-0-1765">1765</a></span>
<span class="normal"><a href="#__codelineno-0-1766">1766</a></span>
<span class="normal"><a href="#__codelineno-0-1767">1767</a></span>
<span class="normal"><a href="#__codelineno-0-1768">1768</a></span>
<span class="normal"><a href="#__codelineno-0-1769">1769</a></span>
<span class="normal"><a href="#__codelineno-0-1770">1770</a></span>
<span class="normal"><a href="#__codelineno-0-1771">1771</a></span>
<span class="normal"><a href="#__codelineno-0-1772">1772</a></span>
<span class="normal"><a href="#__codelineno-0-1773">1773</a></span>
<span class="normal"><a href="#__codelineno-0-1774">1774</a></span>
<span class="normal"><a href="#__codelineno-0-1775">1775</a></span>
<span class="normal"><a href="#__codelineno-0-1776">1776</a></span>
<span class="normal"><a href="#__codelineno-0-1777">1777</a></span>
<span class="normal"><a href="#__codelineno-0-1778">1778</a></span>
<span class="normal"><a href="#__codelineno-0-1779">1779</a></span>
<span class="normal"><a href="#__codelineno-0-1780">1780</a></span>
<span class="normal"><a href="#__codelineno-0-1781">1781</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1644" name="__codelineno-0-1644"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_bb_with_moving_centers</span><span class="p">(</span><span class="n">motion_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">all_specimens_have_same_direction</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<a id="__codelineno-0-1645" name="__codelineno-0-1645"></a>                                <span class="n">original_shape_hsize</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">binary_image</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-1646" name="__codelineno-0-1646"></a>                                <span class="n">y_boundaries</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">):</span>
<a id="__codelineno-0-1647" name="__codelineno-0-1647"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1648" name="__codelineno-0-1648"></a><span class="sd">    Get the bounding boxes with moving centers.</span>
<a id="__codelineno-0-1649" name="__codelineno-0-1649"></a>
<a id="__codelineno-0-1650" name="__codelineno-0-1650"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-1651" name="__codelineno-0-1651"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-1652" name="__codelineno-0-1652"></a><span class="sd">    motion_list : list</span>
<a id="__codelineno-0-1653" name="__codelineno-0-1653"></a><span class="sd">        List of binary images representing the motion frames.</span>
<a id="__codelineno-0-1654" name="__codelineno-0-1654"></a><span class="sd">    all_specimens_have_same_direction : bool</span>
<a id="__codelineno-0-1655" name="__codelineno-0-1655"></a><span class="sd">        Boolean indicating if all specimens move in the same direction.</span>
<a id="__codelineno-0-1656" name="__codelineno-0-1656"></a><span class="sd">    original_shape_hsize : int or None</span>
<a id="__codelineno-0-1657" name="__codelineno-0-1657"></a><span class="sd">        Original height size of the shape. If `None`, a default kernel size is used.</span>
<a id="__codelineno-0-1658" name="__codelineno-0-1658"></a><span class="sd">    binary_image : NDArray</span>
<a id="__codelineno-0-1659" name="__codelineno-0-1659"></a><span class="sd">        Binary image of the initial frame.</span>
<a id="__codelineno-0-1660" name="__codelineno-0-1660"></a><span class="sd">    y_boundaries : NDArray</span>
<a id="__codelineno-0-1661" name="__codelineno-0-1661"></a><span class="sd">        Array defining the y-boundaries for ranking shapes.</span>
<a id="__codelineno-0-1662" name="__codelineno-0-1662"></a>
<a id="__codelineno-0-1663" name="__codelineno-0-1663"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-1664" name="__codelineno-0-1664"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1665" name="__codelineno-0-1665"></a><span class="sd">    tuple</span>
<a id="__codelineno-0-1666" name="__codelineno-0-1666"></a><span class="sd">        A tuple containing:</span>
<a id="__codelineno-0-1667" name="__codelineno-0-1667"></a><span class="sd">        - top : NDArray</span>
<a id="__codelineno-0-1668" name="__codelineno-0-1668"></a><span class="sd">            Array of top coordinates for each bounding box.</span>
<a id="__codelineno-0-1669" name="__codelineno-0-1669"></a><span class="sd">        - bot : NDArray</span>
<a id="__codelineno-0-1670" name="__codelineno-0-1670"></a><span class="sd">            Array of bottom coordinates for each bounding box.</span>
<a id="__codelineno-0-1671" name="__codelineno-0-1671"></a><span class="sd">        - left : NDArray</span>
<a id="__codelineno-0-1672" name="__codelineno-0-1672"></a><span class="sd">            Array of left coordinates for each bounding box.</span>
<a id="__codelineno-0-1673" name="__codelineno-0-1673"></a><span class="sd">        - right : NDArray</span>
<a id="__codelineno-0-1674" name="__codelineno-0-1674"></a><span class="sd">            Array of right coordinates for each bounding box.</span>
<a id="__codelineno-0-1675" name="__codelineno-0-1675"></a><span class="sd">        - ordered_image_i : NDArray</span>
<a id="__codelineno-0-1676" name="__codelineno-0-1676"></a><span class="sd">            Updated binary image with the final ranked shapes.</span>
<a id="__codelineno-0-1677" name="__codelineno-0-1677"></a>
<a id="__codelineno-0-1678" name="__codelineno-0-1678"></a><span class="sd">    Notes</span>
<a id="__codelineno-0-1679" name="__codelineno-0-1679"></a><span class="sd">    -----</span>
<a id="__codelineno-0-1680" name="__codelineno-0-1680"></a><span class="sd">    This function processes each frame to expand and confirm shapes, updating centroids if necessary.</span>
<a id="__codelineno-0-1681" name="__codelineno-0-1681"></a><span class="sd">    It uses morphological operations like dilation to detect shape changes over frames.</span>
<a id="__codelineno-0-1682" name="__codelineno-0-1682"></a>
<a id="__codelineno-0-1683" name="__codelineno-0-1683"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-1684" name="__codelineno-0-1684"></a><span class="sd">    --------</span>
<a id="__codelineno-0-1685" name="__codelineno-0-1685"></a><span class="sd">    &gt;&gt;&gt; top, bot, left, right, ordered_image = _get_bb_with_moving_centers(motion_frames, True, None, binary_img, y_bounds)</span>
<a id="__codelineno-0-1686" name="__codelineno-0-1686"></a><span class="sd">    &gt;&gt;&gt; print(&quot;Top coordinates:&quot;, top)</span>
<a id="__codelineno-0-1687" name="__codelineno-0-1687"></a><span class="sd">    &gt;&gt;&gt; print(&quot;Bottom coordinates:&quot;, bot)</span>
<a id="__codelineno-0-1688" name="__codelineno-0-1688"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1689" name="__codelineno-0-1689"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Read and segment each sample image and rank shapes from top to bot and from left to right&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1690" name="__codelineno-0-1690"></a>    <span class="n">k_size</span> <span class="o">=</span> <span class="mi">3</span>
<a id="__codelineno-0-1691" name="__codelineno-0-1691"></a>    <span class="k">if</span> <span class="n">original_shape_hsize</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1692" name="__codelineno-0-1692"></a>        <span class="n">k_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">original_shape_hsize</span> <span class="o">/</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-1693" name="__codelineno-0-1693"></a>    <span class="n">big_kernel</span> <span class="o">=</span> <span class="n">create_ellipse</span><span class="p">(</span><span class="n">k_size</span><span class="p">,</span> <span class="n">k_size</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-1694" name="__codelineno-0-1694"></a>
<a id="__codelineno-0-1695" name="__codelineno-0-1695"></a>    <span class="n">ordered_stats</span><span class="p">,</span> <span class="n">ordered_centroids</span><span class="p">,</span> <span class="n">ordered_image</span> <span class="o">=</span> <span class="n">rank_from_top_to_bottom_from_left_to_right</span><span class="p">(</span>
<a id="__codelineno-0-1696" name="__codelineno-0-1696"></a>        <span class="n">binary_image</span><span class="p">,</span> <span class="n">y_boundaries</span><span class="p">,</span> <span class="n">get_ordered_image</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-1697" name="__codelineno-0-1697"></a>    <span class="n">blob_number</span> <span class="o">=</span> <span class="n">ordered_stats</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1698" name="__codelineno-0-1698"></a>
<a id="__codelineno-0-1699" name="__codelineno-0-1699"></a>    <span class="n">ordered_image_i</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">ordered_image</span><span class="p">)</span>
<a id="__codelineno-0-1700" name="__codelineno-0-1700"></a>    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;For each frame, expand each previously confirmed shape to add area to its maximal bounding box&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1701" name="__codelineno-0-1701"></a>    <span class="k">for</span> <span class="n">step_i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">motion_list</span><span class="p">)):</span>
<a id="__codelineno-0-1702" name="__codelineno-0-1702"></a>        <span class="n">previously_ordered_centroids</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">ordered_centroids</span><span class="p">)</span>
<a id="__codelineno-0-1703" name="__codelineno-0-1703"></a>        <span class="n">new_image_i</span> <span class="o">=</span> <span class="n">motion_list</span><span class="p">[</span><span class="n">step_i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-1704" name="__codelineno-0-1704"></a>        <span class="n">detected_shape_number</span> <span class="o">=</span> <span class="n">blob_number</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-1705" name="__codelineno-0-1705"></a>        <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-1706" name="__codelineno-0-1706"></a>        <span class="k">while</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="ow">and</span> <span class="n">detected_shape_number</span> <span class="o">==</span> <span class="n">blob_number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-1707" name="__codelineno-0-1707"></a>            <span class="n">c</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-1708" name="__codelineno-0-1708"></a>            <span class="n">image_i</span> <span class="o">=</span> <span class="n">new_image_i</span>
<a id="__codelineno-0-1709" name="__codelineno-0-1709"></a>            <span class="n">new_image_i</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dilate</span><span class="p">(</span><span class="n">image_i</span><span class="p">,</span> <span class="n">cross_33</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-1710" name="__codelineno-0-1710"></a>            <span class="n">detected_shape_number</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">connectedComponents</span><span class="p">(</span><span class="n">new_image_i</span><span class="p">,</span> <span class="n">connectivity</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<a id="__codelineno-0-1711" name="__codelineno-0-1711"></a>        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1712" name="__codelineno-0-1712"></a>            <span class="k">break</span>
<a id="__codelineno-0-1713" name="__codelineno-0-1713"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1714" name="__codelineno-0-1714"></a>            <span class="k">for</span> <span class="n">shape_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">blob_number</span><span class="p">):</span>
<a id="__codelineno-0-1715" name="__codelineno-0-1715"></a>                <span class="n">shape_to_expand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">image_i</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-1716" name="__codelineno-0-1716"></a>                <span class="n">shape_to_expand</span><span class="p">[</span><span class="n">ordered_image_i</span> <span class="o">==</span> <span class="p">(</span><span class="n">shape_i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-1717" name="__codelineno-0-1717"></a>                <span class="n">without_shape_i</span> <span class="o">=</span> <span class="n">ordered_image_i</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-1718" name="__codelineno-0-1718"></a>                <span class="n">without_shape_i</span><span class="p">[</span><span class="n">ordered_image_i</span> <span class="o">==</span> <span class="p">(</span><span class="n">shape_i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-1719" name="__codelineno-0-1719"></a>                <span class="k">if</span> <span class="n">k_size</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
<a id="__codelineno-0-1720" name="__codelineno-0-1720"></a>                    <span class="n">test_shape</span> <span class="o">=</span> <span class="n">expand_until_neighbor_center_gets_nearer_than_own</span><span class="p">(</span><span class="n">shape_to_expand</span><span class="p">,</span> <span class="n">without_shape_i</span><span class="p">,</span>
<a id="__codelineno-0-1721" name="__codelineno-0-1721"></a>                                                                                   <span class="n">ordered_centroids</span><span class="p">[</span><span class="n">shape_i</span><span class="p">,</span> <span class="p">:],</span>
<a id="__codelineno-0-1722" name="__codelineno-0-1722"></a>                                                                                   <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">ordered_centroids</span><span class="p">,</span> <span class="n">shape_i</span><span class="p">,</span>
<a id="__codelineno-0-1723" name="__codelineno-0-1723"></a>                                                                                             <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">big_kernel</span><span class="p">)</span>
<a id="__codelineno-0-1724" name="__codelineno-0-1724"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1725" name="__codelineno-0-1725"></a>                    <span class="n">test_shape</span> <span class="o">=</span> <span class="n">shape_to_expand</span>
<a id="__codelineno-0-1726" name="__codelineno-0-1726"></a>                <span class="n">test_shape</span> <span class="o">=</span> <span class="n">expand_until_neighbor_center_gets_nearer_than_own</span><span class="p">(</span><span class="n">test_shape</span><span class="p">,</span> <span class="n">without_shape_i</span><span class="p">,</span>
<a id="__codelineno-0-1727" name="__codelineno-0-1727"></a>                                                                               <span class="n">ordered_centroids</span><span class="p">[</span><span class="n">shape_i</span><span class="p">,</span> <span class="p">:],</span>
<a id="__codelineno-0-1728" name="__codelineno-0-1728"></a>                                                                               <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">ordered_centroids</span><span class="p">,</span> <span class="n">shape_i</span><span class="p">,</span>
<a id="__codelineno-0-1729" name="__codelineno-0-1729"></a>                                                                                         <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">cross_33</span><span class="p">)</span>
<a id="__codelineno-0-1730" name="__codelineno-0-1730"></a>                <span class="n">confirmed_shape</span> <span class="o">=</span> <span class="n">test_shape</span> <span class="o">*</span> <span class="n">image_i</span>
<a id="__codelineno-0-1731" name="__codelineno-0-1731"></a>                <span class="n">ordered_image_i</span><span class="p">[</span><span class="n">confirmed_shape</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">shape_i</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-1732" name="__codelineno-0-1732"></a>
<a id="__codelineno-0-1733" name="__codelineno-0-1733"></a>
<a id="__codelineno-0-1734" name="__codelineno-0-1734"></a>            <span class="n">mask_to_display</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">image_i</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-1735" name="__codelineno-0-1735"></a>            <span class="n">mask_to_display</span><span class="p">[</span><span class="n">ordered_image_i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-1736" name="__codelineno-0-1736"></a>
<a id="__codelineno-0-1737" name="__codelineno-0-1737"></a>            <span class="c1"># If the blob moves enough to drastically change its gravity center,</span>
<a id="__codelineno-0-1738" name="__codelineno-0-1738"></a>            <span class="c1"># update the ordered centroids at each frame.</span>
<a id="__codelineno-0-1739" name="__codelineno-0-1739"></a>            <span class="n">detected_shape_number</span><span class="p">,</span> <span class="n">mask_to_display</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">connectedComponents</span><span class="p">(</span><span class="n">mask_to_display</span><span class="p">,</span>
<a id="__codelineno-0-1740" name="__codelineno-0-1740"></a>                                                                             <span class="n">connectivity</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<a id="__codelineno-0-1741" name="__codelineno-0-1741"></a>
<a id="__codelineno-0-1742" name="__codelineno-0-1742"></a>            <span class="n">mask_to_display</span> <span class="o">=</span> <span class="n">mask_to_display</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-1743" name="__codelineno-0-1743"></a>            <span class="k">while</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">detected_shape_number</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">!=</span> <span class="n">blob_number</span><span class="p">,</span>
<a id="__codelineno-0-1744" name="__codelineno-0-1744"></a>                                 <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mask_to_display</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">mask_to_display</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
<a id="__codelineno-0-1745" name="__codelineno-0-1745"></a>                <span class="n">mask_to_display</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dilate</span><span class="p">(</span><span class="n">mask_to_display</span><span class="p">,</span> <span class="n">cross_33</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-1746" name="__codelineno-0-1746"></a>                <span class="n">detected_shape_number</span><span class="p">,</span> <span class="n">mask_to_display</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">connectedComponents</span><span class="p">(</span><span class="n">mask_to_display</span><span class="p">,</span>
<a id="__codelineno-0-1747" name="__codelineno-0-1747"></a>                                                                                 <span class="n">connectivity</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<a id="__codelineno-0-1748" name="__codelineno-0-1748"></a>                <span class="n">mask_to_display</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">mask_to_display</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-1749" name="__codelineno-0-1749"></a>                <span class="n">mask_to_display</span> <span class="o">=</span> <span class="n">mask_to_display</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-1750" name="__codelineno-0-1750"></a>            <span class="n">ordered_stats</span><span class="p">,</span> <span class="n">ordered_centroids</span> <span class="o">=</span> <span class="n">rank_from_top_to_bottom_from_left_to_right</span><span class="p">(</span><span class="n">mask_to_display</span><span class="p">,</span> <span class="n">y_boundaries</span><span class="p">)</span>
<a id="__codelineno-0-1751" name="__codelineno-0-1751"></a>
<a id="__codelineno-0-1752" name="__codelineno-0-1752"></a>            <span class="k">if</span> <span class="n">all_specimens_have_same_direction</span><span class="p">:</span>
<a id="__codelineno-0-1753" name="__codelineno-0-1753"></a>                <span class="c1"># Adjust each centroid position according to the maximal centroid displacement.</span>
<a id="__codelineno-0-1754" name="__codelineno-0-1754"></a>                <span class="n">x_diffs</span> <span class="o">=</span> <span class="n">ordered_centroids</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">previously_ordered_centroids</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1755" name="__codelineno-0-1755"></a>                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x_diffs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># They moved left, we add to x</span>
<a id="__codelineno-0-1756" name="__codelineno-0-1756"></a>                    <span class="n">add_to_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x_diffs</span><span class="p">)</span> <span class="o">-</span> <span class="n">x_diffs</span>
<a id="__codelineno-0-1757" name="__codelineno-0-1757"></a>                <span class="k">else</span><span class="p">:</span> <span class="c1">#They moved right, we remove from x</span>
<a id="__codelineno-0-1758" name="__codelineno-0-1758"></a>                    <span class="n">add_to_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x_diffs</span><span class="p">)</span> <span class="o">-</span> <span class="n">x_diffs</span>
<a id="__codelineno-0-1759" name="__codelineno-0-1759"></a>                <span class="n">ordered_centroids</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">ordered_centroids</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">add_to_x</span>
<a id="__codelineno-0-1760" name="__codelineno-0-1760"></a>
<a id="__codelineno-0-1761" name="__codelineno-0-1761"></a>                <span class="n">y_diffs</span> <span class="o">=</span> <span class="n">ordered_centroids</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">previously_ordered_centroids</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-1762" name="__codelineno-0-1762"></a>                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_diffs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># They moved down, we add to y</span>
<a id="__codelineno-0-1763" name="__codelineno-0-1763"></a>                    <span class="n">add_to_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y_diffs</span><span class="p">)</span> <span class="o">-</span> <span class="n">y_diffs</span>
<a id="__codelineno-0-1764" name="__codelineno-0-1764"></a>                <span class="k">else</span><span class="p">:</span>  <span class="c1"># They moved up, we remove from y</span>
<a id="__codelineno-0-1765" name="__codelineno-0-1765"></a>                    <span class="n">add_to_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y_diffs</span><span class="p">)</span> <span class="o">-</span> <span class="n">y_diffs</span>
<a id="__codelineno-0-1766" name="__codelineno-0-1766"></a>                <span class="n">ordered_centroids</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">ordered_centroids</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">add_to_y</span>
<a id="__codelineno-0-1767" name="__codelineno-0-1767"></a>
<a id="__codelineno-0-1768" name="__codelineno-0-1768"></a>            <span class="n">ordered_image_i</span> <span class="o">=</span> <span class="n">mask_to_display</span>
<a id="__codelineno-0-1769" name="__codelineno-0-1769"></a>
<a id="__codelineno-0-1770" name="__codelineno-0-1770"></a>    <span class="c1"># Save each bounding box</span>
<a id="__codelineno-0-1771" name="__codelineno-0-1771"></a>    <span class="n">top</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">blob_number</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<a id="__codelineno-0-1772" name="__codelineno-0-1772"></a>    <span class="n">bot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">binary_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">blob_number</span><span class="p">)</span>
<a id="__codelineno-0-1773" name="__codelineno-0-1773"></a>    <span class="n">left</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">blob_number</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<a id="__codelineno-0-1774" name="__codelineno-0-1774"></a>    <span class="n">right</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">binary_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">blob_number</span><span class="p">)</span>
<a id="__codelineno-0-1775" name="__codelineno-0-1775"></a>    <span class="k">for</span> <span class="n">shape_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">blob_number</span><span class="p">):</span>
<a id="__codelineno-0-1776" name="__codelineno-0-1776"></a>        <span class="n">shape_i_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ordered_image_i</span> <span class="o">==</span> <span class="n">shape_i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-1777" name="__codelineno-0-1777"></a>        <span class="n">left</span><span class="p">[</span><span class="n">shape_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">shape_i_indices</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-1778" name="__codelineno-0-1778"></a>        <span class="n">right</span><span class="p">[</span><span class="n">shape_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">shape_i_indices</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-1779" name="__codelineno-0-1779"></a>        <span class="n">top</span><span class="p">[</span><span class="n">shape_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">shape_i_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-1780" name="__codelineno-0-1780"></a>        <span class="n">bot</span><span class="p">[</span><span class="n">shape_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">shape_i_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-1781" name="__codelineno-0-1781"></a>    <span class="k">return</span> <span class="n">top</span><span class="p">,</span> <span class="n">bot</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">ordered_image_i</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellects.image_analysis.morphological_operations.get_contours" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_contours</span><span class="p">(</span><span class="n">binary_image</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Find and return the contours of a binary image.</p>
<p>This function erodes the input binary image using a 3x3 cross-shaped
structuring element and then subtracts the eroded image from the original to obtain the contours.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>binary_image</code>
            </td>
            <td>
                  <code>ndarray of uint8</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input binary image from which to extract contours.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>out</code></td>            <td>
                  <code>ndarray of uint8</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Image containing only the contours extracted from <code>binary_image</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">binary_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">binary_image</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">get_contours</span><span class="p">(</span><span class="n">binary_image</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">[[0 0 0 0 0 0 0 0 0 0]</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go"> [0 0 0 0 0 0 0 0 0 0]</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go"> [0 0 1 1 1 1 1 1 0 0]</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go"> [0 0 1 0 0 0 0 1 0 0]</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go"> [0 0 1 0 0 0 0 1 0 0]</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="go"> [0 0 1 0 0 0 0 1 0 0]</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="go"> [0 0 1 0 0 0 0 1 0 0]</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="go"> [0 0 1 1 1 1 1 1 0 0]</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="go"> [0 0 0 0 0 0 0 0 0 0]</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="go"> [0 0 0 0 0 0 0 0 0 0]]</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1507">1507</a></span>
<span class="normal"><a href="#__codelineno-0-1508">1508</a></span>
<span class="normal"><a href="#__codelineno-0-1509">1509</a></span>
<span class="normal"><a href="#__codelineno-0-1510">1510</a></span>
<span class="normal"><a href="#__codelineno-0-1511">1511</a></span>
<span class="normal"><a href="#__codelineno-0-1512">1512</a></span>
<span class="normal"><a href="#__codelineno-0-1513">1513</a></span>
<span class="normal"><a href="#__codelineno-0-1514">1514</a></span>
<span class="normal"><a href="#__codelineno-0-1515">1515</a></span>
<span class="normal"><a href="#__codelineno-0-1516">1516</a></span>
<span class="normal"><a href="#__codelineno-0-1517">1517</a></span>
<span class="normal"><a href="#__codelineno-0-1518">1518</a></span>
<span class="normal"><a href="#__codelineno-0-1519">1519</a></span>
<span class="normal"><a href="#__codelineno-0-1520">1520</a></span>
<span class="normal"><a href="#__codelineno-0-1521">1521</a></span>
<span class="normal"><a href="#__codelineno-0-1522">1522</a></span>
<span class="normal"><a href="#__codelineno-0-1523">1523</a></span>
<span class="normal"><a href="#__codelineno-0-1524">1524</a></span>
<span class="normal"><a href="#__codelineno-0-1525">1525</a></span>
<span class="normal"><a href="#__codelineno-0-1526">1526</a></span>
<span class="normal"><a href="#__codelineno-0-1527">1527</a></span>
<span class="normal"><a href="#__codelineno-0-1528">1528</a></span>
<span class="normal"><a href="#__codelineno-0-1529">1529</a></span>
<span class="normal"><a href="#__codelineno-0-1530">1530</a></span>
<span class="normal"><a href="#__codelineno-0-1531">1531</a></span>
<span class="normal"><a href="#__codelineno-0-1532">1532</a></span>
<span class="normal"><a href="#__codelineno-0-1533">1533</a></span>
<span class="normal"><a href="#__codelineno-0-1534">1534</a></span>
<span class="normal"><a href="#__codelineno-0-1535">1535</a></span>
<span class="normal"><a href="#__codelineno-0-1536">1536</a></span>
<span class="normal"><a href="#__codelineno-0-1537">1537</a></span>
<span class="normal"><a href="#__codelineno-0-1538">1538</a></span>
<span class="normal"><a href="#__codelineno-0-1539">1539</a></span>
<span class="normal"><a href="#__codelineno-0-1540">1540</a></span>
<span class="normal"><a href="#__codelineno-0-1541">1541</a></span>
<span class="normal"><a href="#__codelineno-0-1542">1542</a></span>
<span class="normal"><a href="#__codelineno-0-1543">1543</a></span>
<span class="normal"><a href="#__codelineno-0-1544">1544</a></span>
<span class="normal"><a href="#__codelineno-0-1545">1545</a></span>
<span class="normal"><a href="#__codelineno-0-1546">1546</a></span>
<span class="normal"><a href="#__codelineno-0-1547">1547</a></span>
<span class="normal"><a href="#__codelineno-0-1548">1548</a></span>
<span class="normal"><a href="#__codelineno-0-1549">1549</a></span>
<span class="normal"><a href="#__codelineno-0-1550">1550</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1507" name="__codelineno-0-1507"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_contours</span><span class="p">(</span><span class="n">binary_image</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">]:</span>
<a id="__codelineno-0-1508" name="__codelineno-0-1508"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1509" name="__codelineno-0-1509"></a><span class="sd">    Find and return the contours of a binary image.</span>
<a id="__codelineno-0-1510" name="__codelineno-0-1510"></a>
<a id="__codelineno-0-1511" name="__codelineno-0-1511"></a><span class="sd">    This function erodes the input binary image using a 3x3 cross-shaped</span>
<a id="__codelineno-0-1512" name="__codelineno-0-1512"></a><span class="sd">    structuring element and then subtracts the eroded image from the original to obtain the contours.</span>
<a id="__codelineno-0-1513" name="__codelineno-0-1513"></a>
<a id="__codelineno-0-1514" name="__codelineno-0-1514"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-1515" name="__codelineno-0-1515"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-1516" name="__codelineno-0-1516"></a><span class="sd">    binary_image : ndarray of uint8</span>
<a id="__codelineno-0-1517" name="__codelineno-0-1517"></a><span class="sd">        Input binary image from which to extract contours.</span>
<a id="__codelineno-0-1518" name="__codelineno-0-1518"></a>
<a id="__codelineno-0-1519" name="__codelineno-0-1519"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-1520" name="__codelineno-0-1520"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1521" name="__codelineno-0-1521"></a><span class="sd">    out : ndarray of uint8</span>
<a id="__codelineno-0-1522" name="__codelineno-0-1522"></a><span class="sd">        Image containing only the contours extracted from `binary_image`.</span>
<a id="__codelineno-0-1523" name="__codelineno-0-1523"></a>
<a id="__codelineno-0-1524" name="__codelineno-0-1524"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-1525" name="__codelineno-0-1525"></a><span class="sd">    --------</span>
<a id="__codelineno-0-1526" name="__codelineno-0-1526"></a><span class="sd">    &gt;&gt;&gt; binary_image = np.zeros((10, 10), dtype=np.uint8)</span>
<a id="__codelineno-0-1527" name="__codelineno-0-1527"></a><span class="sd">    &gt;&gt;&gt; binary_image[2:8, 2:8] = 1</span>
<a id="__codelineno-0-1528" name="__codelineno-0-1528"></a><span class="sd">    &gt;&gt;&gt; result = get_contours(binary_image)</span>
<a id="__codelineno-0-1529" name="__codelineno-0-1529"></a><span class="sd">    &gt;&gt;&gt; print(result)</span>
<a id="__codelineno-0-1530" name="__codelineno-0-1530"></a><span class="sd">    [[0 0 0 0 0 0 0 0 0 0]</span>
<a id="__codelineno-0-1531" name="__codelineno-0-1531"></a><span class="sd">     [0 0 0 0 0 0 0 0 0 0]</span>
<a id="__codelineno-0-1532" name="__codelineno-0-1532"></a><span class="sd">     [0 0 1 1 1 1 1 1 0 0]</span>
<a id="__codelineno-0-1533" name="__codelineno-0-1533"></a><span class="sd">     [0 0 1 0 0 0 0 1 0 0]</span>
<a id="__codelineno-0-1534" name="__codelineno-0-1534"></a><span class="sd">     [0 0 1 0 0 0 0 1 0 0]</span>
<a id="__codelineno-0-1535" name="__codelineno-0-1535"></a><span class="sd">     [0 0 1 0 0 0 0 1 0 0]</span>
<a id="__codelineno-0-1536" name="__codelineno-0-1536"></a><span class="sd">     [0 0 1 0 0 0 0 1 0 0]</span>
<a id="__codelineno-0-1537" name="__codelineno-0-1537"></a><span class="sd">     [0 0 1 1 1 1 1 1 0 0]</span>
<a id="__codelineno-0-1538" name="__codelineno-0-1538"></a><span class="sd">     [0 0 0 0 0 0 0 0 0 0]</span>
<a id="__codelineno-0-1539" name="__codelineno-0-1539"></a><span class="sd">     [0 0 0 0 0 0 0 0 0 0]]</span>
<a id="__codelineno-0-1540" name="__codelineno-0-1540"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1541" name="__codelineno-0-1541"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">binary_image</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">):</span>
<a id="__codelineno-0-1542" name="__codelineno-0-1542"></a>        <span class="n">binary_image</span> <span class="o">=</span> <span class="n">binary_image</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-1543" name="__codelineno-0-1543"></a>    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">binary_image</span><span class="p">):</span>
<a id="__codelineno-0-1544" name="__codelineno-0-1544"></a>        <span class="n">contours</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">image_borders</span><span class="p">(</span><span class="n">binary_image</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<a id="__codelineno-0-1545" name="__codelineno-0-1545"></a>    <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">binary_image</span><span class="p">):</span>
<a id="__codelineno-0-1546" name="__codelineno-0-1546"></a>        <span class="n">eroded_binary</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">erode</span><span class="p">(</span><span class="n">binary_image</span><span class="p">,</span> <span class="n">cross_33</span><span class="p">,</span> <span class="n">borderType</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">BORDER_CONSTANT</span><span class="p">,</span> <span class="n">borderValue</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-1547" name="__codelineno-0-1547"></a>        <span class="n">contours</span> <span class="o">=</span> <span class="n">binary_image</span> <span class="o">-</span> <span class="n">eroded_binary</span>
<a id="__codelineno-0-1548" name="__codelineno-0-1548"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1549" name="__codelineno-0-1549"></a>        <span class="n">contours</span> <span class="o">=</span> <span class="n">binary_image</span>
<a id="__codelineno-0-1550" name="__codelineno-0-1550"></a>    <span class="k">return</span> <span class="n">contours</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellects.image_analysis.morphological_operations.get_largest_connected_component" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_largest_connected_component</span><span class="p">(</span><span class="n">segmentation</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Find the largest connected component in a segmentation image.</p>
<p>This function labels all connected components in a binary
segmentation image, determines the size of each component,
and returns information about the largest connected component.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>segmentation</code>
            </td>
            <td>
                  <code>ndarray of uint8</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Binary segmentation image where different integer values represent
different connected components.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>Tuple[int, ndarray of bool]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing:
- The size of the largest connected component.
- A boolean mask representing the largest connected
  component in the input segmentation image.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">segmentation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">segmentation</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">segmentation</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">size</span><span class="p">,</span> <span class="n">mask</span> <span class="o">=</span> <span class="n">get_largest_connected_component</span><span class="p">(</span><span class="n">segmentation</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">12</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1149" name="__codelineno-0-1149"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_largest_connected_component</span><span class="p">(</span><span class="n">segmentation</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">[</span><span class="nb">bool</span><span class="p">]]:</span>
<a id="__codelineno-0-1150" name="__codelineno-0-1150"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1151" name="__codelineno-0-1151"></a><span class="sd">    Find the largest connected component in a segmentation image.</span>
<a id="__codelineno-0-1152" name="__codelineno-0-1152"></a>
<a id="__codelineno-0-1153" name="__codelineno-0-1153"></a><span class="sd">    This function labels all connected components in a binary</span>
<a id="__codelineno-0-1154" name="__codelineno-0-1154"></a><span class="sd">    segmentation image, determines the size of each component,</span>
<a id="__codelineno-0-1155" name="__codelineno-0-1155"></a><span class="sd">    and returns information about the largest connected component.</span>
<a id="__codelineno-0-1156" name="__codelineno-0-1156"></a>
<a id="__codelineno-0-1157" name="__codelineno-0-1157"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-1158" name="__codelineno-0-1158"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-1159" name="__codelineno-0-1159"></a><span class="sd">    segmentation : ndarray of uint8</span>
<a id="__codelineno-0-1160" name="__codelineno-0-1160"></a><span class="sd">        Binary segmentation image where different integer values represent</span>
<a id="__codelineno-0-1161" name="__codelineno-0-1161"></a><span class="sd">        different connected components.</span>
<a id="__codelineno-0-1162" name="__codelineno-0-1162"></a>
<a id="__codelineno-0-1163" name="__codelineno-0-1163"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-1164" name="__codelineno-0-1164"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1165" name="__codelineno-0-1165"></a><span class="sd">    Tuple[int, ndarray of bool]</span>
<a id="__codelineno-0-1166" name="__codelineno-0-1166"></a><span class="sd">        A tuple containing:</span>
<a id="__codelineno-0-1167" name="__codelineno-0-1167"></a><span class="sd">        - The size of the largest connected component.</span>
<a id="__codelineno-0-1168" name="__codelineno-0-1168"></a><span class="sd">        - A boolean mask representing the largest connected</span>
<a id="__codelineno-0-1169" name="__codelineno-0-1169"></a><span class="sd">          component in the input segmentation image.</span>
<a id="__codelineno-0-1170" name="__codelineno-0-1170"></a>
<a id="__codelineno-0-1171" name="__codelineno-0-1171"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-1172" name="__codelineno-0-1172"></a><span class="sd">    --------</span>
<a id="__codelineno-0-1173" name="__codelineno-0-1173"></a><span class="sd">    &gt;&gt;&gt; segmentation = np.zeros((10, 10), dtype=np.uint8)</span>
<a id="__codelineno-0-1174" name="__codelineno-0-1174"></a><span class="sd">    &gt;&gt;&gt; segmentation[2:6, 2:5] = 1</span>
<a id="__codelineno-0-1175" name="__codelineno-0-1175"></a><span class="sd">    &gt;&gt;&gt; segmentation[6:9, 6:9] = 1</span>
<a id="__codelineno-0-1176" name="__codelineno-0-1176"></a><span class="sd">    &gt;&gt;&gt; size, mask = get_largest_connected_component(segmentation)</span>
<a id="__codelineno-0-1177" name="__codelineno-0-1177"></a><span class="sd">    &gt;&gt;&gt; print(size)</span>
<a id="__codelineno-0-1178" name="__codelineno-0-1178"></a><span class="sd">    12</span>
<a id="__codelineno-0-1179" name="__codelineno-0-1179"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1180" name="__codelineno-0-1180"></a>    <span class="n">labels</span> <span class="o">=</span> <span class="n">label</span><span class="p">(</span><span class="n">segmentation</span><span class="p">)</span>
<a id="__codelineno-0-1181" name="__codelineno-0-1181"></a>    <span class="k">assert</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># assume at least 1 CC</span>
<a id="__codelineno-0-1182" name="__codelineno-0-1182"></a>    <span class="n">con_comp_sizes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">flat</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>
<a id="__codelineno-0-1183" name="__codelineno-0-1183"></a>    <span class="n">largest_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">con_comp_sizes</span><span class="p">)</span>
<a id="__codelineno-0-1184" name="__codelineno-0-1184"></a>    <span class="n">largest_connected_component</span> <span class="o">=</span> <span class="n">labels</span> <span class="o">==</span> <span class="n">largest_idx</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-1185" name="__codelineno-0-1185"></a>    <span class="k">return</span> <span class="n">con_comp_sizes</span><span class="p">[</span><span class="n">largest_idx</span><span class="p">],</span> <span class="n">largest_connected_component</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellects.image_analysis.morphological_operations.get_line_points" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_line_points</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Get line points between two endpoints using Bresenham's line algorithm.</p>
<p>This function calculates all the integer coordinate points that form a
line between two endpoints using Bresenham's line algorithm. It is
optimized for performance using Numba's just-in-time compilation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>start</code>
            </td>
            <td>
                  <code>tuple of int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The starting point coordinates (x0, y0).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>end</code>
            </td>
            <td>
                  <code>tuple of int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ending point coordinates (x1, y1).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>out</code></td>            <td>
                  <code>ndarray of int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of points representing the line, with shape (N, 2), where N is
the number of points on the line.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">start</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">end</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">get_line_points</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">[[0 0]</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">[0 1]</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go">[1 2]]</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-637" name="__codelineno-0-637"></a><span class="nd">@njit</span><span class="p">()</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_line_points</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a><span class="sd">    Get line points between two endpoints using Bresenham&#39;s line algorithm.</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a><span class="sd">    This function calculates all the integer coordinate points that form a</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a><span class="sd">    line between two endpoints using Bresenham&#39;s line algorithm. It is</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a><span class="sd">    optimized for performance using Numba&#39;s just-in-time compilation.</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a><span class="sd">    start : tuple of int</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a><span class="sd">        The starting point coordinates (x0, y0).</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a><span class="sd">    end : tuple of int</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a><span class="sd">        The ending point coordinates (x1, y1).</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a><span class="sd">    -------</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a><span class="sd">    out : ndarray of int</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a><span class="sd">        Array of points representing the line, with shape (N, 2), where N is</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a><span class="sd">        the number of points on the line.</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a><span class="sd">    --------</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a><span class="sd">    &gt;&gt;&gt; start = (0, 0)</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a><span class="sd">    &gt;&gt;&gt; end = (1, 2)</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a><span class="sd">    &gt;&gt;&gt; points = get_line_points(start, end)</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a><span class="sd">    &gt;&gt;&gt; print(points)</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a><span class="sd">    [[0 0]</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a><span class="sd">    [0 1]</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a><span class="sd">    [1 2]]</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>    <span class="n">y0</span><span class="p">,</span> <span class="n">x0</span> <span class="o">=</span> <span class="n">start</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>    <span class="n">y1</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">end</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>    <span class="c1"># Calculate differences</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>    <span class="c1"># Determine step direction</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>    <span class="n">sx</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">x0</span> <span class="o">&lt;</span> <span class="n">x1</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>    <span class="n">sy</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">y0</span> <span class="o">&lt;</span> <span class="n">y1</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>    <span class="c1"># Initialize</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>    <span class="n">err</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">-</span> <span class="n">dy</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>    <span class="n">points</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>        <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">])</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>        <span class="c1"># Check if we&#39;ve reached the end</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>        <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">x1</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">==</span> <span class="n">y1</span><span class="p">:</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>            <span class="k">break</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>        <span class="c1"># Calculate error for next step</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>        <span class="n">e2</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">err</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>        <span class="k">if</span> <span class="n">e2</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">dy</span><span class="p">:</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>            <span class="n">err</span> <span class="o">-=</span> <span class="n">dy</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>            <span class="n">x</span> <span class="o">+=</span> <span class="n">sx</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>        <span class="k">if</span> <span class="n">e2</span> <span class="o">&lt;</span> <span class="n">dx</span><span class="p">:</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>            <span class="n">err</span> <span class="o">+=</span> <span class="n">dx</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>            <span class="n">y</span> <span class="o">+=</span> <span class="n">sy</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellects.image_analysis.morphological_operations.get_min_or_max_euclidean_pair" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_min_or_max_euclidean_pair</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">min_or_max</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Find the pair of points in a given set with the minimum or maximum Euclidean distance.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>coords</code>
            </td>
            <td>
                  <code><span title="Union">Union</span>[<span title="numpy.ndarray">ndarray</span>, <span title="typing.Tuple">Tuple</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An Nx2 numpy array or a tuple of two arrays, each containing the x and y coordinates of points.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_or_max</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to find the 'min' or 'max' distance pair. Default is 'max'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;max&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing the coordinates of the two points that form the minimum or maximum distance pair.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>min_or_max</code> is not 'min' or 'max'.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <ul>
<li>The function first computes all pairwise distances in condensed form using <code>pdist</code>.</li>
<li>Then, it finds the index of the minimum or maximum distance.</li>
<li>Finally, it maps this index to the actual point indices using a binary search method.</li>
</ul>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">point1</span><span class="p">,</span> <span class="n">point2</span> <span class="o">=</span> <span class="n">get_min_or_max_euclidean_pair</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">min_or_max</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">point1</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go">[0 1]</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">point2</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">[4 5]</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">coords</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]))</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">point1</span><span class="p">,</span> <span class="n">point2</span> <span class="o">=</span> <span class="n">get_min_or_max_euclidean_pair</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">min_or_max</span><span class="o">=</span><span class="s2">&quot;min&quot;</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">point1</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="go">[0 0]</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">point2</span><span class="p">)</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="go">[1 0]</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-937"> 937</a></span>
<span class="normal"><a href="#__codelineno-0-938"> 938</a></span>
<span class="normal"><a href="#__codelineno-0-939"> 939</a></span>
<span class="normal"><a href="#__codelineno-0-940"> 940</a></span>
<span class="normal"><a href="#__codelineno-0-941"> 941</a></span>
<span class="normal"><a href="#__codelineno-0-942"> 942</a></span>
<span class="normal"><a href="#__codelineno-0-943"> 943</a></span>
<span class="normal"><a href="#__codelineno-0-944"> 944</a></span>
<span class="normal"><a href="#__codelineno-0-945"> 945</a></span>
<span class="normal"><a href="#__codelineno-0-946"> 946</a></span>
<span class="normal"><a href="#__codelineno-0-947"> 947</a></span>
<span class="normal"><a href="#__codelineno-0-948"> 948</a></span>
<span class="normal"><a href="#__codelineno-0-949"> 949</a></span>
<span class="normal"><a href="#__codelineno-0-950"> 950</a></span>
<span class="normal"><a href="#__codelineno-0-951"> 951</a></span>
<span class="normal"><a href="#__codelineno-0-952"> 952</a></span>
<span class="normal"><a href="#__codelineno-0-953"> 953</a></span>
<span class="normal"><a href="#__codelineno-0-954"> 954</a></span>
<span class="normal"><a href="#__codelineno-0-955"> 955</a></span>
<span class="normal"><a href="#__codelineno-0-956"> 956</a></span>
<span class="normal"><a href="#__codelineno-0-957"> 957</a></span>
<span class="normal"><a href="#__codelineno-0-958"> 958</a></span>
<span class="normal"><a href="#__codelineno-0-959"> 959</a></span>
<span class="normal"><a href="#__codelineno-0-960"> 960</a></span>
<span class="normal"><a href="#__codelineno-0-961"> 961</a></span>
<span class="normal"><a href="#__codelineno-0-962"> 962</a></span>
<span class="normal"><a href="#__codelineno-0-963"> 963</a></span>
<span class="normal"><a href="#__codelineno-0-964"> 964</a></span>
<span class="normal"><a href="#__codelineno-0-965"> 965</a></span>
<span class="normal"><a href="#__codelineno-0-966"> 966</a></span>
<span class="normal"><a href="#__codelineno-0-967"> 967</a></span>
<span class="normal"><a href="#__codelineno-0-968"> 968</a></span>
<span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_min_or_max_euclidean_pair</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">min_or_max</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a><span class="sd">    Find the pair of points in a given set with the minimum or maximum Euclidean distance.</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a><span class="sd">    coords : Union[np.ndarray, Tuple]</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a><span class="sd">        An Nx2 numpy array or a tuple of two arrays, each containing the x and y coordinates of points.</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a><span class="sd">    min_or_max : str, optional</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a><span class="sd">        Whether to find the &#39;min&#39; or &#39;max&#39; distance pair. Default is &#39;max&#39;.</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a><span class="sd">    -------</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a><span class="sd">    Tuple[np.ndarray, np.ndarray]</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a><span class="sd">        A tuple containing the coordinates of the two points that form the minimum or maximum distance pair.</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a><span class="sd">    Raises</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a><span class="sd">    ------</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a><span class="sd">    ValueError</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a><span class="sd">        If `min_or_max` is not &#39;min&#39; or &#39;max&#39;.</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a><span class="sd">    Notes</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a><span class="sd">    -----</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a><span class="sd">    - The function first computes all pairwise distances in condensed form using `pdist`.</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a><span class="sd">    - Then, it finds the index of the minimum or maximum distance.</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a><span class="sd">    - Finally, it maps this index to the actual point indices using a binary search method.</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a><span class="sd">    --------</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a><span class="sd">    &gt;&gt;&gt; coords = np.array([[0, 1], [2, 3], [4, 5]])</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a><span class="sd">    &gt;&gt;&gt; point1, point2 = get_min_or_max_euclidean_pair(coords, min_or_max=&quot;max&quot;)</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a><span class="sd">    &gt;&gt;&gt; print(point1)</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a><span class="sd">    [0 1]</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a><span class="sd">    &gt;&gt;&gt; print(point2)</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a><span class="sd">    [4 5]</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a><span class="sd">    &gt;&gt;&gt; coords = (np.array([0, 2, 4, 8, 1, 5]), np.array([0, 2, 4, 8, 0, 5]))</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a><span class="sd">    &gt;&gt;&gt; point1, point2 = get_min_or_max_euclidean_pair(coords, min_or_max=&quot;min&quot;)</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a><span class="sd">    &gt;&gt;&gt; print(point1)</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a><span class="sd">    [0 0]</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a><span class="sd">    &gt;&gt;&gt; print(point2)</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a><span class="sd">    [1 0]</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">):</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a>        <span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a>    <span class="n">N</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a>    <span class="k">if</span> <span class="n">N</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a>        <span class="k">return</span> <span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">N</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="kc">None</span>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a>    <span class="c1"># Step 1: Compute all pairwise distances in condensed form</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a>    <span class="n">distances</span> <span class="o">=</span> <span class="n">pdist</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a>    <span class="c1"># Step 2: Find the index of the maximum distance</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a>    <span class="k">if</span> <span class="n">min_or_max</span> <span class="o">==</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a>        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">distances</span><span class="p">)</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a>    <span class="k">elif</span> <span class="n">min_or_max</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a>        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">distances</span><span class="p">)</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a>        <span class="k">raise</span> <span class="ne">ValueError</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a>    <span class="c1"># Step 3: Map this index to (i, j) using a binary search method</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_pair_index</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a>        <span class="n">low</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">N</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>        <span class="k">while</span> <span class="n">low</span> <span class="o">&lt;</span> <span class="n">high</span><span class="p">:</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>            <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>            <span class="n">total</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">N</span> <span class="o">-</span> <span class="n">mid</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>            <span class="k">if</span> <span class="n">total</span> <span class="o">&lt;=</span> <span class="n">k</span><span class="p">:</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>                <span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a>                <span class="n">high</span> <span class="o">=</span> <span class="n">mid</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>        <span class="n">i</span> <span class="o">=</span> <span class="n">low</span> <span class="o">-</span> <span class="mi">1</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>        <span class="n">prev_sum</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">N</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a>        <span class="n">j_index_in_row</span> <span class="o">=</span> <span class="n">k</span> <span class="o">-</span> <span class="n">prev_sum</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>        <span class="k">return</span> <span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j_index_in_row</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># Ensure j &gt; i</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a>    <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">get_pair_index</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>    <span class="k">return</span> <span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellects.image_analysis.morphological_operations.get_minimal_distance_between_2_shapes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_minimal_distance_between_2_shapes</span><span class="p">(</span><span class="n">image_of_2_shapes</span><span class="p">,</span> <span class="n">increase_speed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Get the minimal distance between two shapes in an image.</p>
<p>This function calculates the minimal Euclidean distance between
two different shapes represented by binary values 1 and 2 in a given image.
It can optionally reduce the image size for faster processing.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>image_of_2_shapes</code>
            </td>
            <td>
                  <code>ndarray of int8</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Binary image containing two shapes to measure distance between.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>increase_speed</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag to reduce image size for faster computation. Default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>min_distance</code></td>            <td>
                  <code><span title="float64">float64</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The minimal Euclidean distance between the two shapes.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">distance</span> <span class="o">=</span> <span class="n">get_minimal_distance_between_2_shapes</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">expected output</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-901">901</a></span>
<span class="normal"><a href="#__codelineno-0-902">902</a></span>
<span class="normal"><a href="#__codelineno-0-903">903</a></span>
<span class="normal"><a href="#__codelineno-0-904">904</a></span>
<span class="normal"><a href="#__codelineno-0-905">905</a></span>
<span class="normal"><a href="#__codelineno-0-906">906</a></span>
<span class="normal"><a href="#__codelineno-0-907">907</a></span>
<span class="normal"><a href="#__codelineno-0-908">908</a></span>
<span class="normal"><a href="#__codelineno-0-909">909</a></span>
<span class="normal"><a href="#__codelineno-0-910">910</a></span>
<span class="normal"><a href="#__codelineno-0-911">911</a></span>
<span class="normal"><a href="#__codelineno-0-912">912</a></span>
<span class="normal"><a href="#__codelineno-0-913">913</a></span>
<span class="normal"><a href="#__codelineno-0-914">914</a></span>
<span class="normal"><a href="#__codelineno-0-915">915</a></span>
<span class="normal"><a href="#__codelineno-0-916">916</a></span>
<span class="normal"><a href="#__codelineno-0-917">917</a></span>
<span class="normal"><a href="#__codelineno-0-918">918</a></span>
<span class="normal"><a href="#__codelineno-0-919">919</a></span>
<span class="normal"><a href="#__codelineno-0-920">920</a></span>
<span class="normal"><a href="#__codelineno-0-921">921</a></span>
<span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span>
<span class="normal"><a href="#__codelineno-0-925">925</a></span>
<span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span>
<span class="normal"><a href="#__codelineno-0-929">929</a></span>
<span class="normal"><a href="#__codelineno-0-930">930</a></span>
<span class="normal"><a href="#__codelineno-0-931">931</a></span>
<span class="normal"><a href="#__codelineno-0-932">932</a></span>
<span class="normal"><a href="#__codelineno-0-933">933</a></span>
<span class="normal"><a href="#__codelineno-0-934">934</a></span>
<span class="normal"><a href="#__codelineno-0-935">935</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-901" name="__codelineno-0-901"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_minimal_distance_between_2_shapes</span><span class="p">(</span><span class="n">image_of_2_shapes</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">],</span> <span class="n">increase_speed</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a><span class="sd">    Get the minimal distance between two shapes in an image.</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a><span class="sd">    This function calculates the minimal Euclidean distance between</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a><span class="sd">    two different shapes represented by binary values 1 and 2 in a given image.</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a><span class="sd">    It can optionally reduce the image size for faster processing.</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a><span class="sd">    image_of_2_shapes : ndarray of int8</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a><span class="sd">        Binary image containing two shapes to measure distance between.</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a><span class="sd">    increase_speed : bool, optional</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a><span class="sd">        Flag to reduce image size for faster computation. Default is True.</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a><span class="sd">    -------</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a><span class="sd">    min_distance : float64</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a><span class="sd">        The minimal Euclidean distance between the two shapes.</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a><span class="sd">    --------</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">    &gt;&gt;&gt; image = np.array([[1, 0], [0, 2]])</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a><span class="sd">    &gt;&gt;&gt; distance = get_minimal_distance_between_2_shapes(image)</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="sd">    &gt;&gt;&gt; print(distance)</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a><span class="sd">    expected output</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a>    <span class="k">if</span> <span class="n">increase_speed</span><span class="p">:</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a>        <span class="n">shape1_idx</span><span class="p">,</span> <span class="n">shape2_idx</span> <span class="o">=</span> <span class="n">reduce_image_size_for_speed</span><span class="p">(</span><span class="n">image_of_2_shapes</span><span class="p">)</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a>        <span class="n">shape1_idx</span><span class="p">,</span> <span class="n">shape2_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">image_of_2_shapes</span> <span class="o">==</span> <span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">image_of_2_shapes</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a>    <span class="n">t</span> <span class="o">=</span> <span class="n">KDTree</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">shape1_idx</span><span class="p">))</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a>    <span class="n">dists</span><span class="p">,</span> <span class="n">nns</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">shape2_idx</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">dists</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellects.image_analysis.morphological_operations.get_quick_bounding_boxes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_quick_bounding_boxes</span><span class="p">(</span><span class="n">binary_image</span><span class="p">,</span> <span class="n">ordered_image</span><span class="p">,</span> <span class="n">ordered_stats</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Compute bounding boxes for shapes in a binary image.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>binary_image</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.uint8">uint8</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 2D array representing the binary image.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ordered_image</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An array containing the ordered image data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ordered_stats</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 2D array with statistics about the shapes in the image.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="numpy.typing.NDArray">NDArray</span>, <span title="numpy.typing.NDArray">NDArray</span>, <span title="numpy.typing.NDArray">NDArray</span>, <span title="numpy.typing.NDArray">NDArray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing four arrays:
- top: Array of y-coordinates for the top edge of bounding boxes.
- bot: Array of y-coordinates for the bottom edge of bounding boxes.
- left: Array of x-coordinates for the left edge of bounding boxes.
- right: Array of x-coordinates for the right edge of bounding boxes.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">binary_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">ordered_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">ordered_stats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">top</span><span class="p">,</span> <span class="n">bot</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">get_quick_bounding_boxes</span><span class="p">(</span><span class="n">binary_image</span><span class="p">,</span> <span class="n">ordered_image</span><span class="p">,</span> <span class="n">ordered_stats</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">top</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">[-1  1]</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bot</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go">[2 4]</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">left</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="go">[0 -1]</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="go">[3 2]</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1553">1553</a></span>
<span class="normal"><a href="#__codelineno-0-1554">1554</a></span>
<span class="normal"><a href="#__codelineno-0-1555">1555</a></span>
<span class="normal"><a href="#__codelineno-0-1556">1556</a></span>
<span class="normal"><a href="#__codelineno-0-1557">1557</a></span>
<span class="normal"><a href="#__codelineno-0-1558">1558</a></span>
<span class="normal"><a href="#__codelineno-0-1559">1559</a></span>
<span class="normal"><a href="#__codelineno-0-1560">1560</a></span>
<span class="normal"><a href="#__codelineno-0-1561">1561</a></span>
<span class="normal"><a href="#__codelineno-0-1562">1562</a></span>
<span class="normal"><a href="#__codelineno-0-1563">1563</a></span>
<span class="normal"><a href="#__codelineno-0-1564">1564</a></span>
<span class="normal"><a href="#__codelineno-0-1565">1565</a></span>
<span class="normal"><a href="#__codelineno-0-1566">1566</a></span>
<span class="normal"><a href="#__codelineno-0-1567">1567</a></span>
<span class="normal"><a href="#__codelineno-0-1568">1568</a></span>
<span class="normal"><a href="#__codelineno-0-1569">1569</a></span>
<span class="normal"><a href="#__codelineno-0-1570">1570</a></span>
<span class="normal"><a href="#__codelineno-0-1571">1571</a></span>
<span class="normal"><a href="#__codelineno-0-1572">1572</a></span>
<span class="normal"><a href="#__codelineno-0-1573">1573</a></span>
<span class="normal"><a href="#__codelineno-0-1574">1574</a></span>
<span class="normal"><a href="#__codelineno-0-1575">1575</a></span>
<span class="normal"><a href="#__codelineno-0-1576">1576</a></span>
<span class="normal"><a href="#__codelineno-0-1577">1577</a></span>
<span class="normal"><a href="#__codelineno-0-1578">1578</a></span>
<span class="normal"><a href="#__codelineno-0-1579">1579</a></span>
<span class="normal"><a href="#__codelineno-0-1580">1580</a></span>
<span class="normal"><a href="#__codelineno-0-1581">1581</a></span>
<span class="normal"><a href="#__codelineno-0-1582">1582</a></span>
<span class="normal"><a href="#__codelineno-0-1583">1583</a></span>
<span class="normal"><a href="#__codelineno-0-1584">1584</a></span>
<span class="normal"><a href="#__codelineno-0-1585">1585</a></span>
<span class="normal"><a href="#__codelineno-0-1586">1586</a></span>
<span class="normal"><a href="#__codelineno-0-1587">1587</a></span>
<span class="normal"><a href="#__codelineno-0-1588">1588</a></span>
<span class="normal"><a href="#__codelineno-0-1589">1589</a></span>
<span class="normal"><a href="#__codelineno-0-1590">1590</a></span>
<span class="normal"><a href="#__codelineno-0-1591">1591</a></span>
<span class="normal"><a href="#__codelineno-0-1592">1592</a></span>
<span class="normal"><a href="#__codelineno-0-1593">1593</a></span>
<span class="normal"><a href="#__codelineno-0-1594">1594</a></span>
<span class="normal"><a href="#__codelineno-0-1595">1595</a></span>
<span class="normal"><a href="#__codelineno-0-1596">1596</a></span>
<span class="normal"><a href="#__codelineno-0-1597">1597</a></span>
<span class="normal"><a href="#__codelineno-0-1598">1598</a></span>
<span class="normal"><a href="#__codelineno-0-1599">1599</a></span>
<span class="normal"><a href="#__codelineno-0-1600">1600</a></span>
<span class="normal"><a href="#__codelineno-0-1601">1601</a></span>
<span class="normal"><a href="#__codelineno-0-1602">1602</a></span>
<span class="normal"><a href="#__codelineno-0-1603">1603</a></span>
<span class="normal"><a href="#__codelineno-0-1604">1604</a></span>
<span class="normal"><a href="#__codelineno-0-1605">1605</a></span>
<span class="normal"><a href="#__codelineno-0-1606">1606</a></span>
<span class="normal"><a href="#__codelineno-0-1607">1607</a></span>
<span class="normal"><a href="#__codelineno-0-1608">1608</a></span>
<span class="normal"><a href="#__codelineno-0-1609">1609</a></span>
<span class="normal"><a href="#__codelineno-0-1610">1610</a></span>
<span class="normal"><a href="#__codelineno-0-1611">1611</a></span>
<span class="normal"><a href="#__codelineno-0-1612">1612</a></span>
<span class="normal"><a href="#__codelineno-0-1613">1613</a></span>
<span class="normal"><a href="#__codelineno-0-1614">1614</a></span>
<span class="normal"><a href="#__codelineno-0-1615">1615</a></span>
<span class="normal"><a href="#__codelineno-0-1616">1616</a></span>
<span class="normal"><a href="#__codelineno-0-1617">1617</a></span>
<span class="normal"><a href="#__codelineno-0-1618">1618</a></span>
<span class="normal"><a href="#__codelineno-0-1619">1619</a></span>
<span class="normal"><a href="#__codelineno-0-1620">1620</a></span>
<span class="normal"><a href="#__codelineno-0-1621">1621</a></span>
<span class="normal"><a href="#__codelineno-0-1622">1622</a></span>
<span class="normal"><a href="#__codelineno-0-1623">1623</a></span>
<span class="normal"><a href="#__codelineno-0-1624">1624</a></span>
<span class="normal"><a href="#__codelineno-0-1625">1625</a></span>
<span class="normal"><a href="#__codelineno-0-1626">1626</a></span>
<span class="normal"><a href="#__codelineno-0-1627">1627</a></span>
<span class="normal"><a href="#__codelineno-0-1628">1628</a></span>
<span class="normal"><a href="#__codelineno-0-1629">1629</a></span>
<span class="normal"><a href="#__codelineno-0-1630">1630</a></span>
<span class="normal"><a href="#__codelineno-0-1631">1631</a></span>
<span class="normal"><a href="#__codelineno-0-1632">1632</a></span>
<span class="normal"><a href="#__codelineno-0-1633">1633</a></span>
<span class="normal"><a href="#__codelineno-0-1634">1634</a></span>
<span class="normal"><a href="#__codelineno-0-1635">1635</a></span>
<span class="normal"><a href="#__codelineno-0-1636">1636</a></span>
<span class="normal"><a href="#__codelineno-0-1637">1637</a></span>
<span class="normal"><a href="#__codelineno-0-1638">1638</a></span>
<span class="normal"><a href="#__codelineno-0-1639">1639</a></span>
<span class="normal"><a href="#__codelineno-0-1640">1640</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1553" name="__codelineno-0-1553"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_quick_bounding_boxes</span><span class="p">(</span><span class="n">binary_image</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">],</span> <span class="n">ordered_image</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">ordered_stats</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">]:</span>
<a id="__codelineno-0-1554" name="__codelineno-0-1554"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1555" name="__codelineno-0-1555"></a><span class="sd">    Compute bounding boxes for shapes in a binary image.</span>
<a id="__codelineno-0-1556" name="__codelineno-0-1556"></a>
<a id="__codelineno-0-1557" name="__codelineno-0-1557"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-1558" name="__codelineno-0-1558"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-1559" name="__codelineno-0-1559"></a><span class="sd">    binary_image : NDArray[np.uint8]</span>
<a id="__codelineno-0-1560" name="__codelineno-0-1560"></a><span class="sd">        A 2D array representing the binary image.</span>
<a id="__codelineno-0-1561" name="__codelineno-0-1561"></a><span class="sd">    ordered_image : NDArray</span>
<a id="__codelineno-0-1562" name="__codelineno-0-1562"></a><span class="sd">        An array containing the ordered image data.</span>
<a id="__codelineno-0-1563" name="__codelineno-0-1563"></a><span class="sd">    ordered_stats : NDArray</span>
<a id="__codelineno-0-1564" name="__codelineno-0-1564"></a><span class="sd">        A 2D array with statistics about the shapes in the image.</span>
<a id="__codelineno-0-1565" name="__codelineno-0-1565"></a>
<a id="__codelineno-0-1566" name="__codelineno-0-1566"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-1567" name="__codelineno-0-1567"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1568" name="__codelineno-0-1568"></a><span class="sd">    Tuple[NDArray, NDArray, NDArray, NDArray]</span>
<a id="__codelineno-0-1569" name="__codelineno-0-1569"></a><span class="sd">        A tuple containing four arrays:</span>
<a id="__codelineno-0-1570" name="__codelineno-0-1570"></a><span class="sd">        - top: Array of y-coordinates for the top edge of bounding boxes.</span>
<a id="__codelineno-0-1571" name="__codelineno-0-1571"></a><span class="sd">        - bot: Array of y-coordinates for the bottom edge of bounding boxes.</span>
<a id="__codelineno-0-1572" name="__codelineno-0-1572"></a><span class="sd">        - left: Array of x-coordinates for the left edge of bounding boxes.</span>
<a id="__codelineno-0-1573" name="__codelineno-0-1573"></a><span class="sd">        - right: Array of x-coordinates for the right edge of bounding boxes.</span>
<a id="__codelineno-0-1574" name="__codelineno-0-1574"></a>
<a id="__codelineno-0-1575" name="__codelineno-0-1575"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-1576" name="__codelineno-0-1576"></a><span class="sd">    --------</span>
<a id="__codelineno-0-1577" name="__codelineno-0-1577"></a><span class="sd">    &gt;&gt;&gt; binary_image = np.array([[0, 1], [0, 0], [1, 0]], dtype=np.uint8)</span>
<a id="__codelineno-0-1578" name="__codelineno-0-1578"></a><span class="sd">    &gt;&gt;&gt; ordered_image = np.array([[0, 1], [0, 0], [2, 0]], dtype=np.uint8)</span>
<a id="__codelineno-0-1579" name="__codelineno-0-1579"></a><span class="sd">    &gt;&gt;&gt; ordered_stats = np.array([[1, 0, 1, 1, 1], [0, 2, 1, 1, 1]], dtype=np.int32)</span>
<a id="__codelineno-0-1580" name="__codelineno-0-1580"></a><span class="sd">    &gt;&gt;&gt; top, bot, left, right = get_quick_bounding_boxes(binary_image, ordered_image, ordered_stats)</span>
<a id="__codelineno-0-1581" name="__codelineno-0-1581"></a><span class="sd">    &gt;&gt;&gt; print(top)</span>
<a id="__codelineno-0-1582" name="__codelineno-0-1582"></a><span class="sd">    [-1  1]</span>
<a id="__codelineno-0-1583" name="__codelineno-0-1583"></a><span class="sd">    &gt;&gt;&gt; print(bot)</span>
<a id="__codelineno-0-1584" name="__codelineno-0-1584"></a><span class="sd">    [2 4]</span>
<a id="__codelineno-0-1585" name="__codelineno-0-1585"></a><span class="sd">    &gt;&gt;&gt; print(left)</span>
<a id="__codelineno-0-1586" name="__codelineno-0-1586"></a><span class="sd">    [0 -1]</span>
<a id="__codelineno-0-1587" name="__codelineno-0-1587"></a><span class="sd">    &gt;&gt;&gt; print(right)</span>
<a id="__codelineno-0-1588" name="__codelineno-0-1588"></a><span class="sd">    [3 2]</span>
<a id="__codelineno-0-1589" name="__codelineno-0-1589"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1590" name="__codelineno-0-1590"></a>    <span class="n">shapes</span> <span class="o">=</span> <span class="n">get_contours</span><span class="p">(</span><span class="n">binary_image</span><span class="p">)</span>
<a id="__codelineno-0-1591" name="__codelineno-0-1591"></a>    <span class="n">x_min</span> <span class="o">=</span> <span class="n">ordered_stats</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1592" name="__codelineno-0-1592"></a>    <span class="n">y_min</span> <span class="o">=</span> <span class="n">ordered_stats</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-1593" name="__codelineno-0-1593"></a>    <span class="n">x_max</span> <span class="o">=</span> <span class="n">ordered_stats</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">ordered_stats</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-1594" name="__codelineno-0-1594"></a>    <span class="n">y_max</span> <span class="o">=</span> <span class="n">ordered_stats</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">ordered_stats</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span>
<a id="__codelineno-0-1595" name="__codelineno-0-1595"></a>    <span class="n">x_min_dist</span> <span class="o">=</span> <span class="n">shapes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-1596" name="__codelineno-0-1596"></a>    <span class="n">y_min_dist</span> <span class="o">=</span> <span class="n">shapes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1597" name="__codelineno-0-1597"></a>
<a id="__codelineno-0-1598" name="__codelineno-0-1598"></a>    <span class="n">shapes</span> <span class="o">*=</span> <span class="n">ordered_image</span>
<a id="__codelineno-0-1599" name="__codelineno-0-1599"></a>    <span class="n">shape_nb</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">shapes</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-1600" name="__codelineno-0-1600"></a>    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-1601" name="__codelineno-0-1601"></a>    <span class="n">a_indices</span><span class="p">,</span> <span class="n">b_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu_indices</span><span class="p">(</span><span class="n">shape_nb</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-1602" name="__codelineno-0-1602"></a>    <span class="n">a_indices</span><span class="p">,</span> <span class="n">b_indices</span> <span class="o">=</span> <span class="n">a_indices</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">b_indices</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-1603" name="__codelineno-0-1603"></a>    <span class="n">all_distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">a_indices</span><span class="p">),</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<a id="__codelineno-0-1604" name="__codelineno-0-1604"></a>    <span class="c1"># For every pair of components, find the minimal distance</span>
<a id="__codelineno-0-1605" name="__codelineno-0-1605"></a>    <span class="k">for</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a_indices</span><span class="p">,</span> <span class="n">b_indices</span><span class="p">):</span>
<a id="__codelineno-0-1606" name="__codelineno-0-1606"></a>        <span class="n">x_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">x_max</span><span class="p">[</span><span class="n">a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_min</span><span class="p">[</span><span class="n">b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-1607" name="__codelineno-0-1607"></a>        <span class="n">y_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">y_max</span><span class="p">[</span><span class="n">a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_min</span><span class="p">[</span><span class="n">b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-1608" name="__codelineno-0-1608"></a>        <span class="k">if</span> <span class="n">x_dist</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x_min_dist</span> <span class="ow">and</span> <span class="n">y_dist</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">y_min_dist</span><span class="p">:</span>
<a id="__codelineno-0-1609" name="__codelineno-0-1609"></a>            <span class="n">sub_shapes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">shapes</span> <span class="o">==</span> <span class="n">a</span><span class="p">,</span> <span class="n">shapes</span> <span class="o">==</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">shapes</span>
<a id="__codelineno-0-1610" name="__codelineno-0-1610"></a>            <span class="n">sub_shapes</span> <span class="o">=</span> <span class="n">sub_shapes</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">((</span><span class="n">y_min</span><span class="p">[</span><span class="n">a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">y_min</span><span class="p">[</span><span class="n">b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])):</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">((</span><span class="n">y_max</span><span class="p">[</span><span class="n">a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">y_max</span><span class="p">[</span><span class="n">b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])),</span>
<a id="__codelineno-0-1611" name="__codelineno-0-1611"></a>                         <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">((</span><span class="n">x_min</span><span class="p">[</span><span class="n">a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">x_min</span><span class="p">[</span><span class="n">b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])):</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">((</span><span class="n">x_max</span><span class="p">[</span><span class="n">a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">x_max</span><span class="p">[</span><span class="n">b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]))]</span>
<a id="__codelineno-0-1612" name="__codelineno-0-1612"></a>            <span class="n">sub_shapes</span><span class="p">[</span><span class="n">sub_shapes</span> <span class="o">==</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-1613" name="__codelineno-0-1613"></a>            <span class="n">sub_shapes</span><span class="p">[</span><span class="n">sub_shapes</span> <span class="o">==</span> <span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<a id="__codelineno-0-1614" name="__codelineno-0-1614"></a>            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">sub_shapes</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">sub_shapes</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
<a id="__codelineno-0-1615" name="__codelineno-0-1615"></a>                <span class="n">all_distances</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">get_minimal_distance_between_2_shapes</span><span class="p">(</span><span class="n">sub_shapes</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-1616" name="__codelineno-0-1616"></a>
<a id="__codelineno-0-1617" name="__codelineno-0-1617"></a>                <span class="k">if</span> <span class="n">x_dist</span> <span class="o">&gt;</span> <span class="n">y_dist</span><span class="p">:</span>
<a id="__codelineno-0-1618" name="__codelineno-0-1618"></a>                    <span class="n">x_min_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">((</span><span class="n">x_min_dist</span><span class="p">,</span> <span class="n">x_dist</span><span class="p">))</span>
<a id="__codelineno-0-1619" name="__codelineno-0-1619"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1620" name="__codelineno-0-1620"></a>                    <span class="n">y_min_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">((</span><span class="n">y_min_dist</span><span class="p">,</span> <span class="n">y_dist</span><span class="p">))</span>
<a id="__codelineno-0-1621" name="__codelineno-0-1621"></a>                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-1622" name="__codelineno-0-1622"></a>    <span class="n">shape_number</span> <span class="o">=</span> <span class="n">ordered_stats</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1623" name="__codelineno-0-1623"></a>    <span class="n">top</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape_number</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<a id="__codelineno-0-1624" name="__codelineno-0-1624"></a>    <span class="n">bot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">binary_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">shape_number</span><span class="p">)</span>
<a id="__codelineno-0-1625" name="__codelineno-0-1625"></a>    <span class="n">left</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape_number</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<a id="__codelineno-0-1626" name="__codelineno-0-1626"></a>    <span class="n">right</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">binary_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">shape_number</span><span class="p">)</span>
<a id="__codelineno-0-1627" name="__codelineno-0-1627"></a>    <span class="k">for</span> <span class="n">shape_i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">shape_nb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-1628" name="__codelineno-0-1628"></a>        <span class="c1"># Get where the shape i appear in pairwise comparisons</span>
<a id="__codelineno-0-1629" name="__codelineno-0-1629"></a>        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">all_distances</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">shape_i</span><span class="p">,</span> <span class="n">all_distances</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">shape_i</span><span class="p">))</span>
<a id="__codelineno-0-1630" name="__codelineno-0-1630"></a>        <span class="c1"># Compute the minimal distance related to shape i and divide by 2</span>
<a id="__codelineno-0-1631" name="__codelineno-0-1631"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_distances</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1632" name="__codelineno-0-1632"></a>            <span class="n">dist</span> <span class="o">=</span> <span class="n">all_distances</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">//</span> <span class="mi">2</span>
<a id="__codelineno-0-1633" name="__codelineno-0-1633"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1634" name="__codelineno-0-1634"></a>            <span class="n">dist</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-1635" name="__codelineno-0-1635"></a>            <span class="c1"># Save the coordinates of the arena around shape i</span>
<a id="__codelineno-0-1636" name="__codelineno-0-1636"></a>        <span class="n">top</span><span class="p">[</span><span class="n">shape_i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_min</span><span class="p">[</span><span class="n">shape_i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dist</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<a id="__codelineno-0-1637" name="__codelineno-0-1637"></a>        <span class="n">bot</span><span class="p">[</span><span class="n">shape_i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_max</span><span class="p">[</span><span class="n">shape_i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dist</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<a id="__codelineno-0-1638" name="__codelineno-0-1638"></a>        <span class="n">left</span><span class="p">[</span><span class="n">shape_i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_min</span><span class="p">[</span><span class="n">shape_i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dist</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<a id="__codelineno-0-1639" name="__codelineno-0-1639"></a>        <span class="n">right</span><span class="p">[</span><span class="n">shape_i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_max</span><span class="p">[</span><span class="n">shape_i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dist</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<a id="__codelineno-0-1640" name="__codelineno-0-1640"></a>    <span class="k">return</span> <span class="n">top</span><span class="p">,</span> <span class="n">bot</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellects.image_analysis.morphological_operations.get_radius_distance_against_time" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_radius_distance_against_time</span><span class="p">(</span><span class="n">binary_video</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Calculate the radius distance against time from a binary video and field.</p>
<p>This function computes the change in radius distances over time
by analyzing a binary video and mapping it to corresponding field values.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>binary_video</code>
            </td>
            <td>
                  <code>ndarray of uint8</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Binary video data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>field</code>
            </td>
            <td>
                  <code><span title="ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Field values to analyze the radius distances against.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>distance_against_time</code></td>            <td>
                  <code>ndarray of float32</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Radius distances over time.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>time_start</code></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Starting time index where the radius distance measurement begins.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>time_end</code></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ending time index where the radius distance measurement ends.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">binary_video</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">distance_against_time</span><span class="p">,</span> <span class="n">time_start</span><span class="p">,</span> <span class="n">time_end</span> <span class="o">=</span> <span class="n">get_radius_distance_against_time</span><span class="p">(</span><span class="n">binary_video</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1310">1310</a></span>
<span class="normal"><a href="#__codelineno-0-1311">1311</a></span>
<span class="normal"><a href="#__codelineno-0-1312">1312</a></span>
<span class="normal"><a href="#__codelineno-0-1313">1313</a></span>
<span class="normal"><a href="#__codelineno-0-1314">1314</a></span>
<span class="normal"><a href="#__codelineno-0-1315">1315</a></span>
<span class="normal"><a href="#__codelineno-0-1316">1316</a></span>
<span class="normal"><a href="#__codelineno-0-1317">1317</a></span>
<span class="normal"><a href="#__codelineno-0-1318">1318</a></span>
<span class="normal"><a href="#__codelineno-0-1319">1319</a></span>
<span class="normal"><a href="#__codelineno-0-1320">1320</a></span>
<span class="normal"><a href="#__codelineno-0-1321">1321</a></span>
<span class="normal"><a href="#__codelineno-0-1322">1322</a></span>
<span class="normal"><a href="#__codelineno-0-1323">1323</a></span>
<span class="normal"><a href="#__codelineno-0-1324">1324</a></span>
<span class="normal"><a href="#__codelineno-0-1325">1325</a></span>
<span class="normal"><a href="#__codelineno-0-1326">1326</a></span>
<span class="normal"><a href="#__codelineno-0-1327">1327</a></span>
<span class="normal"><a href="#__codelineno-0-1328">1328</a></span>
<span class="normal"><a href="#__codelineno-0-1329">1329</a></span>
<span class="normal"><a href="#__codelineno-0-1330">1330</a></span>
<span class="normal"><a href="#__codelineno-0-1331">1331</a></span>
<span class="normal"><a href="#__codelineno-0-1332">1332</a></span>
<span class="normal"><a href="#__codelineno-0-1333">1333</a></span>
<span class="normal"><a href="#__codelineno-0-1334">1334</a></span>
<span class="normal"><a href="#__codelineno-0-1335">1335</a></span>
<span class="normal"><a href="#__codelineno-0-1336">1336</a></span>
<span class="normal"><a href="#__codelineno-0-1337">1337</a></span>
<span class="normal"><a href="#__codelineno-0-1338">1338</a></span>
<span class="normal"><a href="#__codelineno-0-1339">1339</a></span>
<span class="normal"><a href="#__codelineno-0-1340">1340</a></span>
<span class="normal"><a href="#__codelineno-0-1341">1341</a></span>
<span class="normal"><a href="#__codelineno-0-1342">1342</a></span>
<span class="normal"><a href="#__codelineno-0-1343">1343</a></span>
<span class="normal"><a href="#__codelineno-0-1344">1344</a></span>
<span class="normal"><a href="#__codelineno-0-1345">1345</a></span>
<span class="normal"><a href="#__codelineno-0-1346">1346</a></span>
<span class="normal"><a href="#__codelineno-0-1347">1347</a></span>
<span class="normal"><a href="#__codelineno-0-1348">1348</a></span>
<span class="normal"><a href="#__codelineno-0-1349">1349</a></span>
<span class="normal"><a href="#__codelineno-0-1350">1350</a></span>
<span class="normal"><a href="#__codelineno-0-1351">1351</a></span>
<span class="normal"><a href="#__codelineno-0-1352">1352</a></span>
<span class="normal"><a href="#__codelineno-0-1353">1353</a></span>
<span class="normal"><a href="#__codelineno-0-1354">1354</a></span>
<span class="normal"><a href="#__codelineno-0-1355">1355</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1310" name="__codelineno-0-1310"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_radius_distance_against_time</span><span class="p">(</span><span class="n">binary_video</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">],</span> <span class="n">field</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">],</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-1311" name="__codelineno-0-1311"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1312" name="__codelineno-0-1312"></a><span class="sd">    Calculate the radius distance against time from a binary video and field.</span>
<a id="__codelineno-0-1313" name="__codelineno-0-1313"></a>
<a id="__codelineno-0-1314" name="__codelineno-0-1314"></a><span class="sd">    This function computes the change in radius distances over time</span>
<a id="__codelineno-0-1315" name="__codelineno-0-1315"></a><span class="sd">    by analyzing a binary video and mapping it to corresponding field values.</span>
<a id="__codelineno-0-1316" name="__codelineno-0-1316"></a>
<a id="__codelineno-0-1317" name="__codelineno-0-1317"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-1318" name="__codelineno-0-1318"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-1319" name="__codelineno-0-1319"></a><span class="sd">    binary_video : ndarray of uint8</span>
<a id="__codelineno-0-1320" name="__codelineno-0-1320"></a><span class="sd">        Binary video data.</span>
<a id="__codelineno-0-1321" name="__codelineno-0-1321"></a><span class="sd">    field : ndarray</span>
<a id="__codelineno-0-1322" name="__codelineno-0-1322"></a><span class="sd">        Field values to analyze the radius distances against.</span>
<a id="__codelineno-0-1323" name="__codelineno-0-1323"></a>
<a id="__codelineno-0-1324" name="__codelineno-0-1324"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-1325" name="__codelineno-0-1325"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1326" name="__codelineno-0-1326"></a><span class="sd">    distance_against_time : ndarray of float32</span>
<a id="__codelineno-0-1327" name="__codelineno-0-1327"></a><span class="sd">        Radius distances over time.</span>
<a id="__codelineno-0-1328" name="__codelineno-0-1328"></a><span class="sd">    time_start : int</span>
<a id="__codelineno-0-1329" name="__codelineno-0-1329"></a><span class="sd">        Starting time index where the radius distance measurement begins.</span>
<a id="__codelineno-0-1330" name="__codelineno-0-1330"></a><span class="sd">    time_end : int</span>
<a id="__codelineno-0-1331" name="__codelineno-0-1331"></a><span class="sd">        Ending time index where the radius distance measurement ends.</span>
<a id="__codelineno-0-1332" name="__codelineno-0-1332"></a>
<a id="__codelineno-0-1333" name="__codelineno-0-1333"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-1334" name="__codelineno-0-1334"></a><span class="sd">    --------</span>
<a id="__codelineno-0-1335" name="__codelineno-0-1335"></a><span class="sd">    &gt;&gt;&gt; binary_video = np.ones((10, 5, 5), dtype=np.uint8)</span>
<a id="__codelineno-0-1336" name="__codelineno-0-1336"></a>
<a id="__codelineno-0-1337" name="__codelineno-0-1337"></a><span class="sd">    &gt;&gt;&gt; distance_against_time, time_start, time_end = get_radius_distance_against_time(binary_video, field)</span>
<a id="__codelineno-0-1338" name="__codelineno-0-1338"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1339" name="__codelineno-0-1339"></a>    <span class="n">pixel_start</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">field</span><span class="p">[</span><span class="n">field</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-1340" name="__codelineno-0-1340"></a>    <span class="n">pixel_end</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">field</span><span class="p">[</span><span class="n">field</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-1341" name="__codelineno-0-1341"></a>    <span class="n">time_span</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">binary_video</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-1342" name="__codelineno-0-1342"></a>    <span class="n">time_start</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-1343" name="__codelineno-0-1343"></a>    <span class="n">time_end</span> <span class="o">=</span> <span class="n">time_span</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-1344" name="__codelineno-0-1344"></a>    <span class="n">start_not_found</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1345" name="__codelineno-0-1345"></a>    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">time_span</span><span class="p">:</span>
<a id="__codelineno-0-1346" name="__codelineno-0-1346"></a>        <span class="k">if</span> <span class="n">start_not_found</span><span class="p">:</span>
<a id="__codelineno-0-1347" name="__codelineno-0-1347"></a>            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">((</span><span class="n">field</span> <span class="o">==</span> <span class="n">pixel_start</span><span class="p">)</span> <span class="o">*</span> <span class="n">binary_video</span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]):</span>
<a id="__codelineno-0-1348" name="__codelineno-0-1348"></a>                <span class="n">start_not_found</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-1349" name="__codelineno-0-1349"></a>                <span class="n">time_start</span> <span class="o">=</span> <span class="n">t</span>
<a id="__codelineno-0-1350" name="__codelineno-0-1350"></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">((</span><span class="n">field</span> <span class="o">==</span> <span class="n">pixel_end</span><span class="p">)</span> <span class="o">*</span> <span class="n">binary_video</span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]):</span>
<a id="__codelineno-0-1351" name="__codelineno-0-1351"></a>            <span class="n">time_end</span> <span class="o">=</span> <span class="n">t</span>
<a id="__codelineno-0-1352" name="__codelineno-0-1352"></a>            <span class="k">break</span>
<a id="__codelineno-0-1353" name="__codelineno-0-1353"></a>    <span class="n">distance_against_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">pixel_start</span><span class="p">,</span> <span class="n">pixel_end</span><span class="p">,</span> <span class="p">(</span><span class="n">time_end</span> <span class="o">-</span> <span class="n">time_start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-1354" name="__codelineno-0-1354"></a>    <span class="n">distance_against_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">distance_against_time</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<a id="__codelineno-0-1355" name="__codelineno-0-1355"></a>    <span class="k">return</span> <span class="n">distance_against_time</span><span class="p">,</span> <span class="n">time_start</span><span class="p">,</span> <span class="n">time_end</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellects.image_analysis.morphological_operations.image_borders" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">image_borders</span><span class="p">(</span><span class="n">dimensions</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="s1">&#39;rectangular&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create an image with borders, either rectangular or circular.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dimensions</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dimensions of the image (height, width).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shape</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The shape of the borders. Options are "rectangular" or "circular".
Defaults to "rectangular".</p>
              </div>
            </td>
            <td>
                  <code>&#39;rectangular&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>out</code></td>            <td>
                  <code>ndarray of uint8</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The image with borders. If the shape is "circular", an ellipse border;
if "rectangular", a rectangular border.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">borders</span> <span class="o">=</span> <span class="n">image_borders</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s2">&quot;rectangular&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">borders</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go">[[0 0 0]</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go"> [0 1 0]</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go"> [0 0 0]]</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span>
<span class="normal"><a href="#__codelineno-0-1289">1289</a></span>
<span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span>
<span class="normal"><a href="#__codelineno-0-1294">1294</a></span>
<span class="normal"><a href="#__codelineno-0-1295">1295</a></span>
<span class="normal"><a href="#__codelineno-0-1296">1296</a></span>
<span class="normal"><a href="#__codelineno-0-1297">1297</a></span>
<span class="normal"><a href="#__codelineno-0-1298">1298</a></span>
<span class="normal"><a href="#__codelineno-0-1299">1299</a></span>
<span class="normal"><a href="#__codelineno-0-1300">1300</a></span>
<span class="normal"><a href="#__codelineno-0-1301">1301</a></span>
<span class="normal"><a href="#__codelineno-0-1302">1302</a></span>
<span class="normal"><a href="#__codelineno-0-1303">1303</a></span>
<span class="normal"><a href="#__codelineno-0-1304">1304</a></span>
<span class="normal"><a href="#__codelineno-0-1305">1305</a></span>
<span class="normal"><a href="#__codelineno-0-1306">1306</a></span>
<span class="normal"><a href="#__codelineno-0-1307">1307</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1271" name="__codelineno-0-1271"></a><span class="k">def</span><span class="w"> </span><span class="nf">image_borders</span><span class="p">(</span><span class="n">dimensions</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">shape</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;rectangular&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">]:</span>
<a id="__codelineno-0-1272" name="__codelineno-0-1272"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1273" name="__codelineno-0-1273"></a><span class="sd">    Create an image with borders, either rectangular or circular.</span>
<a id="__codelineno-0-1274" name="__codelineno-0-1274"></a>
<a id="__codelineno-0-1275" name="__codelineno-0-1275"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-1276" name="__codelineno-0-1276"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-1277" name="__codelineno-0-1277"></a><span class="sd">    dimensions : tuple</span>
<a id="__codelineno-0-1278" name="__codelineno-0-1278"></a><span class="sd">        The dimensions of the image (height, width).</span>
<a id="__codelineno-0-1279" name="__codelineno-0-1279"></a><span class="sd">    shape : str, optional</span>
<a id="__codelineno-0-1280" name="__codelineno-0-1280"></a><span class="sd">        The shape of the borders. Options are &quot;rectangular&quot; or &quot;circular&quot;.</span>
<a id="__codelineno-0-1281" name="__codelineno-0-1281"></a><span class="sd">        Defaults to &quot;rectangular&quot;.</span>
<a id="__codelineno-0-1282" name="__codelineno-0-1282"></a>
<a id="__codelineno-0-1283" name="__codelineno-0-1283"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-1284" name="__codelineno-0-1284"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1285" name="__codelineno-0-1285"></a><span class="sd">    out : ndarray of uint8</span>
<a id="__codelineno-0-1286" name="__codelineno-0-1286"></a><span class="sd">        The image with borders. If the shape is &quot;circular&quot;, an ellipse border;</span>
<a id="__codelineno-0-1287" name="__codelineno-0-1287"></a><span class="sd">        if &quot;rectangular&quot;, a rectangular border.</span>
<a id="__codelineno-0-1288" name="__codelineno-0-1288"></a>
<a id="__codelineno-0-1289" name="__codelineno-0-1289"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-1290" name="__codelineno-0-1290"></a><span class="sd">    --------</span>
<a id="__codelineno-0-1291" name="__codelineno-0-1291"></a><span class="sd">    &gt;&gt;&gt; borders = image_borders((3, 3), &quot;rectangular&quot;)</span>
<a id="__codelineno-0-1292" name="__codelineno-0-1292"></a><span class="sd">    &gt;&gt;&gt; print(borders)</span>
<a id="__codelineno-0-1293" name="__codelineno-0-1293"></a><span class="sd">    [[0 0 0]</span>
<a id="__codelineno-0-1294" name="__codelineno-0-1294"></a><span class="sd">     [0 1 0]</span>
<a id="__codelineno-0-1295" name="__codelineno-0-1295"></a><span class="sd">     [0 0 0]]</span>
<a id="__codelineno-0-1296" name="__codelineno-0-1296"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1297" name="__codelineno-0-1297"></a>    <span class="k">if</span> <span class="n">shape</span> <span class="o">==</span> <span class="s2">&quot;circular&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1298" name="__codelineno-0-1298"></a>        <span class="n">borders</span> <span class="o">=</span> <span class="n">create_ellipse</span><span class="p">(</span><span class="n">dimensions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dimensions</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-1299" name="__codelineno-0-1299"></a>        <span class="n">img_contours</span> <span class="o">=</span> <span class="n">image_borders</span><span class="p">(</span><span class="n">dimensions</span><span class="p">)</span>
<a id="__codelineno-0-1300" name="__codelineno-0-1300"></a>        <span class="n">borders</span> <span class="o">=</span> <span class="n">borders</span> <span class="o">*</span> <span class="n">img_contours</span>
<a id="__codelineno-0-1301" name="__codelineno-0-1301"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1302" name="__codelineno-0-1302"></a>        <span class="n">borders</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">dimensions</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-1303" name="__codelineno-0-1303"></a>        <span class="n">borders</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-1304" name="__codelineno-0-1304"></a>        <span class="n">borders</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-1305" name="__codelineno-0-1305"></a>        <span class="n">borders</span><span class="p">[</span><span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-1306" name="__codelineno-0-1306"></a>        <span class="n">borders</span><span class="p">[:,</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-1307" name="__codelineno-0-1307"></a>    <span class="k">return</span> <span class="n">borders</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellects.image_analysis.morphological_operations.inverted_distance_transform" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">inverted_distance_transform</span><span class="p">(</span><span class="n">original_shape</span><span class="p">,</span> <span class="n">max_distance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">with_erosion</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Calculate the distance transform around ones in a binary image, with optional erosion.</p>
<p>This function computes the Euclidean distance transform where zero values
represent the background and ones represent the foreground. Optionally,
it erodes the input image before computing the distance transform, and
limits distances based on a maximum value.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>original_shape</code>
            </td>
            <td>
                  <code>ndarray of uint8</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input binary image where ones represent the foreground.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_distance</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum distance value to threshold. If None (default), no thresholding is applied.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_erosion</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of iterations for erosion. If 0 (default), no erosion is applied.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>out</code></td>            <td>
                  <code>ndarray of uint32</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Distance transform array where each element represents the distance
to the nearest zero value in the input image.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="see-also" open>
  <summary>See also</summary>
  <p>rounded_distance_transform : less precise (outputs int) and faster for small max_distance values.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">segmentation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">segmentation</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">gravity</span> <span class="o">=</span> <span class="n">inverted_distance_transform</span><span class="p">(</span><span class="n">segmentation</span><span class="p">,</span> <span class="n">max_distance</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">gravity</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">[[1.         1.41421356 1.41421356 1.        ]</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go"> [1.41421356 0.         0.         1.41421356]</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go"> [1.41421356 0.         0.         1.41421356]</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go"> [1.         1.41421356 1.41421356 1.        ]]</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-587" name="__codelineno-0-587"></a><span class="k">def</span><span class="w"> </span><span class="nf">inverted_distance_transform</span><span class="p">(</span><span class="n">original_shape</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">],</span> <span class="n">max_distance</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">with_erosion</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">]:</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a><span class="sd">    Calculate the distance transform around ones in a binary image, with optional erosion.</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a><span class="sd">    This function computes the Euclidean distance transform where zero values</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a><span class="sd">    represent the background and ones represent the foreground. Optionally,</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a><span class="sd">    it erodes the input image before computing the distance transform, and</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a><span class="sd">    limits distances based on a maximum value.</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a><span class="sd">    original_shape : ndarray of uint8</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a><span class="sd">        Input binary image where ones represent the foreground.</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a><span class="sd">    max_distance : int, optional</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a><span class="sd">        Maximum distance value to threshold. If None (default), no thresholding is applied.</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a><span class="sd">    with_erosion : int, optional</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a><span class="sd">        Number of iterations for erosion. If 0 (default), no erosion is applied.</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a><span class="sd">    -------</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a><span class="sd">    out : ndarray of uint32</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a><span class="sd">        Distance transform array where each element represents the distance</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a><span class="sd">        to the nearest zero value in the input image.</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a><span class="sd">    See also</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a><span class="sd">    --------</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a><span class="sd">    rounded_distance_transform : less precise (outputs int) and faster for small max_distance values.</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a><span class="sd">    --------</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a><span class="sd">    &gt;&gt;&gt; segmentation = np.zeros((4, 4), dtype=np.uint8)</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a><span class="sd">    &gt;&gt;&gt; segmentation[1:3, 1:3] = 1</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a><span class="sd">    &gt;&gt;&gt; gravity = inverted_distance_transform(segmentation, max_distance=2)</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a><span class="sd">    &gt;&gt;&gt; print(gravity)</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a><span class="sd">    [[1.         1.41421356 1.41421356 1.        ]</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a><span class="sd">     [1.41421356 0.         0.         1.41421356]</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a><span class="sd">     [1.41421356 0.         0.         1.41421356]</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a><span class="sd">     [1.         1.41421356 1.41421356 1.        ]]</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>    <span class="k">if</span> <span class="n">with_erosion</span><span class="p">:</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>        <span class="n">original_shape</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">erode</span><span class="p">(</span><span class="n">original_shape</span><span class="p">,</span> <span class="n">cross_33</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="n">with_erosion</span><span class="p">,</span> <span class="n">borderType</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">BORDER_CONSTANT</span><span class="p">,</span> <span class="n">borderValue</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>    <span class="n">gravity_field</span> <span class="o">=</span> <span class="n">distance_transform_edt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">original_shape</span><span class="p">)</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>    <span class="k">if</span> <span class="n">max_distance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>        <span class="k">if</span> <span class="n">max_distance</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">original_shape</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>            <span class="n">max_distance</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">original_shape</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">)</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>        <span class="n">gravity_field</span><span class="p">[</span><span class="n">gravity_field</span> <span class="o">&gt;=</span> <span class="n">max_distance</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>    <span class="n">gravity_field</span><span class="p">[</span><span class="n">gravity_field</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">gravity_field</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">gravity_field</span><span class="p">[</span><span class="n">gravity_field</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>    <span class="k">return</span> <span class="n">gravity_field</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellects.image_analysis.morphological_operations.keep_largest_shape" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">keep_largest_shape</span><span class="p">(</span><span class="n">indexed_shapes</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Keep the largest shape from an array of indexed shapes.</p>
<p>This function identifies the most frequent non-zero shape in the input
array and returns a binary mask where elements matching this shape are set to 1,
and others are set to 0. The function uses NumPy's bincount to count occurrences
of each shape and assumes that the first element (index 0) is not part of any
shape classification.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>indexed_shapes</code>
            </td>
            <td>
                  <code>ndarray of int32</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input array containing indexed shapes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>out</code></td>            <td>
                  <code>ndarray of uint8</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Binary mask where the largest shape is marked as 1.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">indexed_shapes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">keep_largest_shape</span><span class="p">(</span><span class="n">indexed_shapes</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go">array([0, 1, 1, 0, 0], dtype=uint8)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1980">1980</a></span>
<span class="normal"><a href="#__codelineno-0-1981">1981</a></span>
<span class="normal"><a href="#__codelineno-0-1982">1982</a></span>
<span class="normal"><a href="#__codelineno-0-1983">1983</a></span>
<span class="normal"><a href="#__codelineno-0-1984">1984</a></span>
<span class="normal"><a href="#__codelineno-0-1985">1985</a></span>
<span class="normal"><a href="#__codelineno-0-1986">1986</a></span>
<span class="normal"><a href="#__codelineno-0-1987">1987</a></span>
<span class="normal"><a href="#__codelineno-0-1988">1988</a></span>
<span class="normal"><a href="#__codelineno-0-1989">1989</a></span>
<span class="normal"><a href="#__codelineno-0-1990">1990</a></span>
<span class="normal"><a href="#__codelineno-0-1991">1991</a></span>
<span class="normal"><a href="#__codelineno-0-1992">1992</a></span>
<span class="normal"><a href="#__codelineno-0-1993">1993</a></span>
<span class="normal"><a href="#__codelineno-0-1994">1994</a></span>
<span class="normal"><a href="#__codelineno-0-1995">1995</a></span>
<span class="normal"><a href="#__codelineno-0-1996">1996</a></span>
<span class="normal"><a href="#__codelineno-0-1997">1997</a></span>
<span class="normal"><a href="#__codelineno-0-1998">1998</a></span>
<span class="normal"><a href="#__codelineno-0-1999">1999</a></span>
<span class="normal"><a href="#__codelineno-0-2000">2000</a></span>
<span class="normal"><a href="#__codelineno-0-2001">2001</a></span>
<span class="normal"><a href="#__codelineno-0-2002">2002</a></span>
<span class="normal"><a href="#__codelineno-0-2003">2003</a></span>
<span class="normal"><a href="#__codelineno-0-2004">2004</a></span>
<span class="normal"><a href="#__codelineno-0-2005">2005</a></span>
<span class="normal"><a href="#__codelineno-0-2006">2006</a></span>
<span class="normal"><a href="#__codelineno-0-2007">2007</a></span>
<span class="normal"><a href="#__codelineno-0-2008">2008</a></span>
<span class="normal"><a href="#__codelineno-0-2009">2009</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1980" name="__codelineno-0-1980"></a><span class="nd">@njit</span><span class="p">()</span>
<a id="__codelineno-0-1981" name="__codelineno-0-1981"></a><span class="k">def</span><span class="w"> </span><span class="nf">keep_largest_shape</span><span class="p">(</span><span class="n">indexed_shapes</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">]:</span>
<a id="__codelineno-0-1982" name="__codelineno-0-1982"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1983" name="__codelineno-0-1983"></a><span class="sd">    Keep the largest shape from an array of indexed shapes.</span>
<a id="__codelineno-0-1984" name="__codelineno-0-1984"></a>
<a id="__codelineno-0-1985" name="__codelineno-0-1985"></a><span class="sd">    This function identifies the most frequent non-zero shape in the input</span>
<a id="__codelineno-0-1986" name="__codelineno-0-1986"></a><span class="sd">    array and returns a binary mask where elements matching this shape are set to 1,</span>
<a id="__codelineno-0-1987" name="__codelineno-0-1987"></a><span class="sd">    and others are set to 0. The function uses NumPy&#39;s bincount to count occurrences</span>
<a id="__codelineno-0-1988" name="__codelineno-0-1988"></a><span class="sd">    of each shape and assumes that the first element (index 0) is not part of any</span>
<a id="__codelineno-0-1989" name="__codelineno-0-1989"></a><span class="sd">    shape classification.</span>
<a id="__codelineno-0-1990" name="__codelineno-0-1990"></a>
<a id="__codelineno-0-1991" name="__codelineno-0-1991"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-1992" name="__codelineno-0-1992"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-1993" name="__codelineno-0-1993"></a><span class="sd">    indexed_shapes : ndarray of int32</span>
<a id="__codelineno-0-1994" name="__codelineno-0-1994"></a><span class="sd">        Input array containing indexed shapes.</span>
<a id="__codelineno-0-1995" name="__codelineno-0-1995"></a>
<a id="__codelineno-0-1996" name="__codelineno-0-1996"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-1997" name="__codelineno-0-1997"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1998" name="__codelineno-0-1998"></a><span class="sd">    out : ndarray of uint8</span>
<a id="__codelineno-0-1999" name="__codelineno-0-1999"></a><span class="sd">        Binary mask where the largest shape is marked as 1.</span>
<a id="__codelineno-0-2000" name="__codelineno-0-2000"></a>
<a id="__codelineno-0-2001" name="__codelineno-0-2001"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-2002" name="__codelineno-0-2002"></a><span class="sd">    --------</span>
<a id="__codelineno-0-2003" name="__codelineno-0-2003"></a><span class="sd">    &gt;&gt;&gt; indexed_shapes = np.array([0, 2, 2, 3, 1], dtype=np.int32)</span>
<a id="__codelineno-0-2004" name="__codelineno-0-2004"></a><span class="sd">    &gt;&gt;&gt; keep_largest_shape(indexed_shapes)</span>
<a id="__codelineno-0-2005" name="__codelineno-0-2005"></a><span class="sd">    array([0, 1, 1, 0, 0], dtype=uint8)</span>
<a id="__codelineno-0-2006" name="__codelineno-0-2006"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2007" name="__codelineno-0-2007"></a>    <span class="n">label_counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">indexed_shapes</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
<a id="__codelineno-0-2008" name="__codelineno-0-2008"></a>    <span class="n">largest_label</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">label_counts</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
<a id="__codelineno-0-2009" name="__codelineno-0-2009"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">indexed_shapes</span> <span class="o">==</span> <span class="n">largest_label</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellects.image_analysis.morphological_operations.keep_one_connected_component" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">keep_one_connected_component</span><span class="p">(</span><span class="n">binary_image</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Keep only one connected component in a binary image.</p>
<p>This function filters out all but the largest connected component in
a binary image, effectively isolating it from other noise or objects.
The function ensures the input is in uint8 format before processing.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>binary_image</code>
            </td>
            <td>
                  <code>ndarray of uint8</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Binary image containing one or more connected components.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ndarray of uint8</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Image with only the largest connected component retained.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">all_shapes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">all_shapes</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">all_shapes</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">keep_one_connected_component</span><span class="p">(</span><span class="n">all_shapes</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">[[1 1 0 0 0]</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go"> [1 1 0 0 0]</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go"> [0 0 0 0 0]</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go"> [0 0 0 0 0]</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="go"> [0 0 0 0 0]]</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2012">2012</a></span>
<span class="normal"><a href="#__codelineno-0-2013">2013</a></span>
<span class="normal"><a href="#__codelineno-0-2014">2014</a></span>
<span class="normal"><a href="#__codelineno-0-2015">2015</a></span>
<span class="normal"><a href="#__codelineno-0-2016">2016</a></span>
<span class="normal"><a href="#__codelineno-0-2017">2017</a></span>
<span class="normal"><a href="#__codelineno-0-2018">2018</a></span>
<span class="normal"><a href="#__codelineno-0-2019">2019</a></span>
<span class="normal"><a href="#__codelineno-0-2020">2020</a></span>
<span class="normal"><a href="#__codelineno-0-2021">2021</a></span>
<span class="normal"><a href="#__codelineno-0-2022">2022</a></span>
<span class="normal"><a href="#__codelineno-0-2023">2023</a></span>
<span class="normal"><a href="#__codelineno-0-2024">2024</a></span>
<span class="normal"><a href="#__codelineno-0-2025">2025</a></span>
<span class="normal"><a href="#__codelineno-0-2026">2026</a></span>
<span class="normal"><a href="#__codelineno-0-2027">2027</a></span>
<span class="normal"><a href="#__codelineno-0-2028">2028</a></span>
<span class="normal"><a href="#__codelineno-0-2029">2029</a></span>
<span class="normal"><a href="#__codelineno-0-2030">2030</a></span>
<span class="normal"><a href="#__codelineno-0-2031">2031</a></span>
<span class="normal"><a href="#__codelineno-0-2032">2032</a></span>
<span class="normal"><a href="#__codelineno-0-2033">2033</a></span>
<span class="normal"><a href="#__codelineno-0-2034">2034</a></span>
<span class="normal"><a href="#__codelineno-0-2035">2035</a></span>
<span class="normal"><a href="#__codelineno-0-2036">2036</a></span>
<span class="normal"><a href="#__codelineno-0-2037">2037</a></span>
<span class="normal"><a href="#__codelineno-0-2038">2038</a></span>
<span class="normal"><a href="#__codelineno-0-2039">2039</a></span>
<span class="normal"><a href="#__codelineno-0-2040">2040</a></span>
<span class="normal"><a href="#__codelineno-0-2041">2041</a></span>
<span class="normal"><a href="#__codelineno-0-2042">2042</a></span>
<span class="normal"><a href="#__codelineno-0-2043">2043</a></span>
<span class="normal"><a href="#__codelineno-0-2044">2044</a></span>
<span class="normal"><a href="#__codelineno-0-2045">2045</a></span>
<span class="normal"><a href="#__codelineno-0-2046">2046</a></span>
<span class="normal"><a href="#__codelineno-0-2047">2047</a></span>
<span class="normal"><a href="#__codelineno-0-2048">2048</a></span>
<span class="normal"><a href="#__codelineno-0-2049">2049</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2012" name="__codelineno-0-2012"></a><span class="k">def</span><span class="w"> </span><span class="nf">keep_one_connected_component</span><span class="p">(</span><span class="n">binary_image</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">])</span><span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">]:</span>
<a id="__codelineno-0-2013" name="__codelineno-0-2013"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2014" name="__codelineno-0-2014"></a><span class="sd">    Keep only one connected component in a binary image.</span>
<a id="__codelineno-0-2015" name="__codelineno-0-2015"></a>
<a id="__codelineno-0-2016" name="__codelineno-0-2016"></a><span class="sd">    This function filters out all but the largest connected component in</span>
<a id="__codelineno-0-2017" name="__codelineno-0-2017"></a><span class="sd">    a binary image, effectively isolating it from other noise or objects.</span>
<a id="__codelineno-0-2018" name="__codelineno-0-2018"></a><span class="sd">    The function ensures the input is in uint8 format before processing.</span>
<a id="__codelineno-0-2019" name="__codelineno-0-2019"></a>
<a id="__codelineno-0-2020" name="__codelineno-0-2020"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-2021" name="__codelineno-0-2021"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-2022" name="__codelineno-0-2022"></a><span class="sd">    binary_image : ndarray of uint8</span>
<a id="__codelineno-0-2023" name="__codelineno-0-2023"></a><span class="sd">        Binary image containing one or more connected components.</span>
<a id="__codelineno-0-2024" name="__codelineno-0-2024"></a>
<a id="__codelineno-0-2025" name="__codelineno-0-2025"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-2026" name="__codelineno-0-2026"></a><span class="sd">    -------</span>
<a id="__codelineno-0-2027" name="__codelineno-0-2027"></a><span class="sd">    ndarray of uint8</span>
<a id="__codelineno-0-2028" name="__codelineno-0-2028"></a><span class="sd">        Image with only the largest connected component retained.</span>
<a id="__codelineno-0-2029" name="__codelineno-0-2029"></a>
<a id="__codelineno-0-2030" name="__codelineno-0-2030"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-2031" name="__codelineno-0-2031"></a><span class="sd">    -------</span>
<a id="__codelineno-0-2032" name="__codelineno-0-2032"></a><span class="sd">    &gt;&gt;&gt; all_shapes = np.zeros((5, 5), dtype=np.uint8)</span>
<a id="__codelineno-0-2033" name="__codelineno-0-2033"></a><span class="sd">    &gt;&gt;&gt; all_shapes[0:2, 0:2] = 1</span>
<a id="__codelineno-0-2034" name="__codelineno-0-2034"></a><span class="sd">    &gt;&gt;&gt; all_shapes[3:4, 3:4] = 1</span>
<a id="__codelineno-0-2035" name="__codelineno-0-2035"></a><span class="sd">    &gt;&gt;&gt; res = keep_one_connected_component(all_shapes)</span>
<a id="__codelineno-0-2036" name="__codelineno-0-2036"></a><span class="sd">    &gt;&gt;&gt; print(res)</span>
<a id="__codelineno-0-2037" name="__codelineno-0-2037"></a><span class="sd">    [[1 1 0 0 0]</span>
<a id="__codelineno-0-2038" name="__codelineno-0-2038"></a><span class="sd">     [1 1 0 0 0]</span>
<a id="__codelineno-0-2039" name="__codelineno-0-2039"></a><span class="sd">     [0 0 0 0 0]</span>
<a id="__codelineno-0-2040" name="__codelineno-0-2040"></a><span class="sd">     [0 0 0 0 0]</span>
<a id="__codelineno-0-2041" name="__codelineno-0-2041"></a><span class="sd">     [0 0 0 0 0]]</span>
<a id="__codelineno-0-2042" name="__codelineno-0-2042"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2043" name="__codelineno-0-2043"></a>    <span class="k">if</span> <span class="n">binary_image</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">:</span>
<a id="__codelineno-0-2044" name="__codelineno-0-2044"></a>        <span class="n">binary_image</span> <span class="o">=</span> <span class="n">binary_image</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-2045" name="__codelineno-0-2045"></a>    <span class="n">num_labels</span><span class="p">,</span> <span class="n">sh</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">connectedComponents</span><span class="p">(</span><span class="n">binary_image</span><span class="p">)</span>
<a id="__codelineno-0-2046" name="__codelineno-0-2046"></a>    <span class="k">if</span> <span class="n">num_labels</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-2047" name="__codelineno-0-2047"></a>        <span class="k">return</span> <span class="n">binary_image</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-2048" name="__codelineno-0-2048"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2049" name="__codelineno-0-2049"></a>        <span class="k">return</span> <span class="n">keep_largest_shape</span><span class="p">(</span><span class="n">sh</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellects.image_analysis.morphological_operations.keep_shape_connected_with_ref" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">keep_shape_connected_with_ref</span><span class="p">(</span><span class="n">all_shapes</span><span class="p">,</span> <span class="n">reference_shape</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Keep shape connected with reference.</p>
<p>This function analyzes the connected components of a binary image represented by <code>all_shapes</code>
and returns the first component that intersects with the <code>reference_shape</code>.
If no such component is found, it returns None.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>all_shapes</code>
            </td>
            <td>
                  <code>ndarray of uint8</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Binary image containing all shapes to analyze.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>reference_shape</code>
            </td>
            <td>
                  <code>ndarray of uint8</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Binary reference shape used for intersection check.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>out</code></td>            <td>
                  <code>ndarray of uint8 or None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The first connected component that intersects with the reference shape,
or None if no such component is found.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">all_shapes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">reference_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">reference_shape</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">all_shapes</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">all_shapes</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">keep_shape_connected_with_ref</span><span class="p">(</span><span class="n">all_shapes</span><span class="p">,</span> <span class="n">reference_shape</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go">[[0 0 0 0 0]</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go"> [0 0 0 0 0]</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="go"> [0 0 0 0 0]</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="go"> [0 0 0 1 0]</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="go"> [0 0 0 0 0]]</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1929">1929</a></span>
<span class="normal"><a href="#__codelineno-0-1930">1930</a></span>
<span class="normal"><a href="#__codelineno-0-1931">1931</a></span>
<span class="normal"><a href="#__codelineno-0-1932">1932</a></span>
<span class="normal"><a href="#__codelineno-0-1933">1933</a></span>
<span class="normal"><a href="#__codelineno-0-1934">1934</a></span>
<span class="normal"><a href="#__codelineno-0-1935">1935</a></span>
<span class="normal"><a href="#__codelineno-0-1936">1936</a></span>
<span class="normal"><a href="#__codelineno-0-1937">1937</a></span>
<span class="normal"><a href="#__codelineno-0-1938">1938</a></span>
<span class="normal"><a href="#__codelineno-0-1939">1939</a></span>
<span class="normal"><a href="#__codelineno-0-1940">1940</a></span>
<span class="normal"><a href="#__codelineno-0-1941">1941</a></span>
<span class="normal"><a href="#__codelineno-0-1942">1942</a></span>
<span class="normal"><a href="#__codelineno-0-1943">1943</a></span>
<span class="normal"><a href="#__codelineno-0-1944">1944</a></span>
<span class="normal"><a href="#__codelineno-0-1945">1945</a></span>
<span class="normal"><a href="#__codelineno-0-1946">1946</a></span>
<span class="normal"><a href="#__codelineno-0-1947">1947</a></span>
<span class="normal"><a href="#__codelineno-0-1948">1948</a></span>
<span class="normal"><a href="#__codelineno-0-1949">1949</a></span>
<span class="normal"><a href="#__codelineno-0-1950">1950</a></span>
<span class="normal"><a href="#__codelineno-0-1951">1951</a></span>
<span class="normal"><a href="#__codelineno-0-1952">1952</a></span>
<span class="normal"><a href="#__codelineno-0-1953">1953</a></span>
<span class="normal"><a href="#__codelineno-0-1954">1954</a></span>
<span class="normal"><a href="#__codelineno-0-1955">1955</a></span>
<span class="normal"><a href="#__codelineno-0-1956">1956</a></span>
<span class="normal"><a href="#__codelineno-0-1957">1957</a></span>
<span class="normal"><a href="#__codelineno-0-1958">1958</a></span>
<span class="normal"><a href="#__codelineno-0-1959">1959</a></span>
<span class="normal"><a href="#__codelineno-0-1960">1960</a></span>
<span class="normal"><a href="#__codelineno-0-1961">1961</a></span>
<span class="normal"><a href="#__codelineno-0-1962">1962</a></span>
<span class="normal"><a href="#__codelineno-0-1963">1963</a></span>
<span class="normal"><a href="#__codelineno-0-1964">1964</a></span>
<span class="normal"><a href="#__codelineno-0-1965">1965</a></span>
<span class="normal"><a href="#__codelineno-0-1966">1966</a></span>
<span class="normal"><a href="#__codelineno-0-1967">1967</a></span>
<span class="normal"><a href="#__codelineno-0-1968">1968</a></span>
<span class="normal"><a href="#__codelineno-0-1969">1969</a></span>
<span class="normal"><a href="#__codelineno-0-1970">1970</a></span>
<span class="normal"><a href="#__codelineno-0-1971">1971</a></span>
<span class="normal"><a href="#__codelineno-0-1972">1972</a></span>
<span class="normal"><a href="#__codelineno-0-1973">1973</a></span>
<span class="normal"><a href="#__codelineno-0-1974">1974</a></span>
<span class="normal"><a href="#__codelineno-0-1975">1975</a></span>
<span class="normal"><a href="#__codelineno-0-1976">1976</a></span>
<span class="normal"><a href="#__codelineno-0-1977">1977</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1929" name="__codelineno-0-1929"></a><span class="k">def</span><span class="w"> </span><span class="nf">keep_shape_connected_with_ref</span><span class="p">(</span><span class="n">all_shapes</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">],</span> <span class="n">reference_shape</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">]:</span>
<a id="__codelineno-0-1930" name="__codelineno-0-1930"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1931" name="__codelineno-0-1931"></a><span class="sd">    Keep shape connected with reference.</span>
<a id="__codelineno-0-1932" name="__codelineno-0-1932"></a>
<a id="__codelineno-0-1933" name="__codelineno-0-1933"></a><span class="sd">    This function analyzes the connected components of a binary image represented by `all_shapes`</span>
<a id="__codelineno-0-1934" name="__codelineno-0-1934"></a><span class="sd">    and returns the first component that intersects with the `reference_shape`.</span>
<a id="__codelineno-0-1935" name="__codelineno-0-1935"></a><span class="sd">    If no such component is found, it returns None.</span>
<a id="__codelineno-0-1936" name="__codelineno-0-1936"></a>
<a id="__codelineno-0-1937" name="__codelineno-0-1937"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-1938" name="__codelineno-0-1938"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-1939" name="__codelineno-0-1939"></a><span class="sd">    all_shapes : ndarray of uint8</span>
<a id="__codelineno-0-1940" name="__codelineno-0-1940"></a><span class="sd">        Binary image containing all shapes to analyze.</span>
<a id="__codelineno-0-1941" name="__codelineno-0-1941"></a><span class="sd">    reference_shape : ndarray of uint8</span>
<a id="__codelineno-0-1942" name="__codelineno-0-1942"></a><span class="sd">        Binary reference shape used for intersection check.</span>
<a id="__codelineno-0-1943" name="__codelineno-0-1943"></a>
<a id="__codelineno-0-1944" name="__codelineno-0-1944"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-1945" name="__codelineno-0-1945"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1946" name="__codelineno-0-1946"></a><span class="sd">    out : ndarray of uint8 or None</span>
<a id="__codelineno-0-1947" name="__codelineno-0-1947"></a><span class="sd">        The first connected component that intersects with the reference shape,</span>
<a id="__codelineno-0-1948" name="__codelineno-0-1948"></a><span class="sd">        or None if no such component is found.</span>
<a id="__codelineno-0-1949" name="__codelineno-0-1949"></a>
<a id="__codelineno-0-1950" name="__codelineno-0-1950"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-1951" name="__codelineno-0-1951"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1952" name="__codelineno-0-1952"></a><span class="sd">    &gt;&gt;&gt; all_shapes = np.zeros((5, 5), dtype=np.uint8)</span>
<a id="__codelineno-0-1953" name="__codelineno-0-1953"></a><span class="sd">    &gt;&gt;&gt; reference_shape = np.zeros((5, 5), dtype=np.uint8)</span>
<a id="__codelineno-0-1954" name="__codelineno-0-1954"></a><span class="sd">    &gt;&gt;&gt; reference_shape[3, 3] = 1</span>
<a id="__codelineno-0-1955" name="__codelineno-0-1955"></a><span class="sd">    &gt;&gt;&gt; all_shapes[0:2, 0:2] = 1</span>
<a id="__codelineno-0-1956" name="__codelineno-0-1956"></a><span class="sd">    &gt;&gt;&gt; all_shapes[3:4, 3:4] = 1</span>
<a id="__codelineno-0-1957" name="__codelineno-0-1957"></a><span class="sd">    &gt;&gt;&gt; res = keep_shape_connected_with_ref(all_shapes, reference_shape)</span>
<a id="__codelineno-0-1958" name="__codelineno-0-1958"></a><span class="sd">    &gt;&gt;&gt; print(res)</span>
<a id="__codelineno-0-1959" name="__codelineno-0-1959"></a><span class="sd">    [[0 0 0 0 0]</span>
<a id="__codelineno-0-1960" name="__codelineno-0-1960"></a><span class="sd">     [0 0 0 0 0]</span>
<a id="__codelineno-0-1961" name="__codelineno-0-1961"></a><span class="sd">     [0 0 0 0 0]</span>
<a id="__codelineno-0-1962" name="__codelineno-0-1962"></a><span class="sd">     [0 0 0 1 0]</span>
<a id="__codelineno-0-1963" name="__codelineno-0-1963"></a><span class="sd">     [0 0 0 0 0]]</span>
<a id="__codelineno-0-1964" name="__codelineno-0-1964"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1965" name="__codelineno-0-1965"></a>    <span class="n">number</span><span class="p">,</span> <span class="n">order</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">connectedComponents</span><span class="p">(</span><span class="n">all_shapes</span><span class="p">,</span> <span class="n">ltype</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">CV_16U</span><span class="p">)</span>
<a id="__codelineno-0-1966" name="__codelineno-0-1966"></a>    <span class="n">expanded_shape</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1967" name="__codelineno-0-1967"></a>    <span class="k">if</span> <span class="n">number</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-1968" name="__codelineno-0-1968"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
<a id="__codelineno-0-1969" name="__codelineno-0-1969"></a>            <span class="n">expanded_shape_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">order</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-1970" name="__codelineno-0-1970"></a>            <span class="n">expanded_shape_test</span><span class="p">[</span><span class="n">order</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-1971" name="__codelineno-0-1971"></a>            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">expanded_shape_test</span> <span class="o">*</span> <span class="n">reference_shape</span><span class="p">):</span>
<a id="__codelineno-0-1972" name="__codelineno-0-1972"></a>                <span class="k">break</span>
<a id="__codelineno-0-1973" name="__codelineno-0-1973"></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">expanded_shape_test</span> <span class="o">*</span> <span class="n">reference_shape</span><span class="p">):</span>
<a id="__codelineno-0-1974" name="__codelineno-0-1974"></a>            <span class="n">expanded_shape</span> <span class="o">=</span> <span class="n">expanded_shape_test</span>
<a id="__codelineno-0-1975" name="__codelineno-0-1975"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1976" name="__codelineno-0-1976"></a>            <span class="n">expanded_shape</span> <span class="o">=</span> <span class="n">reference_shape</span>
<a id="__codelineno-0-1977" name="__codelineno-0-1977"></a>    <span class="k">return</span> <span class="n">expanded_shape</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellects.image_analysis.morphological_operations.prepare_box_counting" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">prepare_box_counting</span><span class="p">(</span><span class="n">binary_image</span><span class="p">,</span> <span class="n">min_im_side</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">min_mesh_side</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">zoom_step</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">contours</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Prepare box counting parameters for image analysis.</p>
<p>Prepares parameters for box counting method based on binary
image input. Adjusts image size, computes side lengths, and applies
contour extraction if specified.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>binary_image</code>
            </td>
            <td>
                  <code>ndarray of uint8</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Binary image for analysis.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_im_side</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum side length threshold. Default is 128.</p>
              </div>
            </td>
            <td>
                  <code>128</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_mesh_side</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum mesh side length. Default is 8.</p>
              </div>
            </td>
            <td>
                  <code>8</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>zoom_step</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Zoom step for side lengths computation. Default is 0.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>contours</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to apply contour extraction. Default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>out</code></td>            <td>
                  <code>tuple of ndarray of uint8, ndarray (or None)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Cropped binary image and computed side lengths.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">binary_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">binary_image</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">binary_image</span><span class="p">[</span><span class="mi">7</span><span class="p">:</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">binary_image</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">cropped_img</span><span class="p">,</span> <span class="n">side_lengths</span> <span class="o">=</span> <span class="n">prepare_box_counting</span><span class="p">(</span><span class="n">binary_image</span><span class="p">,</span> <span class="n">min_im_side</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">min_mesh_side</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cropped_img</span><span class="p">),</span> <span class="nb">print</span><span class="p">(</span><span class="n">side_lengths</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go">[[0 0 0 0 0 0 0]</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go"> [0 1 1 1 1 0 0]</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go"> [0 1 1 1 1 0 0]</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="go"> [0 0 0 0 1 0 0]</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="go"> [0 0 0 0 1 0 0]</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="go"> [0 0 0 0 1 0 0]</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="go"> [0 0 0 1 0 1 0]</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="go"> [0 0 0 1 1 1 0]</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="go"> [0 0 0 0 0 0 0]]</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="go">[4 2]</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1784">1784</a></span>
<span class="normal"><a href="#__codelineno-0-1785">1785</a></span>
<span class="normal"><a href="#__codelineno-0-1786">1786</a></span>
<span class="normal"><a href="#__codelineno-0-1787">1787</a></span>
<span class="normal"><a href="#__codelineno-0-1788">1788</a></span>
<span class="normal"><a href="#__codelineno-0-1789">1789</a></span>
<span class="normal"><a href="#__codelineno-0-1790">1790</a></span>
<span class="normal"><a href="#__codelineno-0-1791">1791</a></span>
<span class="normal"><a href="#__codelineno-0-1792">1792</a></span>
<span class="normal"><a href="#__codelineno-0-1793">1793</a></span>
<span class="normal"><a href="#__codelineno-0-1794">1794</a></span>
<span class="normal"><a href="#__codelineno-0-1795">1795</a></span>
<span class="normal"><a href="#__codelineno-0-1796">1796</a></span>
<span class="normal"><a href="#__codelineno-0-1797">1797</a></span>
<span class="normal"><a href="#__codelineno-0-1798">1798</a></span>
<span class="normal"><a href="#__codelineno-0-1799">1799</a></span>
<span class="normal"><a href="#__codelineno-0-1800">1800</a></span>
<span class="normal"><a href="#__codelineno-0-1801">1801</a></span>
<span class="normal"><a href="#__codelineno-0-1802">1802</a></span>
<span class="normal"><a href="#__codelineno-0-1803">1803</a></span>
<span class="normal"><a href="#__codelineno-0-1804">1804</a></span>
<span class="normal"><a href="#__codelineno-0-1805">1805</a></span>
<span class="normal"><a href="#__codelineno-0-1806">1806</a></span>
<span class="normal"><a href="#__codelineno-0-1807">1807</a></span>
<span class="normal"><a href="#__codelineno-0-1808">1808</a></span>
<span class="normal"><a href="#__codelineno-0-1809">1809</a></span>
<span class="normal"><a href="#__codelineno-0-1810">1810</a></span>
<span class="normal"><a href="#__codelineno-0-1811">1811</a></span>
<span class="normal"><a href="#__codelineno-0-1812">1812</a></span>
<span class="normal"><a href="#__codelineno-0-1813">1813</a></span>
<span class="normal"><a href="#__codelineno-0-1814">1814</a></span>
<span class="normal"><a href="#__codelineno-0-1815">1815</a></span>
<span class="normal"><a href="#__codelineno-0-1816">1816</a></span>
<span class="normal"><a href="#__codelineno-0-1817">1817</a></span>
<span class="normal"><a href="#__codelineno-0-1818">1818</a></span>
<span class="normal"><a href="#__codelineno-0-1819">1819</a></span>
<span class="normal"><a href="#__codelineno-0-1820">1820</a></span>
<span class="normal"><a href="#__codelineno-0-1821">1821</a></span>
<span class="normal"><a href="#__codelineno-0-1822">1822</a></span>
<span class="normal"><a href="#__codelineno-0-1823">1823</a></span>
<span class="normal"><a href="#__codelineno-0-1824">1824</a></span>
<span class="normal"><a href="#__codelineno-0-1825">1825</a></span>
<span class="normal"><a href="#__codelineno-0-1826">1826</a></span>
<span class="normal"><a href="#__codelineno-0-1827">1827</a></span>
<span class="normal"><a href="#__codelineno-0-1828">1828</a></span>
<span class="normal"><a href="#__codelineno-0-1829">1829</a></span>
<span class="normal"><a href="#__codelineno-0-1830">1830</a></span>
<span class="normal"><a href="#__codelineno-0-1831">1831</a></span>
<span class="normal"><a href="#__codelineno-0-1832">1832</a></span>
<span class="normal"><a href="#__codelineno-0-1833">1833</a></span>
<span class="normal"><a href="#__codelineno-0-1834">1834</a></span>
<span class="normal"><a href="#__codelineno-0-1835">1835</a></span>
<span class="normal"><a href="#__codelineno-0-1836">1836</a></span>
<span class="normal"><a href="#__codelineno-0-1837">1837</a></span>
<span class="normal"><a href="#__codelineno-0-1838">1838</a></span>
<span class="normal"><a href="#__codelineno-0-1839">1839</a></span>
<span class="normal"><a href="#__codelineno-0-1840">1840</a></span>
<span class="normal"><a href="#__codelineno-0-1841">1841</a></span>
<span class="normal"><a href="#__codelineno-0-1842">1842</a></span>
<span class="normal"><a href="#__codelineno-0-1843">1843</a></span>
<span class="normal"><a href="#__codelineno-0-1844">1844</a></span>
<span class="normal"><a href="#__codelineno-0-1845">1845</a></span>
<span class="normal"><a href="#__codelineno-0-1846">1846</a></span>
<span class="normal"><a href="#__codelineno-0-1847">1847</a></span>
<span class="normal"><a href="#__codelineno-0-1848">1848</a></span>
<span class="normal"><a href="#__codelineno-0-1849">1849</a></span>
<span class="normal"><a href="#__codelineno-0-1850">1850</a></span>
<span class="normal"><a href="#__codelineno-0-1851">1851</a></span>
<span class="normal"><a href="#__codelineno-0-1852">1852</a></span>
<span class="normal"><a href="#__codelineno-0-1853">1853</a></span>
<span class="normal"><a href="#__codelineno-0-1854">1854</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1784" name="__codelineno-0-1784"></a><span class="k">def</span><span class="w"> </span><span class="nf">prepare_box_counting</span><span class="p">(</span><span class="n">binary_image</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">],</span> <span class="n">min_im_side</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">min_mesh_side</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">zoom_step</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">contours</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">]]:</span>
<a id="__codelineno-0-1785" name="__codelineno-0-1785"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Prepare box counting parameters for image analysis.</span>
<a id="__codelineno-0-1786" name="__codelineno-0-1786"></a>
<a id="__codelineno-0-1787" name="__codelineno-0-1787"></a><span class="sd">    Prepares parameters for box counting method based on binary</span>
<a id="__codelineno-0-1788" name="__codelineno-0-1788"></a><span class="sd">    image input. Adjusts image size, computes side lengths, and applies</span>
<a id="__codelineno-0-1789" name="__codelineno-0-1789"></a><span class="sd">    contour extraction if specified.</span>
<a id="__codelineno-0-1790" name="__codelineno-0-1790"></a>
<a id="__codelineno-0-1791" name="__codelineno-0-1791"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-1792" name="__codelineno-0-1792"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-1793" name="__codelineno-0-1793"></a><span class="sd">    binary_image : ndarray of uint8</span>
<a id="__codelineno-0-1794" name="__codelineno-0-1794"></a><span class="sd">        Binary image for analysis.</span>
<a id="__codelineno-0-1795" name="__codelineno-0-1795"></a><span class="sd">    min_im_side : int, optional</span>
<a id="__codelineno-0-1796" name="__codelineno-0-1796"></a><span class="sd">        Minimum side length threshold. Default is 128.</span>
<a id="__codelineno-0-1797" name="__codelineno-0-1797"></a><span class="sd">    min_mesh_side : int, optional</span>
<a id="__codelineno-0-1798" name="__codelineno-0-1798"></a><span class="sd">        Minimum mesh side length. Default is 8.</span>
<a id="__codelineno-0-1799" name="__codelineno-0-1799"></a><span class="sd">    zoom_step : int, optional</span>
<a id="__codelineno-0-1800" name="__codelineno-0-1800"></a><span class="sd">        Zoom step for side lengths computation. Default is 0.</span>
<a id="__codelineno-0-1801" name="__codelineno-0-1801"></a><span class="sd">    contours : bool, optional</span>
<a id="__codelineno-0-1802" name="__codelineno-0-1802"></a><span class="sd">        Whether to apply contour extraction. Default is True.</span>
<a id="__codelineno-0-1803" name="__codelineno-0-1803"></a>
<a id="__codelineno-0-1804" name="__codelineno-0-1804"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-1805" name="__codelineno-0-1805"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1806" name="__codelineno-0-1806"></a><span class="sd">    out : tuple of ndarray of uint8, ndarray (or None)</span>
<a id="__codelineno-0-1807" name="__codelineno-0-1807"></a><span class="sd">        Cropped binary image and computed side lengths.</span>
<a id="__codelineno-0-1808" name="__codelineno-0-1808"></a>
<a id="__codelineno-0-1809" name="__codelineno-0-1809"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-1810" name="__codelineno-0-1810"></a><span class="sd">    --------</span>
<a id="__codelineno-0-1811" name="__codelineno-0-1811"></a><span class="sd">    &gt;&gt;&gt; binary_image = np.zeros((10, 10), dtype=np.uint8)</span>
<a id="__codelineno-0-1812" name="__codelineno-0-1812"></a><span class="sd">    &gt;&gt;&gt; binary_image[2:4, 2:6] = 1</span>
<a id="__codelineno-0-1813" name="__codelineno-0-1813"></a><span class="sd">    &gt;&gt;&gt; binary_image[7:9, 4:7] = 1</span>
<a id="__codelineno-0-1814" name="__codelineno-0-1814"></a><span class="sd">    &gt;&gt;&gt; binary_image[4:7, 5] = 1</span>
<a id="__codelineno-0-1815" name="__codelineno-0-1815"></a><span class="sd">    &gt;&gt;&gt; cropped_img, side_lengths = prepare_box_counting(binary_image, min_im_side=2, min_mesh_side=2)</span>
<a id="__codelineno-0-1816" name="__codelineno-0-1816"></a><span class="sd">    &gt;&gt;&gt; print(cropped_img), print(side_lengths)</span>
<a id="__codelineno-0-1817" name="__codelineno-0-1817"></a><span class="sd">    [[0 0 0 0 0 0 0]</span>
<a id="__codelineno-0-1818" name="__codelineno-0-1818"></a><span class="sd">     [0 1 1 1 1 0 0]</span>
<a id="__codelineno-0-1819" name="__codelineno-0-1819"></a><span class="sd">     [0 1 1 1 1 0 0]</span>
<a id="__codelineno-0-1820" name="__codelineno-0-1820"></a><span class="sd">     [0 0 0 0 1 0 0]</span>
<a id="__codelineno-0-1821" name="__codelineno-0-1821"></a><span class="sd">     [0 0 0 0 1 0 0]</span>
<a id="__codelineno-0-1822" name="__codelineno-0-1822"></a><span class="sd">     [0 0 0 0 1 0 0]</span>
<a id="__codelineno-0-1823" name="__codelineno-0-1823"></a><span class="sd">     [0 0 0 1 0 1 0]</span>
<a id="__codelineno-0-1824" name="__codelineno-0-1824"></a><span class="sd">     [0 0 0 1 1 1 0]</span>
<a id="__codelineno-0-1825" name="__codelineno-0-1825"></a><span class="sd">     [0 0 0 0 0 0 0]]</span>
<a id="__codelineno-0-1826" name="__codelineno-0-1826"></a><span class="sd">    [4 2]</span>
<a id="__codelineno-0-1827" name="__codelineno-0-1827"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1828" name="__codelineno-0-1828"></a>    <span class="n">side_lengths</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1829" name="__codelineno-0-1829"></a>    <span class="n">zoomed_binary</span> <span class="o">=</span> <span class="n">binary_image</span>
<a id="__codelineno-0-1830" name="__codelineno-0-1830"></a>    <span class="n">binary_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">binary_image</span><span class="p">)</span>
<a id="__codelineno-0-1831" name="__codelineno-0-1831"></a>    <span class="k">if</span> <span class="n">binary_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
<a id="__codelineno-0-1832" name="__codelineno-0-1832"></a>        <span class="n">min_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">binary_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-1833" name="__codelineno-0-1833"></a>        <span class="n">min_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">((</span><span class="n">min_y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-0-1834" name="__codelineno-0-1834"></a>
<a id="__codelineno-0-1835" name="__codelineno-0-1835"></a>        <span class="n">min_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">binary_idx</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-1836" name="__codelineno-0-1836"></a>        <span class="n">min_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">((</span><span class="n">min_x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-0-1837" name="__codelineno-0-1837"></a>
<a id="__codelineno-0-1838" name="__codelineno-0-1838"></a>        <span class="n">max_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">binary_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-1839" name="__codelineno-0-1839"></a>        <span class="n">max_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">((</span><span class="n">max_y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">binary_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-1840" name="__codelineno-0-1840"></a>
<a id="__codelineno-0-1841" name="__codelineno-0-1841"></a>        <span class="n">max_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">binary_idx</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-1842" name="__codelineno-0-1842"></a>        <span class="n">max_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">((</span><span class="n">max_x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">binary_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-1843" name="__codelineno-0-1843"></a>
<a id="__codelineno-0-1844" name="__codelineno-0-1844"></a>        <span class="n">zoomed_binary</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">binary_image</span><span class="p">[</span><span class="n">min_y</span><span class="p">:(</span><span class="n">max_y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">min_x</span><span class="p">:</span> <span class="p">(</span><span class="n">max_x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)])</span>
<a id="__codelineno-0-1845" name="__codelineno-0-1845"></a>        <span class="n">min_side</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">zoomed_binary</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<a id="__codelineno-0-1846" name="__codelineno-0-1846"></a>        <span class="k">if</span> <span class="n">min_side</span> <span class="o">&gt;=</span> <span class="n">min_im_side</span><span class="p">:</span>
<a id="__codelineno-0-1847" name="__codelineno-0-1847"></a>            <span class="k">if</span> <span class="n">contours</span><span class="p">:</span>
<a id="__codelineno-0-1848" name="__codelineno-0-1848"></a>                <span class="n">zoomed_binary</span> <span class="o">=</span> <span class="n">get_contours</span><span class="p">(</span><span class="n">zoomed_binary</span><span class="p">)</span>
<a id="__codelineno-0-1849" name="__codelineno-0-1849"></a>            <span class="k">if</span> <span class="n">zoom_step</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1850" name="__codelineno-0-1850"></a>                <span class="n">max_power</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">min_side</span><span class="p">)))</span>  <span class="c1"># Largest integer power of 2</span>
<a id="__codelineno-0-1851" name="__codelineno-0-1851"></a>                <span class="n">side_lengths</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">max_power</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">min_mesh_side</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-1852" name="__codelineno-0-1852"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1853" name="__codelineno-0-1853"></a>                <span class="n">side_lengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">min_mesh_side</span><span class="p">,</span> <span class="n">min_side</span><span class="p">,</span> <span class="n">zoom_step</span><span class="p">)</span>
<a id="__codelineno-0-1854" name="__codelineno-0-1854"></a>    <span class="k">return</span> <span class="n">zoomed_binary</span><span class="p">,</span> <span class="n">side_lengths</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellects.image_analysis.morphological_operations.rank_from_top_to_bottom_from_left_to_right" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rank_from_top_to_bottom_from_left_to_right</span><span class="p">(</span><span class="n">binary_image</span><span class="p">,</span> <span class="n">y_boundaries</span><span class="p">,</span> <span class="n">get_ordered_image</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Rank components in a binary image from top to bottom and from left to right.</p>
<p>This function processes a binary image to rank its components based on
their centroids. It first sorts the components row by row and then orders them
within each row from left to right. If the ordering fails, it attempts an alternative
algorithm and returns the ordered statistics and centroids.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>binary_image</code>
            </td>
            <td>
                  <code>ndarray of uint8</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input binary image to process.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_boundaries</code>
            </td>
            <td>
                  <code>ndarray of int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Boundary information for the y-coordinates.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>get_ordered_image</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, returns an ordered image in addition to the statistics and centroids.
Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>get_ordered_image</code> is True, returns a tuple containing:
- ordered_stats : ndarray of int
    Statistics for the ordered components.
- ordered_centroids : ndarray of float64
    Centroids for the ordered components.
- ordered_image : ndarray of uint8
    The binary image with ordered component labels.</p>
<p>If <code>get_ordered_image</code> is False, returns a tuple containing:
- ordered_stats : ndarray of int
    Statistics for the ordered components.
- ordered_centroids : ndarray of float64
    Centroids for the ordered components.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1077" name="__codelineno-0-1077"></a><span class="k">def</span><span class="w"> </span><span class="nf">rank_from_top_to_bottom_from_left_to_right</span><span class="p">(</span><span class="n">binary_image</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">],</span> <span class="n">y_boundaries</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">get_ordered_image</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">:</span>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a><span class="sd">    Rank components in a binary image from top to bottom and from left to right.</span>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a><span class="sd">    This function processes a binary image to rank its components based on</span>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a><span class="sd">    their centroids. It first sorts the components row by row and then orders them</span>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a><span class="sd">    within each row from left to right. If the ordering fails, it attempts an alternative</span>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a><span class="sd">    algorithm and returns the ordered statistics and centroids.</span>
<a id="__codelineno-0-1085" name="__codelineno-0-1085"></a>
<a id="__codelineno-0-1086" name="__codelineno-0-1086"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-1087" name="__codelineno-0-1087"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-1088" name="__codelineno-0-1088"></a><span class="sd">    binary_image : ndarray of uint8</span>
<a id="__codelineno-0-1089" name="__codelineno-0-1089"></a><span class="sd">        The input binary image to process.</span>
<a id="__codelineno-0-1090" name="__codelineno-0-1090"></a><span class="sd">    y_boundaries : ndarray of int</span>
<a id="__codelineno-0-1091" name="__codelineno-0-1091"></a><span class="sd">        Boundary information for the y-coordinates.</span>
<a id="__codelineno-0-1092" name="__codelineno-0-1092"></a><span class="sd">    get_ordered_image : bool, optional</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a><span class="sd">        If True, returns an ordered image in addition to the statistics and centroids.</span>
<a id="__codelineno-0-1094" name="__codelineno-0-1094"></a><span class="sd">        Default is False.</span>
<a id="__codelineno-0-1095" name="__codelineno-0-1095"></a>
<a id="__codelineno-0-1096" name="__codelineno-0-1096"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-1097" name="__codelineno-0-1097"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1098" name="__codelineno-0-1098"></a><span class="sd">    tuple</span>
<a id="__codelineno-0-1099" name="__codelineno-0-1099"></a><span class="sd">        If `get_ordered_image` is True, returns a tuple containing:</span>
<a id="__codelineno-0-1100" name="__codelineno-0-1100"></a><span class="sd">        - ordered_stats : ndarray of int</span>
<a id="__codelineno-0-1101" name="__codelineno-0-1101"></a><span class="sd">            Statistics for the ordered components.</span>
<a id="__codelineno-0-1102" name="__codelineno-0-1102"></a><span class="sd">        - ordered_centroids : ndarray of float64</span>
<a id="__codelineno-0-1103" name="__codelineno-0-1103"></a><span class="sd">            Centroids for the ordered components.</span>
<a id="__codelineno-0-1104" name="__codelineno-0-1104"></a><span class="sd">        - ordered_image : ndarray of uint8</span>
<a id="__codelineno-0-1105" name="__codelineno-0-1105"></a><span class="sd">            The binary image with ordered component labels.</span>
<a id="__codelineno-0-1106" name="__codelineno-0-1106"></a>
<a id="__codelineno-0-1107" name="__codelineno-0-1107"></a><span class="sd">        If `get_ordered_image` is False, returns a tuple containing:</span>
<a id="__codelineno-0-1108" name="__codelineno-0-1108"></a><span class="sd">        - ordered_stats : ndarray of int</span>
<a id="__codelineno-0-1109" name="__codelineno-0-1109"></a><span class="sd">            Statistics for the ordered components.</span>
<a id="__codelineno-0-1110" name="__codelineno-0-1110"></a><span class="sd">        - ordered_centroids : ndarray of float64</span>
<a id="__codelineno-0-1111" name="__codelineno-0-1111"></a><span class="sd">            Centroids for the ordered components.</span>
<a id="__codelineno-0-1112" name="__codelineno-0-1112"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1113" name="__codelineno-0-1113"></a>    <span class="n">nb_components</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">stats</span><span class="p">,</span> <span class="n">centroids</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">connectedComponentsWithStats</span><span class="p">(</span><span class="n">binary_image</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">),</span>
<a id="__codelineno-0-1114" name="__codelineno-0-1114"></a>                                                                               <span class="n">connectivity</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<a id="__codelineno-0-1115" name="__codelineno-0-1115"></a>
<a id="__codelineno-0-1116" name="__codelineno-0-1116"></a>    <span class="n">centroids</span> <span class="o">=</span> <span class="n">centroids</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span>
<a id="__codelineno-0-1117" name="__codelineno-0-1117"></a>    <span class="n">final_order</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">centroids</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-1118" name="__codelineno-0-1118"></a>    <span class="n">sorted_against_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">centroids</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-1119" name="__codelineno-0-1119"></a>    <span class="c1"># row_nb = (y_boundaries == 1).sum()</span>
<a id="__codelineno-0-1120" name="__codelineno-0-1120"></a>    <span class="n">row_nb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(((</span><span class="n">y_boundaries</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="p">(</span><span class="n">y_boundaries</span> <span class="o">==</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
<a id="__codelineno-0-1121" name="__codelineno-0-1121"></a>    <span class="k">if</span> <span class="n">row_nb</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1122" name="__codelineno-0-1122"></a>        <span class="n">component_per_row</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">nb_components</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">row_nb</span><span class="p">))</span>
<a id="__codelineno-0-1123" name="__codelineno-0-1123"></a>        <span class="k">for</span> <span class="n">row_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">row_nb</span><span class="p">):</span>
<a id="__codelineno-0-1124" name="__codelineno-0-1124"></a>            <span class="n">row_i_start</span> <span class="o">=</span> <span class="n">row_i</span> <span class="o">*</span> <span class="n">component_per_row</span>
<a id="__codelineno-0-1125" name="__codelineno-0-1125"></a>            <span class="k">if</span> <span class="n">row_i</span> <span class="o">==</span> <span class="p">(</span><span class="n">row_nb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-1126" name="__codelineno-0-1126"></a>                <span class="n">sorted_against_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">centroids</span><span class="p">[</span><span class="n">sorted_against_y</span><span class="p">[</span><span class="n">row_i_start</span><span class="p">:],</span> <span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-1127" name="__codelineno-0-1127"></a>                <span class="n">final_order</span><span class="p">[</span><span class="n">row_i_start</span><span class="p">:]</span> <span class="o">=</span> <span class="n">sorted_against_y</span><span class="p">[</span><span class="n">row_i_start</span><span class="p">:][</span><span class="n">sorted_against_x</span><span class="p">]</span>
<a id="__codelineno-0-1128" name="__codelineno-0-1128"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1129" name="__codelineno-0-1129"></a>                <span class="n">row_i_end</span> <span class="o">=</span> <span class="p">(</span><span class="n">row_i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">component_per_row</span>
<a id="__codelineno-0-1130" name="__codelineno-0-1130"></a>                <span class="n">sorted_against_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">centroids</span><span class="p">[</span><span class="n">sorted_against_y</span><span class="p">[</span><span class="n">row_i_start</span><span class="p">:</span><span class="n">row_i_end</span><span class="p">],</span> <span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-1131" name="__codelineno-0-1131"></a>                <span class="n">final_order</span><span class="p">[</span><span class="n">row_i_start</span><span class="p">:</span><span class="n">row_i_end</span><span class="p">]</span> <span class="o">=</span> <span class="n">sorted_against_y</span><span class="p">[</span><span class="n">row_i_start</span><span class="p">:</span><span class="n">row_i_end</span><span class="p">][</span><span class="n">sorted_against_x</span><span class="p">]</span>
<a id="__codelineno-0-1132" name="__codelineno-0-1132"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1133" name="__codelineno-0-1133"></a>        <span class="n">final_order</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">centroids</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-1134" name="__codelineno-0-1134"></a>    <span class="n">ordered_centroids</span> <span class="o">=</span> <span class="n">centroids</span><span class="p">[</span><span class="n">final_order</span><span class="p">,</span> <span class="p">:]</span>
<a id="__codelineno-0-1135" name="__codelineno-0-1135"></a>    <span class="n">ordered_stats</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span>
<a id="__codelineno-0-1136" name="__codelineno-0-1136"></a>    <span class="n">ordered_stats</span> <span class="o">=</span> <span class="n">ordered_stats</span><span class="p">[</span><span class="n">final_order</span><span class="p">,</span> <span class="p">:]</span>
<a id="__codelineno-0-1137" name="__codelineno-0-1137"></a>
<a id="__codelineno-0-1138" name="__codelineno-0-1138"></a>    <span class="k">if</span> <span class="n">get_ordered_image</span><span class="p">:</span>
<a id="__codelineno-0-1139" name="__codelineno-0-1139"></a>        <span class="n">old_to_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">final_order</span><span class="p">)</span>
<a id="__codelineno-0-1140" name="__codelineno-0-1140"></a>        <span class="n">old_to_new</span><span class="p">[</span><span class="n">final_order</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">final_order</span><span class="p">))</span>
<a id="__codelineno-0-1141" name="__codelineno-0-1141"></a>        <span class="n">mapping_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">binary_image</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-1142" name="__codelineno-0-1142"></a>        <span class="n">mapping_array</span><span class="p">[</span><span class="n">output</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">old_to_new</span><span class="p">[</span><span class="n">output</span><span class="p">[</span><span class="n">output</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-1143" name="__codelineno-0-1143"></a>        <span class="n">ordered_image</span> <span class="o">=</span> <span class="n">mapping_array</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-1144" name="__codelineno-0-1144"></a>        <span class="k">return</span> <span class="n">ordered_stats</span><span class="p">,</span> <span class="n">ordered_centroids</span><span class="p">,</span> <span class="n">ordered_image</span>
<a id="__codelineno-0-1145" name="__codelineno-0-1145"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1146" name="__codelineno-0-1146"></a>        <span class="k">return</span> <span class="n">ordered_stats</span><span class="p">,</span> <span class="n">ordered_centroids</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellects.image_analysis.morphological_operations.reduce_image_size_for_speed" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reduce_image_size_for_speed</span><span class="p">(</span><span class="n">image_of_2_shapes</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Reduces the size of an image containing two shapes for faster processing.</p>
<p>The function iteratively divides the image into quadrants and keeps only
those that contain both shapes until a minimal size is reached.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>image_of_2_shapes</code>
            </td>
            <td>
                  <code>ndarray of uint8</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input image containing two shapes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>out</code></td>            <td>
                  <code>tuple of tuples</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The indices of the first and second shape in the reduced image.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">image_of_2_shapes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">image_of_2_shapes</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">image_of_2_shapes</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">shape1_idx</span><span class="p">,</span> <span class="n">shape2_idx</span> <span class="o">=</span> <span class="n">reduce_image_size_for_speed</span><span class="p">(</span><span class="n">image_of_2_shapes</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">shape1_idx</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">(array([1, 1, 2, 2]), array([1, 2, 1, 2]))</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span>
<span class="normal"><a href="#__codelineno-0-852">852</a></span>
<span class="normal"><a href="#__codelineno-0-853">853</a></span>
<span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span>
<span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span>
<span class="normal"><a href="#__codelineno-0-880">880</a></span>
<span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span>
<span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span>
<span class="normal"><a href="#__codelineno-0-892">892</a></span>
<span class="normal"><a href="#__codelineno-0-893">893</a></span>
<span class="normal"><a href="#__codelineno-0-894">894</a></span>
<span class="normal"><a href="#__codelineno-0-895">895</a></span>
<span class="normal"><a href="#__codelineno-0-896">896</a></span>
<span class="normal"><a href="#__codelineno-0-897">897</a></span>
<span class="normal"><a href="#__codelineno-0-898">898</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-836" name="__codelineno-0-836"></a><span class="nd">@njit</span><span class="p">()</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a><span class="k">def</span><span class="w"> </span><span class="nf">reduce_image_size_for_speed</span><span class="p">(</span><span class="n">image_of_2_shapes</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">]:</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a><span class="sd">    Reduces the size of an image containing two shapes for faster processing.</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a><span class="sd">    The function iteratively divides the image into quadrants and keeps only</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a><span class="sd">    those that contain both shapes until a minimal size is reached.</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a><span class="sd">    image_of_2_shapes : ndarray of uint8</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a><span class="sd">        The input image containing two shapes.</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a><span class="sd">    -------</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a><span class="sd">    out : tuple of tuples</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a><span class="sd">        The indices of the first and second shape in the reduced image.</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a><span class="sd">    --------</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a><span class="sd">    &gt;&gt;&gt; image_of_2_shapes = np.zeros((10, 10), dtype=np.uint8)</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a><span class="sd">    &gt;&gt;&gt; image_of_2_shapes[1:3, 1:3] = 1</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a><span class="sd">    &gt;&gt;&gt; image_of_2_shapes[1:3, 4:6] = 2</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a><span class="sd">    &gt;&gt;&gt; shape1_idx, shape2_idx = reduce_image_size_for_speed(image_of_2_shapes)</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a><span class="sd">    &gt;&gt;&gt; print(shape1_idx)</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a><span class="sd">    (array([1, 1, 2, 2]), array([1, 2, 1, 2]))</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>    <span class="n">sub_image</span> <span class="o">=</span> <span class="n">image_of_2_shapes</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a>    <span class="n">y_size</span><span class="p">,</span> <span class="n">x_size</span> <span class="o">=</span> <span class="n">sub_image</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>    <span class="n">images_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">sub_image</span><span class="p">]</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>    <span class="n">good_images</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a>    <span class="n">sub_image</span> <span class="o">=</span> <span class="n">images_list</span><span class="p">[</span><span class="n">good_images</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a>    <span class="k">while</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">good_images</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">good_images</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="n">y_size</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">x_size</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a>        <span class="n">y_size</span><span class="p">,</span> <span class="n">x_size</span> <span class="o">=</span> <span class="n">sub_image</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a>        <span class="n">images_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>        <span class="n">images_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub_image</span><span class="p">[:((</span><span class="n">y_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="p">:((</span><span class="n">x_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)])</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a>        <span class="n">images_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub_image</span><span class="p">[:((</span><span class="n">y_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">x_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):])</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a>        <span class="n">images_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub_image</span><span class="p">[(</span><span class="n">y_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):,</span> <span class="p">:((</span><span class="n">x_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)])</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a>        <span class="n">images_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub_image</span><span class="p">[(</span><span class="n">y_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):,</span> <span class="p">(</span><span class="n">x_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):])</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a>        <span class="n">good_images</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a>        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">image</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">images_list</span><span class="p">):</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a>            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">image</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a>                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">image</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a>                    <span class="n">good_images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">good_images</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a>            <span class="k">break</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a>        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">good_images</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a>            <span class="k">if</span> <span class="n">good_images</span> <span class="o">==</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>                <span class="n">sub_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">images_list</span><span class="p">[</span><span class="n">good_images</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">images_list</span><span class="p">[</span><span class="n">good_images</span><span class="p">[</span><span class="mi">1</span><span class="p">]]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>            <span class="k">elif</span> <span class="n">good_images</span> <span class="o">==</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a>                <span class="n">sub_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">images_list</span><span class="p">[</span><span class="n">good_images</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">images_list</span><span class="p">[</span><span class="n">good_images</span><span class="p">[</span><span class="mi">1</span><span class="p">]]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a>            <span class="k">elif</span> <span class="n">good_images</span> <span class="o">==</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a>                <span class="n">sub_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">images_list</span><span class="p">[</span><span class="n">good_images</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">images_list</span><span class="p">[</span><span class="n">good_images</span><span class="p">[</span><span class="mi">1</span><span class="p">]]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>            <span class="k">elif</span> <span class="n">good_images</span> <span class="o">==</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>                <span class="n">sub_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">images_list</span><span class="p">[</span><span class="n">good_images</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">images_list</span><span class="p">[</span><span class="n">good_images</span><span class="p">[</span><span class="mi">1</span><span class="p">]]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a>                <span class="k">pass</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a>            <span class="n">sub_image</span> <span class="o">=</span> <span class="n">images_list</span><span class="p">[</span><span class="n">good_images</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a>    <span class="n">shape1_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">sub_image</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a>    <span class="n">shape2_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">sub_image</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a>    <span class="k">return</span> <span class="n">shape1_idx</span><span class="p">,</span> <span class="n">shape2_idx</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellects.image_analysis.morphological_operations.rounded_inverted_distance_transform" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rounded_inverted_distance_transform</span><span class="p">(</span><span class="n">original_shape</span><span class="p">,</span> <span class="n">max_distance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">with_erosion</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Perform rounded inverted distance transform on a binary image.</p>
<p>This function computes the inverse of the Euclidean distance transform,
where each pixel value represents its distance to the nearest zero
pixel. The operation can include erosion and will stop either at a given
max distance or until no further expansion is needed.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>original_shape</code>
            </td>
            <td>
                  <code>ndarray of uint8</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input binary image to be processed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_distance</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum distance for the expansion. If None, no limit is applied.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_erosion</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of erosion iterations to apply before the transform. Default is 0.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>out</code></td>            <td>
                  <code>ndarray of uint32</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Output image containing the rounded inverted distance transform.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">segmentation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">segmentation</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">gravity</span> <span class="o">=</span> <span class="n">rounded_inverted_distance_transform</span><span class="p">(</span><span class="n">segmentation</span><span class="p">,</span> <span class="n">max_distance</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">gravity</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">[[1 2 2 1]</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go"> [2 0 0 2]</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go"> [2 0 0 2]</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go"> [1 2 2 1]]</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="k">def</span><span class="w"> </span><span class="nf">rounded_inverted_distance_transform</span><span class="p">(</span><span class="n">original_shape</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">],</span> <span class="n">max_distance</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">with_erosion</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">]:</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a><span class="sd">    Perform rounded inverted distance transform on a binary image.</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a><span class="sd">    This function computes the inverse of the Euclidean distance transform,</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a><span class="sd">    where each pixel value represents its distance to the nearest zero</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">    pixel. The operation can include erosion and will stop either at a given</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a><span class="sd">    max distance or until no further expansion is needed.</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a><span class="sd">    original_shape : ndarray of uint8</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a><span class="sd">        Input binary image to be processed.</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a><span class="sd">    max_distance : int, optional</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a><span class="sd">        Maximum distance for the expansion. If None, no limit is applied.</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a><span class="sd">    with_erosion : int, optional</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a><span class="sd">        Number of erosion iterations to apply before the transform. Default is 0.</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a><span class="sd">    -------</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a><span class="sd">    out : ndarray of uint32</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a><span class="sd">        Output image containing the rounded inverted distance transform.</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a><span class="sd">    --------</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a><span class="sd">    &gt;&gt;&gt; segmentation = np.zeros((4, 4), dtype=np.uint8)</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a><span class="sd">    &gt;&gt;&gt; segmentation[1:3, 1:3] = 1</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a><span class="sd">    &gt;&gt;&gt; gravity = rounded_inverted_distance_transform(segmentation, max_distance=2)</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a><span class="sd">    &gt;&gt;&gt; print(gravity)</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a><span class="sd">    [[1 2 2 1]</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a><span class="sd">     [2 0 0 2]</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a><span class="sd">     [2 0 0 2]</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a><span class="sd">     [1 2 2 1]]</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>    <span class="k">if</span> <span class="n">with_erosion</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>        <span class="n">original_shape</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">erode</span><span class="p">(</span><span class="n">original_shape</span><span class="p">,</span> <span class="n">cross_33</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="n">with_erosion</span><span class="p">,</span> <span class="n">borderType</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">BORDER_CONSTANT</span><span class="p">,</span> <span class="n">borderValue</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>    <span class="n">expand</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">original_shape</span><span class="p">)</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>    <span class="k">if</span> <span class="n">max_distance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>        <span class="k">if</span> <span class="n">max_distance</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">original_shape</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>            <span class="n">max_distance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">original_shape</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">)</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>        <span class="n">gravity_field</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">original_shape</span><span class="o">.</span><span class="n">shape</span> <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">)</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>        <span class="k">for</span> <span class="n">gravi</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">max_distance</span><span class="p">):</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>            <span class="n">expand</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dilate</span><span class="p">(</span><span class="n">expand</span><span class="p">,</span> <span class="n">cross_33</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">borderType</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">BORDER_CONSTANT</span><span class="p">,</span> <span class="n">borderValue</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>            <span class="n">gravity_field</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">logical_xor</span><span class="p">(</span><span class="n">expand</span><span class="p">,</span> <span class="n">original_shape</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>        <span class="n">gravity_field</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">original_shape</span><span class="o">.</span><span class="n">shape</span> <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">)</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>        <span class="k">while</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">original_shape</span> <span class="o">+</span> <span class="n">expand</span><span class="p">,</span> <span class="mi">0</span><span class="p">)):</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>            <span class="n">expand</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dilate</span><span class="p">(</span><span class="n">expand</span><span class="p">,</span> <span class="n">cross_33</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">borderType</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">BORDER_CONSTANT</span><span class="p">,</span> <span class="n">borderValue</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>            <span class="n">gravity_field</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">logical_xor</span><span class="p">(</span><span class="n">expand</span><span class="p">,</span> <span class="n">original_shape</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>    <span class="k">return</span> <span class="n">gravity_field</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellects.image_analysis.morphological_operations.shape_selection" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">shape_selection</span><span class="p">(</span><span class="n">binary_image</span><span class="p">,</span> <span class="n">several_blob_per_arena</span><span class="p">,</span> <span class="n">true_shape_number</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizontal_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">spot_shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bio_mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">back_mask</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Process the binary image to identify and validate shapes.</p>
<p>This method processes a binary image to detect connected components,
validate their sizes, and handle bio and back masks if specified.
It ensures that the number of validated shapes matches the expected
sample number or applies additional filtering if necessary.</p>
<p>Args:
    use_bio_and_back_masks (bool): Whether to use bio and back masks
        during the processing. Default is False.</p>
<p>Selects and validates the shapes of stains based on their size and shape.</p>
<p>This method performs two main tasks:
1. Removes stains whose horizontal size varies too much from a reference value.
2. Determines the shape of each remaining stain and only keeps those that correspond to a reference shape.</p>
<p>The method first removes stains whose horizontal size is outside the specified confidence interval. Then, it identifies shapes that do not correspond to a predefined reference shape and removes them as well.</p>
<p>Args:
    horizontal_size (int): The expected horizontal size of the stains to use as a reference.
    shape (str): The shape type ('circle' or 'rectangle')
        that the stains should match. Other shapes are not currently supported.
    confint (float): The confidence interval as a decimal
        representing the percentage within which the size of the stains should fall.
    do_not_delete (NDArray, optional): An array of stain indices that should not be deleted.
        Default is None.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/cellects/image_analysis/morphological_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="k">def</span><span class="w"> </span><span class="nf">shape_selection</span><span class="p">(</span><span class="n">binary_image</span><span class="p">:</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">several_blob_per_arena</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">true_shape_number</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>                    <span class="n">horizontal_size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">spot_shape</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bio_mask</span><span class="p">:</span><span class="n">NDArray</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">back_mask</span><span class="p">:</span><span class="n">NDArray</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">    Process the binary image to identify and validate shapes.</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">    This method processes a binary image to detect connected components,</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">    validate their sizes, and handle bio and back masks if specified.</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="sd">    It ensures that the number of validated shapes matches the expected</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">    sample number or applies additional filtering if necessary.</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">        use_bio_and_back_masks (bool): Whether to use bio and back masks</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="sd">            during the processing. Default is False.</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">    Selects and validates the shapes of stains based on their size and shape.</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a><span class="sd">    This method performs two main tasks:</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">    1. Removes stains whose horizontal size varies too much from a reference value.</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a><span class="sd">    2. Determines the shape of each remaining stain and only keeps those that correspond to a reference shape.</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="sd">    The method first removes stains whose horizontal size is outside the specified confidence interval. Then, it identifies shapes that do not correspond to a predefined reference shape and removes them as well.</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">        horizontal_size (int): The expected horizontal size of the stains to use as a reference.</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a><span class="sd">        shape (str): The shape type (&#39;circle&#39; or &#39;rectangle&#39;)</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">            that the stains should match. Other shapes are not currently supported.</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">        confint (float): The confidence interval as a decimal</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="sd">            representing the percentage within which the size of the stains should fall.</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="sd">        do_not_delete (NDArray, optional): An array of stain indices that should not be deleted.</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">            Default is None.</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>    <span class="n">shape_number</span><span class="p">,</span> <span class="n">shapes</span><span class="p">,</span> <span class="n">stats</span><span class="p">,</span> <span class="n">centroids</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">connectedComponentsWithStats</span><span class="p">(</span><span class="n">binary_image</span><span class="p">,</span> <span class="n">connectivity</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>    <span class="n">do_not_delete</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>    <span class="k">if</span> <span class="n">bio_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">back_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>        <span class="k">if</span> <span class="n">back_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">shapes</span><span class="p">[</span><span class="n">back_mask</span><span class="p">]):</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>                <span class="n">shapes</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">shapes</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">shapes</span><span class="p">[</span><span class="n">back_mask</span><span class="p">]))]</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>                <span class="n">shape_number</span><span class="p">,</span> <span class="n">shapes</span><span class="p">,</span> <span class="n">stats</span><span class="p">,</span> <span class="n">centroids</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">connectedComponentsWithStats</span><span class="p">(</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>                    <span class="p">(</span><span class="n">shapes</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">),</span> <span class="n">connectivity</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>        <span class="k">if</span> <span class="n">bio_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">shapes</span><span class="p">[</span><span class="n">bio_mask</span><span class="p">]):</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>                <span class="n">do_not_delete</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">shapes</span><span class="p">[</span><span class="n">bio_mask</span><span class="p">])</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>                <span class="n">do_not_delete</span> <span class="o">=</span> <span class="n">do_not_delete</span><span class="p">[</span><span class="n">do_not_delete</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>    <span class="n">shape_number</span> <span class="o">-=</span> <span class="mi">1</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">several_blob_per_arena</span> <span class="ow">and</span> <span class="n">horizontal_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>        <span class="n">ordered_shapes</span> <span class="o">=</span> <span class="n">shapes</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>        <span class="k">if</span> <span class="n">spot_shape</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>            <span class="n">c_spot_shapes</span> <span class="o">=</span> <span class="n">spot_shapes</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>            <span class="n">c_spot_sizes</span> <span class="o">=</span> <span class="n">spot_sizes</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>            <span class="k">if</span> <span class="n">spot_shape</span> <span class="o">==</span> <span class="s1">&#39;circle&#39;</span><span class="p">:</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>                <span class="n">c_spot_shapes</span> <span class="o">=</span> <span class="n">spot_shapes</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>                <span class="n">c_spot_shapes</span> <span class="o">=</span> <span class="n">spot_shapes</span><span class="p">[::</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>            <span class="n">c_spot_sizes</span> <span class="o">=</span> <span class="n">spot_sizes</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>        <span class="c1"># shape_number = stats.shape[0]</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>        <span class="k">while</span> <span class="n">shape_number</span> <span class="o">!=</span> <span class="n">true_shape_number</span> <span class="ow">and</span> <span class="n">counter</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">spot_size_coefficients</span><span class="p">):</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>            <span class="n">shape</span> <span class="o">=</span> <span class="n">c_spot_shapes</span><span class="p">[</span><span class="n">counter</span><span class="p">]</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>            <span class="n">confint</span> <span class="o">=</span> <span class="n">c_spot_sizes</span><span class="p">[</span><span class="n">counter</span><span class="p">]</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>            <span class="c1"># counter+=1;horizontal_size = self.spot_size; shape = self.parent.spot_shapes[counter];confint = self.parent.spot_size_confints[::-1][counter]</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>            <span class="c1"># stats columns contain in that order:</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>            <span class="c1"># - x leftmost coordinate of boundingbox</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>            <span class="c1"># - y topmost coordinate of boundingbox</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>            <span class="c1"># - The horizontal size of the bounding box.</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>            <span class="c1"># - The vertical size of the bounding box.</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>            <span class="c1"># - The total area (in pixels) of the connected component.</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>            <span class="c1"># First, remove each stain which horizontal size varies too much from reference</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>            <span class="n">size_interval</span> <span class="o">=</span> <span class="p">[</span><span class="n">horizontal_size</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">confint</span><span class="p">),</span> <span class="n">horizontal_size</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">confint</span><span class="p">)]</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>            <span class="n">cc_to_remove</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">stats</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">size_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stats</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">size_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>            <span class="k">if</span> <span class="n">do_not_delete</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>                <span class="n">ordered_shapes</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">ordered_shapes</span><span class="p">,</span> <span class="n">cc_to_remove</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>                <span class="n">ordered_shapes</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">ordered_shapes</span><span class="p">,</span> <span class="n">cc_to_remove</span><span class="p">),</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>                                              <span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">ordered_shapes</span><span class="p">,</span> <span class="n">do_not_delete</span><span class="p">)))]</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>            <span class="c1"># Second, determine the shape of each stain to only keep the ones corresponding to the reference shape</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>            <span class="n">validated_shapes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ordered_shapes</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>            <span class="n">validated_shapes</span><span class="p">[</span><span class="n">ordered_shapes</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>            <span class="n">nb_components</span><span class="p">,</span> <span class="n">ordered_shapes</span><span class="p">,</span> <span class="n">stats</span><span class="p">,</span> <span class="n">centroids</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">connectedComponentsWithStats</span><span class="p">(</span><span class="n">validated_shapes</span><span class="p">,</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>                                                                                               <span class="n">connectivity</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>            <span class="k">if</span> <span class="n">nb_components</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>                <span class="k">if</span> <span class="n">shape</span> <span class="o">==</span> <span class="s1">&#39;circle&#39;</span><span class="p">:</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>                    <span class="n">surf_interval</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">horizontal_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">confint</span><span class="p">),</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>                                     <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">horizontal_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">confint</span><span class="p">)]</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>                    <span class="n">cc_to_remove</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>                        <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">stats</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">surf_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stats</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">surf_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>                <span class="k">elif</span> <span class="n">shape</span> <span class="o">==</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">:</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>                    <span class="c1"># If the smaller side is the horizontal one, use the user provided horizontal side</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">2</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">3</span><span class="p">])))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>                        <span class="n">surf_interval</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">horizontal_size</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">confint</span><span class="p">),</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>                                         <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">horizontal_size</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">confint</span><span class="p">)]</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>                        <span class="n">cc_to_remove</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>                            <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">stats</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">surf_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stats</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">surf_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>                    <span class="c1"># If the smaller side is the vertical one, use the median vertical length shape</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>                        <span class="n">surf_interval</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">3</span><span class="p">]))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">confint</span><span class="p">),</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>                                         <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">3</span><span class="p">]))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">confint</span><span class="p">)]</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>                        <span class="n">cc_to_remove</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>                            <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">stats</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">surf_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stats</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">surf_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>                    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Original blob shape not well written&quot;</span><span class="p">)</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>                <span class="k">if</span> <span class="n">do_not_delete</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>                    <span class="n">ordered_shapes</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">ordered_shapes</span><span class="p">,</span> <span class="n">cc_to_remove</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>                    <span class="n">ordered_shapes</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">ordered_shapes</span><span class="p">,</span> <span class="n">cc_to_remove</span><span class="p">),</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>                                                  <span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">ordered_shapes</span><span class="p">,</span> <span class="n">do_not_delete</span><span class="p">)))]</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>                <span class="c1"># There was only that before:</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>                <span class="n">validated_shapes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ordered_shapes</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>                <span class="n">validated_shapes</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">ordered_shapes</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>                <span class="n">nb_components</span><span class="p">,</span> <span class="n">ordered_shapes</span><span class="p">,</span> <span class="n">stats</span><span class="p">,</span> <span class="n">centroids</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">connectedComponentsWithStats</span><span class="p">(</span><span class="n">validated_shapes</span><span class="p">,</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>                                                                                                   <span class="n">connectivity</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>            <span class="n">shape_number</span> <span class="o">=</span> <span class="n">nb_components</span> <span class="o">-</span> <span class="mi">1</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>            <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>        <span class="k">if</span> <span class="n">shape_number</span> <span class="o">==</span> <span class="n">true_shape_number</span><span class="p">:</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>            <span class="n">shapes</span> <span class="o">=</span> <span class="n">ordered_shapes</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>    <span class="k">if</span> <span class="n">true_shape_number</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">shape_number</span> <span class="o">==</span> <span class="n">true_shape_number</span><span class="p">:</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>        <span class="n">validated_shapes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shapes</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>        <span class="n">validated_shapes</span><span class="p">[</span><span class="n">shapes</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="n">max_size</span> <span class="o">=</span> <span class="n">binary_image</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="mf">0.75</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>        <span class="n">min_size</span> <span class="o">=</span> <span class="mi">10</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>        <span class="n">cc_to_remove</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">min_size</span><span class="p">,</span> <span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">max_size</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>        <span class="n">shapes</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">shapes</span><span class="p">,</span> <span class="n">cc_to_remove</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>        <span class="n">validated_shapes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shapes</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>        <span class="n">validated_shapes</span><span class="p">[</span><span class="n">shapes</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>        <span class="n">shape_number</span><span class="p">,</span> <span class="n">shapes</span><span class="p">,</span> <span class="n">stats</span><span class="p">,</span> <span class="n">centroids</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">connectedComponentsWithStats</span><span class="p">(</span><span class="n">validated_shapes</span><span class="p">,</span> <span class="n">connectivity</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">several_blob_per_arena</span> <span class="ow">and</span> <span class="n">true_shape_number</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">shape_number</span> <span class="o">&gt;</span> <span class="n">true_shape_number</span><span class="p">:</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>            <span class="c1"># Sort shapes by size and compare the largest with the second largest</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>            <span class="c1"># If the difference is too large, remove that largest shape.</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>            <span class="n">cc_to_remove</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>            <span class="n">to_remove</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>            <span class="n">stats</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>            <span class="k">while</span> <span class="n">stats</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">true_shape_number</span> <span class="ow">and</span> <span class="n">to_remove</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>                <span class="c1"># 1) rank by height</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>                <span class="n">sorted_height</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">stats</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>                <span class="c1"># and only consider the number of shapes we want to detect</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>                <span class="n">standard_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">stats</span><span class="p">[</span><span class="n">sorted_height</span><span class="p">,</span> <span class="mi">2</span><span class="p">][</span><span class="o">-</span><span class="n">true_shape_number</span><span class="p">:])</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>                <span class="n">differences</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">stats</span><span class="p">[</span><span class="n">sorted_height</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>                <span class="c1"># Look for very big changes from one height to the next</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>                <span class="k">if</span> <span class="n">differences</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">differences</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">standard_error</span><span class="p">:</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>                    <span class="c1"># Within these, remove shapes that are too large</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>                    <span class="n">to_remove</span> <span class="o">=</span> <span class="n">sorted_height</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">differences</span><span class="p">)]</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>                    <span class="n">cc_to_remove</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cc_to_remove</span><span class="p">,</span> <span class="n">to_remove</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>                    <span class="n">stats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">stats</span><span class="p">,</span> <span class="n">to_remove</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>                    <span class="n">to_remove</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>            <span class="n">shapes</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">shapes</span><span class="p">,</span> <span class="n">cc_to_remove</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>            <span class="n">validated_shapes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shapes</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>            <span class="n">validated_shapes</span><span class="p">[</span><span class="n">shapes</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>            <span class="n">shape_number</span><span class="p">,</span> <span class="n">shapes</span><span class="p">,</span> <span class="n">stats</span><span class="p">,</span> <span class="n">centroids</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">connectedComponentsWithStats</span><span class="p">(</span><span class="n">validated_shapes</span><span class="p">,</span> <span class="n">connectivity</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>        <span class="n">shape_number</span> <span class="o">-=</span> <span class="mi">1</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>    <span class="k">return</span> <span class="n">validated_shapes</span><span class="p">,</span> <span class="n">shape_number</span><span class="p">,</span> <span class="n">stats</span><span class="p">,</span> <span class="n">centroids</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../../..", "features": ["navigation.instant", "navigation.tabs", "navigation.sections", "navigation.top", "toc.integrate", "search.suggest", "search.highlight", "content.tabs.link", "content.code.copy"], "search": "../../../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>